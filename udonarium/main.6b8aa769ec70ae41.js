(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{8408:(Ye,N,Y)=>{"use strict";function O(t){return"function"==typeof t}function A(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const D=A(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function f(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class p{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(O(i))try{i()}catch(o){n=o instanceof D?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{M(o)}catch(s){n=n??[],s instanceof D?n=[...n,...s.errors]:n.push(s)}}if(n)throw new D(n)}}add(n){var e;if(n&&n!==this)if(this.closed)M(n);else{if(n instanceof p){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&f(e,n)}remove(n){const{_finalizers:e}=this;e&&f(e,n),n instanceof p&&n._removeParent(this)}}p.EMPTY=(()=>{const t=new p;return t.closed=!0,t})();const b=p.EMPTY;function x(t){return t instanceof p||t&&"closed"in t&&O(t.remove)&&O(t.add)&&O(t.unsubscribe)}function M(t){O(t)?t():t.unsubscribe()}const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(t,n,...e){const{delegate:i}=d;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=d;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function _(t){d.setTimeout(()=>{const{onUnhandledError:n}=m;if(!n)throw t;n(t)})}function v(){}const k=W("C",void 0,void 0);function W(t,n,e){return{kind:t,value:n,error:e}}let ne=null;function B(t){if(m.useDeprecatedSynchronousErrorHandling){const n=!ne;if(n&&(ne={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=ne;if(ne=null,e)throw i}}else t()}class z extends p{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,x(n)&&n.add(this)):this.destination=ge}static create(n,e,i){return new Ce(n,e,i)}next(n){this.isStopped?C(function R(t){return W("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?C(function w(t){return W("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?C(k,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const te=Function.prototype.bind;function ee(t,n){return te.call(t,n)}class K{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){$(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){$(i)}else $(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){$(e)}}}class Ce extends z{constructor(n,e,i){let r;if(super(),O(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&m.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&ee(n.next,o),error:n.error&&ee(n.error,o),complete:n.complete&&ee(n.complete,o)}):r=n}this.destination=new K(r)}}function $(t){m.useDeprecatedSynchronousErrorHandling?function V(t){m.useDeprecatedSynchronousErrorHandling&&ne&&(ne.errorThrown=!0,ne.error=t)}(t):_(t)}function C(t,n){const{onStoppedNotification:e}=m;e&&d.setTimeout(()=>e(t,n))}const ge={closed:!0,next:v,error:function ae(t){throw t},complete:v},ze="function"==typeof Symbol&&Symbol.observable||"@@observable";function le(t){return t}let xe=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function Je(t){return t&&t instanceof z||function me(t){return t&&O(t.next)&&O(t.error)&&O(t.complete)}(t)&&x(t)}(e)?e:new Ce(e,i,r);return B(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=fe(i))((r,o)=>{const s=new Ce({next:a=>{try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ze](){return this}pipe(...e){return function ve(t){return 0===t.length?le:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=fe(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function fe(t){var n;return null!==(n=t??m.Promise)&&void 0!==n?n:Promise}const Ge=A(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ue=(()=>{class t extends xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new qt(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Ge}next(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?b:(this.currentObservers=null,o.push(e),new p(()=>{this.currentObservers=null,f(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new xe;return e.source=this,e}}return t.create=(n,e)=>new qt(n,e),t})();class qt extends Ue{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:b}}function Ie(t){return n=>{if(function Ve(t){return O(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Fe(t,n,e,i,r){return new pt(t,n,e,i,r)}class pt extends z{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function nt(t,n){return Ie((e,i)=>{let r=0;e.subscribe(Fe(i,o=>{i.next(t.call(n,o,r++))}))})}function X(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function xi(t){return this instanceof xi?(this.v=t,this):new xi(t)}function yo(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function tn(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}const es=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function yd(t){return O(t?.then)}function wc(t){return O(t[ze])}function Ec(t){return Symbol.asyncIterator&&O(t?.[Symbol.asyncIterator])}function Ja(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const bd=function dp(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Cd(t){return O(t?.[bd])}function Tc(t){return function mn(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(g){i[g]&&(r[g]=function(E){return new Promise(function(L,Z){o.push([g,E,L,Z])>1||a(g,E)})})}function a(g,E){try{!function l(g){g.value instanceof xi?Promise.resolve(g.value.v).then(c,u):h(o[0][2],g)}(i[g](E))}catch(L){h(o[0][3],L)}}function c(g){a("next",g)}function u(g){a("throw",g)}function h(g,E){g(E),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield xi(e.read());if(r)return yield xi(void 0);yield yield xi(i)}}finally{e.releaseLock()}})}function wd(t){return O(t?.getReader)}function eo(t){if(t instanceof xe)return t;if(null!=t){if(wc(t))return function hp(t){return new xe(n=>{const e=t[ze]();if(O(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(es(t))return function el(t){return new xe(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(yd(t))return function fp(t){return new xe(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,_)})}(t);if(Ec(t))return xc(t);if(Cd(t))return function pp(t){return new xe(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(wd(t))return function Dc(t){return xc(Tc(t))}(t)}throw Ja(t)}function xc(t){return new xe(n=>{(function gp(t,n){var e,i,r,o;return function Ne(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(u){try{c(i.next(u))}catch(h){s(h)}}function l(u){try{c(i.throw(u))}catch(h){s(h)}}function c(u){u.done?o(u.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,l)}c((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=yo(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function to(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function Sc(t,n,e=1/0){return O(n)?Sc((i,r)=>nt((o,s)=>n(i,o,r,s))(eo(t(i,r))),e):("number"==typeof n&&(e=n),Ie((i,r)=>function mp(t,n,e,i,r,o,s,a){const l=[];let c=0,u=0,h=!1;const g=()=>{h&&!l.length&&!c&&n.complete()},E=Z=>c<i?L(Z):l.push(Z),L=Z=>{o&&n.next(Z),c++;let re=!1;eo(e(Z,u++)).subscribe(Fe(n,oe=>{r?.(oe),o?E(oe):n.next(oe)},()=>{re=!0},void 0,()=>{if(re)try{for(c--;l.length&&c<i;){const oe=l.shift();s?to(n,s,()=>L(oe)):L(oe)}g()}catch(oe){n.error(oe)}}))};return t.subscribe(Fe(n,E,()=>{h=!0,g()})),()=>{a?.()}}(i,r,t,e)))}const Mc=new xe(t=>t.complete());function ns(t){return t[t.length-1]}function Td(t,n=0){return Ie((e,i)=>{e.subscribe(Fe(i,r=>to(i,t,()=>i.next(r),n),()=>to(i,t,()=>i.complete(),n),r=>to(i,t,()=>i.error(r),n)))})}function xd(t,n=0){return Ie((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function Or(t,n){if(!t)throw new Error("Iterable cannot be null");return new xe(e=>{to(e,n,()=>{const i=t[Symbol.asyncIterator]();to(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Pr(t,n){return n?function Ar(t,n){if(null!=t){if(wc(t))return function nl(t,n){return eo(t).pipe(xd(n),Td(n))}(t,n);if(es(t))return function Os(t,n){return new xe(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(yd(t))return function nr(t,n){return eo(t).pipe(xd(n),Td(n))}(t,n);if(Ec(t))return Or(t,n);if(Cd(t))return function bo(t,n){return new xe(e=>{let i;return to(e,n,()=>{i=t[bd](),to(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>O(i?.return)&&i.return()})}(t,n);if(wd(t))return function aa(t,n){return Or(Tc(t),n)}(t,n)}throw Ja(t)}(t,n):eo(t)}function Dd(...t){const n=function tl(t){return function ts(t){return t&&O(t.schedule)}(ns(t))?t.pop():void 0}(t),e=function Ic(t,n){return"number"==typeof ns(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?eo(i[0]):function Ed(t=1/0){return Sc(le,t)}(e)(Pr(i,n)):Mc}function As(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new Ce({next:()=>{i.unsubscribe(),t()}});return eo(n(...e)).subscribe(i)}function Ut(t){for(let n in t)if(t[n]===Ut)return n;throw Error("Could not find renamed property on target object.")}function Ps(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function an(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(an).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function la(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Oc=Ut({__forward_ref__:Ut});function ln(t){return t.__forward_ref__=ln,t.toString=function(){return an(this())},t}function ut(t){return no(t)?t():t}function no(t){return"function"==typeof t&&t.hasOwnProperty(Oc)&&t.__forward_ref__===ln}function Ac(t){return t&&!!t.\u0275providers}const Fs="https://g.co/ng/security#xss";class De extends Error{constructor(n,e){super(il(n,e)),this.code=n}}function il(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}function xt(t){return"string"==typeof t?t:null==t?"":String(t)}function Oe(t,n){throw new De(-201,!1)}function Fr(t,n){null==t&&function cn(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function kt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Co(t){return{providers:t.providers||[],imports:t.imports||[]}}function Md(t){return _v(t,kd)||_v(t,yv)}function _v(t,n){return t.hasOwnProperty(n)?t[n]:null}function vv(t){return t&&(t.hasOwnProperty(yp)||t.hasOwnProperty(UM))?t[yp]:null}const kd=Ut({\u0275prov:Ut}),yp=Ut({\u0275inj:Ut}),yv=Ut({ngInjectableDef:Ut}),UM=Ut({ngInjectorDef:Ut});var Dt=(()=>((Dt=Dt||{})[Dt.Default=0]="Default",Dt[Dt.Host=1]="Host",Dt[Dt.Self=2]="Self",Dt[Dt.SkipSelf=4]="SkipSelf",Dt[Dt.Optional=8]="Optional",Dt))();let bp;function Nr(t){const n=bp;return bp=t,n}function bv(t,n,e){const i=Md(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&Dt.Optional?null:void 0!==n?n:void Oe(an(t))}const bn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Pc={},Cp="__NG_DI_FLAG__",Id="ngTempTokenPath",jM="ngTokenPath",HM=/\n/gm,GM="\u0275",Cv="__source";let Fc;function rl(t){const n=Fc;return Fc=t,n}function $M(t,n=Dt.Default){if(void 0===Fc)throw new De(-203,!1);return null===Fc?bv(t,void 0,n):Fc.get(t,n&Dt.Optional?null:void 0,n)}function bt(t,n=Dt.Default){return(function VM(){return bp}()||$M)(ut(t),n)}function Ev(t,n=Dt.Default){return bt(t,Od(n))}function Od(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function wp(t){const n=[];for(let e=0;e<t.length;e++){const i=ut(t[e]);if(Array.isArray(i)){if(0===i.length)throw new De(900,!1);let r,o=Dt.Default;for(let s=0;s<i.length;s++){const a=i[s],l=WM(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}n.push(bt(r,o))}else n.push(bt(i))}return n}function Nc(t,n){return t[Cp]=n,t.prototype[Cp]=n,t}function WM(t){return t[Cp]}function is(t){return{toString:t}.toString()}var wo=(()=>((wo=wo||{})[wo.OnPush=0]="OnPush",wo[wo.Default=1]="Default",wo))(),ro=(()=>{return(t=ro||(ro={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",ro;var t})();const rs={},nn=[],Ad=Ut({\u0275cmp:Ut}),Ep=Ut({\u0275dir:Ut}),Tp=Ut({\u0275pipe:Ut}),Tv=Ut({\u0275mod:Ut}),os=Ut({\u0275fac:Ut}),Rc=Ut({__NG_ELEMENT_ID__:Ut});let qM=0;function Wt(t){return is(()=>{const n=Dv(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===wo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,data:t.data||{},encapsulation:t.encapsulation||ro.Emulated,id:"c"+qM++,styles:t.styles||nn,_:null,schemas:t.schemas||null,tView:null};Sv(e);const i=t.dependencies;return e.directiveDefs=Pd(i,!1),e.pipeDefs=Pd(i,!0),e})}function XM(t){return un(t)||Di(t)}function QM(t){return null!==t}function ss(t){return is(()=>({type:t.type,bootstrap:t.bootstrap||nn,declarations:t.declarations||nn,imports:t.imports||nn,exports:t.exports||nn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function xv(t,n){if(null==t)return rs;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,n&&(n[r]=o)}return e}function vt(t){return is(()=>{const n=Dv(t);return Sv(n),n})}function ji(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function un(t){return t[Ad]||null}function Di(t){return t[Ep]||null}function ir(t){return t[Tp]||null}function Dv(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,exportAs:t.exportAs||null,standalone:!0===t.standalone,selectors:t.selectors||nn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:xv(t.inputs,n),outputs:xv(t.outputs)}}function Sv(t){t.features?.forEach(n=>n(t))}function Pd(t,n){if(!t)return null;const e=n?ir:XM;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(QM)}const as=0,Qe=1,Ft=2,Ln=3,oo=4,ca=5,Si=6,ol=7,Hn=8,Fd=9,Nd=10,Lt=11,xp=12,Bc=13,Mv=14,sl=15,Mi=16,zc=17,al=18,Eo=19,Uc=20,kv=21,Cn=22,Dp=1,Iv=2,Rd=7,Ld=8,ll=9,Hi=10;function mr(t){return Array.isArray(t)&&"object"==typeof t[Dp]}function so(t){return Array.isArray(t)&&!0===t[Dp]}function Sp(t){return 0!=(4&t.flags)}function Vc(t){return t.componentOffset>-1}function Bd(t){return 1==(1&t.flags)}function ao(t){return!!t.template}function ek(t){return 0!=(256&t[Ft])}function ua(t,n){return t.hasOwnProperty(os)?t[os]:null}class ik{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function kn(){return Pv}function Pv(t){return t.type.prototype.ngOnChanges&&(t.setInput=ok),rk}function rk(){const t=Nv(this),n=t?.current;if(n){const e=t.previous;if(e===rs)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function ok(t,n,e,i){const r=this.declaredInputs[e],o=Nv(t)||function sk(t,n){return t[Fv]=n}(t,{previous:rs,current:null}),s=o.current||(o.current={}),a=o.previous,l=a[r];s[r]=new ik(l&&l.currentValue,n,a===rs),t[i]=n}kn.ngInherit=!0;const Fv="__ngSimpleChanges__";function Nv(t){return t[Fv]||null}const Rr=function(t,n,e){},Rv="svg";function mi(t){for(;Array.isArray(t);)t=t[as];return t}function zd(t,n){return mi(n[t])}function _r(t,n){return mi(n[t.index])}function Bv(t,n){return t.data[n]}function cl(t,n){return t[n]}function rr(t,n){const e=n[t];return mr(e)?e:e[as]}function Ud(t){return 64==(64&t[Ft])}function Ns(t,n){return null==n?null:t[n]}function zv(t){t[al]=0}function kp(t,n){t[ca]+=n;let e=t,i=t[Ln];for(;null!==i&&(1===n&&1===e[ca]||-1===n&&0===e[ca]);)i[ca]+=n,e=i,i=i[Ln]}const Ot={lFrame:qv(null),bindingsEnabled:!0};function Vv(){return Ot.bindingsEnabled}function Se(){return Ot.lFrame.lView}function Jt(){return Ot.lFrame.tView}function Me(t){return Ot.lFrame.contextLView=t,t[Hn]}function ke(t){return Ot.lFrame.contextLView=null,t}function _i(){let t=jv();for(;null!==t&&64===t.type;)t=t.parent;return t}function jv(){return Ot.lFrame.currentTNode}function To(t,n){const e=Ot.lFrame;e.currentTNode=t,e.isParent=n}function Ip(){return Ot.lFrame.isParent}function Op(){Ot.lFrame.isParent=!1}function Gi(){const t=Ot.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function ul(){return Ot.lFrame.bindingIndex++}function cs(t){const n=Ot.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function yk(t,n){const e=Ot.lFrame;e.bindingIndex=e.bindingRootIndex=t,Ap(n)}function Ap(t){Ot.lFrame.currentDirectiveIndex=t}function Wv(){return Ot.lFrame.currentQueryIndex}function Fp(t){Ot.lFrame.currentQueryIndex=t}function Ck(t){const n=t[Qe];return 2===n.type?n.declTNode:1===n.type?t[Si]:null}function Zv(t,n,e){if(e&Dt.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&Dt.Host||(r=Ck(o),null===r||(o=o[sl],10&r.type))););if(null===r)return!1;n=r,t=o}const i=Ot.lFrame=Yv();return i.currentTNode=n,i.lView=t,!0}function Np(t){const n=Yv(),e=t[Qe];Ot.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Yv(){const t=Ot.lFrame,n=null===t?null:t.child;return null===n?qv(t):n}function qv(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function Kv(){const t=Ot.lFrame;return Ot.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Xv=Kv;function Rp(){const t=Kv();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function $i(){return Ot.lFrame.selectedIndex}function da(t){Ot.lFrame.selectedIndex=t}function In(){const t=Ot.lFrame;return Bv(t.tView,t.selectedIndex)}function Vd(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(t.contentHooks??(t.contentHooks=[])).push(-e,s),a&&((t.contentHooks??(t.contentHooks=[])).push(e,a),(t.contentCheckHooks??(t.contentCheckHooks=[])).push(e,a)),l&&(t.viewHooks??(t.viewHooks=[])).push(-e,l),c&&((t.viewHooks??(t.viewHooks=[])).push(e,c),(t.viewCheckHooks??(t.viewCheckHooks=[])).push(e,c)),null!=u&&(t.destroyHooks??(t.destroyHooks=[])).push(e,u)}}function jd(t,n,e){Jv(t,n,3,e)}function Hd(t,n,e,i){(3&t[Ft])===e&&Jv(t,n,e,i)}function Lp(t,n){let e=t[Ft];(3&e)===n&&(e&=2047,e+=1,t[Ft]=e)}function Jv(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let l=void 0!==i?65535&t[al]:0;l<s;l++)if("number"==typeof n[l+1]){if(a=n[l],null!=i&&a>=i)break}else n[l]<0&&(t[al]+=65536),(a<o||-1==o)&&(kk(t,e,n,l),t[al]=(4294901760&t[al])+l+2),l++}function kk(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[Ft]>>11<t[al]>>16&&(3&t[Ft])===n){t[Ft]+=2048,Rr(4,a,o);try{o.call(a)}finally{Rr(5,a,o)}}}else{Rr(4,a,o);try{o.call(a)}finally{Rr(5,a,o)}}}const dl=-1;class Hc{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function zp(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];ty(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function ey(t){return 3===t||4===t||6===t}function ty(t){return 64===t.charCodeAt(0)}function Gc(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||ny(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function ny(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function iy(t){return t!==dl}function Gd(t){return 32767&t}function $d(t,n){let e=function Pk(t){return t>>16}(t),i=n;for(;e>0;)i=i[sl],e--;return i}let Up=!0;function Wd(t){const n=Up;return Up=t,n}const ry=255,oy=5;let Fk=0;const xo={};function Zd(t,n){const e=sy(t,n);if(-1!==e)return e;const i=n[Qe];i.firstCreatePass&&(t.injectorIndex=n.length,Vp(i.data,t),Vp(n,null),Vp(i.blueprint,null));const r=jp(t,n),o=t.injectorIndex;if(iy(r)){const s=Gd(r),a=$d(r,n),l=a[Qe].data;for(let c=0;c<8;c++)n[o+c]=a[s+c]|l[s+c]}return n[o+8]=r,o}function Vp(t,n){t.push(0,0,0,0,0,0,0,0,n)}function sy(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function jp(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=fy(r),null===i)return dl;if(e++,r=r[sl],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return dl}function Hp(t,n,e){!function Nk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Rc)&&(i=e[Rc]),null==i&&(i=e[Rc]=Fk++);const r=i&ry;n.data[t+(r>>oy)]|=1<<r}(t,n,e)}function ay(t,n,e){if(e&Dt.Optional||void 0!==t)return t;Oe()}function ly(t,n,e,i){if(e&Dt.Optional&&void 0===i&&(i=null),!(e&(Dt.Self|Dt.Host))){const r=t[Fd],o=Nr(void 0);try{return r?r.get(n,i,e&Dt.Optional):bv(n,i,e&Dt.Optional)}finally{Nr(o)}}return ay(i,0,e)}function cy(t,n,e,i=Dt.Default,r){if(null!==t){if(1024&n[Ft]){const s=function Uk(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&1024&s[Ft]&&!(256&s[Ft]);){const a=uy(o,s,e,i|Dt.Self,xo);if(a!==xo)return a;let l=o.parent;if(!l){const c=s[kv];if(c){const u=c.get(e,xo,i);if(u!==xo)return u}l=fy(s),s=s[sl]}o=l}return r}(t,n,e,i,xo);if(s!==xo)return s}const o=uy(t,n,e,i,xo);if(o!==xo)return o}return ly(n,e,i,r)}function uy(t,n,e,i,r){const o=function Bk(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Rc)?t[Rc]:void 0;return"number"==typeof n?n>=0?n&ry:zk:n}(e);if("function"==typeof o){if(!Zv(n,t,i))return i&Dt.Host?ay(r,0,i):ly(n,e,i,r);try{const s=o(i);if(null!=s||i&Dt.Optional)return s;Oe()}finally{Xv()}}else if("number"==typeof o){let s=null,a=sy(t,n),l=dl,c=i&Dt.Host?n[Mi][Si]:null;for((-1===a||i&Dt.SkipSelf)&&(l=-1===a?jp(t,n):n[a+8],l!==dl&&hy(i,!1)?(s=n[Qe],a=Gd(l),n=$d(l,n)):a=-1);-1!==a;){const u=n[Qe];if(dy(o,a,u.data)){const h=Lk(a,n,e,s,i,c);if(h!==xo)return h}l=n[a+8],l!==dl&&hy(i,n[Qe].data[a+8]===c)&&dy(o,a,n)?(s=u,a=Gd(l),n=$d(l,n)):a=-1}}return r}function Lk(t,n,e,i,r,o){const s=n[Qe],a=s.data[t+8],u=Yd(a,s,e,null==i?Vc(a)&&Up:i!=s&&0!=(3&a.type),r&Dt.Host&&o===a);return null!==u?ha(n,s,u,a):xo}function Yd(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,l=t.directiveStart,u=o>>20,g=r?a+u:t.directiveEnd;for(let E=i?a:a+u;E<g;E++){const L=s[E];if(E<l&&e===L||E>=l&&L.type===e)return E}if(r){const E=s[l];if(E&&ao(E)&&E.type===e)return l}return null}function ha(t,n,e,i){let r=t[e];const o=n.data;if(function Ik(t){return t instanceof Hc}(r)){const s=r;s.resolving&&function j(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new De(-200,`Circular dependency in DI detected for ${t}${e}`)}(function F(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():xt(t)}(o[e]));const a=Wd(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Nr(s.injectImpl):null;Zv(t,i,Dt.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function Mk(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=Pv(n);(e.preOrderHooks??(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,s)}r&&(e.preOrderHooks??(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks??(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==l&&Nr(l),Wd(a),s.resolving=!1,Xv()}}return r}function dy(t,n,e){return!!(e[n+(t>>oy)]&1<<t)}function hy(t,n){return!(t&Dt.Self||t&Dt.Host&&n)}class hl{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return cy(this._tNode,this._lView,n,Od(i),e)}}function zk(){return new hl(_i(),Se())}function ki(t){return is(()=>{const n=t.prototype.constructor,e=n[os]||Gp(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[os]||Gp(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Gp(t){return no(t)?()=>{const n=Gp(ut(t));return n&&n()}:ua(t)}function fy(t){const n=t[Qe],e=n.type;return 2===e?n.declTNode:1===e?t[Si]:null}const pl="__parameters__";function ml(t,n,e){return is(()=>{const i=function Wp(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,c,u){const h=l.hasOwnProperty(pl)?l[pl]:Object.defineProperty(l,pl,{value:[]})[pl];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(s),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class St{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=kt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function fa(t,n){t.forEach(e=>Array.isArray(e)?fa(e,n):n(e))}function gy(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function qd(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Zc(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function vr(t,n,e){let i=_l(t,n);return i>=0?t[1|i]=e:(i=~i,function Gk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function Yp(t,n){const e=_l(t,n);if(e>=0)return t[1|e]}function _l(t,n){return function my(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const Xd=Nc(ml("Optional"),8),Qd=Nc(ml("SkipSelf"),4);var or=(()=>((or=or||{})[or.Important=1]="Important",or[or.DashCase=2]="DashCase",or))();const eg=new Map;let h2=0;const ng="__ngContext__";function Ii(t,n){mr(n)?(t[ng]=n[Uc],function p2(t){eg.set(t[Uc],t)}(n)):t[ng]=n}let ig;function rg(t,n){return ig(t,n)}function Xc(t){const n=t[Ln];return so(n)?n[Ln]:n}function og(t){return Ry(t[Bc])}function sg(t){return Ry(t[oo])}function Ry(t){for(;null!==t&&!so(t);)t=t[oo];return t}function yl(t,n,e,i,r){if(null!=i){let o,s=!1;so(i)?o=i:mr(i)&&(s=!0,i=i[as]);const a=mi(i);0===t&&null!==e?null==r?jy(n,e,a):pa(n,e,a,r||null,!0):1===t&&null!==e?pa(n,e,a,r||null,!0):2===t?function fg(t,n,e){const i=th(t,n);i&&function F2(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function L2(t,n,e,i,r){const o=e[Rd];o!==mi(e)&&yl(n,t,i,o,r);for(let a=Hi;a<e.length;a++){const l=e[a];Qc(l[Qe],l,t,n,i,o)}}(n,t,o,e,r)}}function lg(t,n,e){return t.createElement(n,e)}function By(t,n){const e=t[ll],i=e.indexOf(n),r=n[Ln];512&n[Ft]&&(n[Ft]&=-513,kp(r,-1)),e.splice(i,1)}function cg(t,n){if(t.length<=Hi)return;const e=Hi+n,i=t[e];if(i){const r=i[zc];null!==r&&r!==t&&By(r,i),n>0&&(t[e-1][oo]=i[oo]);const o=qd(t,Hi+n);!function D2(t,n){Qc(t,n,n[Lt],2,null,null),n[as]=null,n[Si]=null}(i[Qe],i);const s=o[Eo];null!==s&&s.detachView(o[Qe]),i[Ln]=null,i[oo]=null,i[Ft]&=-65}return i}function zy(t,n){if(!(128&n[Ft])){const e=n[Lt];e.destroyNode&&Qc(t,n,e,3,null,null),function k2(t){let n=t[Bc];if(!n)return ug(t[Qe],t);for(;n;){let e=null;if(mr(n))e=n[Bc];else{const i=n[Hi];i&&(e=i)}if(!e){for(;n&&!n[oo]&&n!==t;)mr(n)&&ug(n[Qe],n),n=n[Ln];null===n&&(n=t),mr(n)&&ug(n[Qe],n),e=n&&n[oo]}n=e}}(n)}}function ug(t,n){if(!(128&n[Ft])){n[Ft]&=-65,n[Ft]|=128,function P2(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof Hc)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];Rr(4,a,l);try{l.call(a)}finally{Rr(5,a,l)}}else{Rr(4,r,o);try{o.call(r)}finally{Rr(5,r,o)}}}}}(t,n),function A2(t,n){const e=t.cleanup,i=n[ol];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?i[r=s]():i[r=-s].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)(0,i[o])();n[ol]=null}}(t,n),1===n[Qe].type&&n[Lt].destroy();const e=n[zc];if(null!==e&&so(n[Ln])){e!==n[Ln]&&By(e,n);const i=n[Eo];null!==i&&i.detachView(t)}!function g2(t){eg.delete(t[Uc])}(n)}}function Uy(t,n,e){return function Vy(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[as];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=t.data[i.directiveStart+r];if(o===ro.None||o===ro.Emulated)return null}return _r(i,e)}}(t,n.parent,e)}function pa(t,n,e,i,r){t.insertBefore(n,e,i,r)}function jy(t,n,e){t.appendChild(n,e)}function Hy(t,n,e,i,r){null!==i?pa(t,n,e,i,r):jy(t,n,e)}function th(t,n){return t.parentNode(n)}function Gy(t,n,e){return Wy(t,n,e)}let dg,rh,mg,Wy=function $y(t,n,e){return 40&t.type?_r(t,e):null};function nh(t,n,e,i){const r=Uy(t,i,n),o=n[Lt],a=Gy(i.parent||n[Si],i,n);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)Hy(o,r,e[l],a,!1);else Hy(o,r,e,a,!1);void 0!==dg&&dg(o,i,n,e,r)}function ih(t,n){if(null!==n){const e=n.type;if(3&e)return _r(n,t);if(4&e)return hg(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return ih(t,i);{const r=t[n.index];return so(r)?hg(-1,r):mi(r)}}if(32&e)return rg(n,t)()||mi(t[n.index]);{const i=Yy(t,n);return null!==i?Array.isArray(i)?i[0]:ih(Xc(t[Mi]),i):ih(t,n.next)}}return null}function Yy(t,n){return null!==n?t[Mi][Si].projection[n.projection]:null}function hg(t,n){const e=Hi+t+1;if(e<n.length){const i=n[e],r=i[Qe].firstChild;if(null!==r)return ih(i,r)}return n[Rd]}function pg(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],l=e.type;if(s&&0===n&&(a&&Ii(mi(a),i),e.flags|=2),32!=(32&e.flags))if(8&l)pg(t,n,e.child,i,r,o,!1),yl(n,t,r,a,o);else if(32&l){const c=rg(e,i);let u;for(;u=c();)yl(n,t,r,u,o);yl(n,t,r,a,o)}else 16&l?qy(t,n,i,e,r,o):yl(n,t,r,a,o);e=s?e.projectionNext:e.next}}function Qc(t,n,e,i,r,o){pg(e,i,t.firstChild,n,r,o,!1)}function qy(t,n,e,i,r,o){const s=e[Mi],l=s[Si].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)yl(n,t,r,l[c],o);else pg(t,n,l,s[Ln],r,o,!0)}function Ky(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Xy(t,n,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&zp(t,n,i),null!==r&&Ky(t,n,r),null!==o&&function z2(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}function bl(t){return function gg(){if(void 0===rh&&(rh=null,bn.trustedTypes))try{rh=bn.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return rh}()?.createHTML(t)||t}class ga{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Fs})`}}class G2 extends ga{getTypeName(){return"HTML"}}class $2 extends ga{getTypeName(){return"Style"}}class W2 extends ga{getTypeName(){return"Script"}}class Z2 extends ga{getTypeName(){return"URL"}}class Y2 extends ga{getTypeName(){return"ResourceURL"}}function yr(t){return t instanceof ga?t.changingThisBreaksApplicationSecurity:t}function Do(t,n){const e=function q2(t){return t instanceof ga&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Fs})`)}return e===n}class tI{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(bl(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class nI{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=bl(n),e}}const rI=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function sh(t){return(t=String(t)).match(rI)?t:"unsafe:"+t}function us(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Jc(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const ib=us("area,br,col,hr,img,wbr"),rb=us("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ob=us("rp,rt"),vg=Jc(ib,Jc(rb,us("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Jc(ob,us("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Jc(ob,rb)),yg=us("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),sb=Jc(yg,us("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),us("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),oI=us("script,style,template");class sI{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!vg.hasOwnProperty(e))return this.sanitizedSomething=!0,!oI.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!sb.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;yg[a]&&(l=sh(l)),this.buf.push(" ",s,'="',ab(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();vg.hasOwnProperty(e)&&!ib.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(ab(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const aI=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lI=/([^\#-~ |!])/g;function ab(t){return t.replace(/&/g,"&amp;").replace(aI,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(lI,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ah;function lb(t,n){let e=null;try{ah=ah||function nb(t){const n=new nI(t);return function iI(){try{return!!(new window.DOMParser).parseFromString(bl(""),"text/html")}catch{return!1}}()?new tI(n):n}(t);let i=n?String(n):"";e=ah.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=ah.getInertBodyElement(i)}while(i!==o);return bl((new sI).sanitizeChildren(bg(e)||e))}finally{if(e){const i=bg(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function bg(t){return"content"in t&&function cI(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var _n=(()=>((_n=_n||{})[_n.NONE=0]="NONE",_n[_n.HTML=1]="HTML",_n[_n.STYLE=2]="STYLE",_n[_n.SCRIPT=3]="SCRIPT",_n[_n.URL=4]="URL",_n[_n.RESOURCE_URL=5]="RESOURCE_URL",_n))();function Xn(t){const n=function eu(){const t=Se();return t&&t[xp]}();return n?n.sanitize(_n.URL,t)||"":Do(t,"URL")?yr(t):sh(xt(t))}const ub=new St("ENVIRONMENT_INITIALIZER"),db=new St("INJECTOR",-1),hb=new St("INJECTOR_DEF_TYPES");class fb{get(n,e=Pc){if(e===Pc){const i=new Error(`NullInjectorError: No provider for ${an(n)}!`);throw i.name="NullInjectorError",i}return e}}function _I(...t){return{\u0275providers:pb(0,t),\u0275fromNgModule:!0}}function pb(t,...n){const e=[],i=new Set;let r;return fa(n,o=>{const s=o;Cg(s,e,[],i)&&(r||(r=[]),r.push(s))}),void 0!==r&&gb(r,e),e}function gb(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];wg(r,o=>{n.push(o)})}}function Cg(t,n,e,i){if(!(t=ut(t)))return!1;let r=null,o=vv(t);const s=!o&&un(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const l=t.ngModule;if(o=vv(l),!o)return!1;r=l}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const c of l)Cg(c,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let c;i.add(r);try{fa(o.imports,u=>{Cg(u,n,e,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&gb(c,n)}if(!a){const c=ua(r)||(()=>new r);n.push({provide:r,useFactory:c,deps:nn},{provide:hb,useValue:r,multi:!0},{provide:ub,useValue:()=>bt(r),multi:!0})}const l=o.providers;null==l||a||wg(l,u=>{n.push(u)})}}return r!==t&&void 0!==t.providers}function wg(t,n){for(let e of t)Ac(e)&&(e=e.\u0275providers),Array.isArray(e)?wg(e,n):n(e)}const vI=Ut({provide:String,useValue:Ut});function Eg(t){return null!==t&&"object"==typeof t&&vI in t}function ma(t){return"function"==typeof t}const Tg=new St("Set Injector scope."),lh={},bI={};let xg;function ch(){return void 0===xg&&(xg=new fb),xg}class Cl{}class vb extends Cl{get destroyed(){return this._destroyed}constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Sg(n,s=>this.processProvider(s)),this.records.set(db,wl(void 0,this)),r.has("environment")&&this.records.set(Cl,wl(void 0,this));const o=this.records.get(Tg);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(hb.multi,nn,Dt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=rl(this),i=Nr(void 0);try{return n()}finally{rl(e),Nr(i)}}get(n,e=Pc,i=Dt.Default){this.assertNotDestroyed(),i=Od(i);const r=rl(this),o=Nr(void 0);try{if(!(i&Dt.SkipSelf)){let a=this.records.get(n);if(void 0===a){const l=function xI(t){return"function"==typeof t||"object"==typeof t&&t instanceof St}(n)&&Md(n);a=l&&this.injectableDefInScope(l)?wl(Dg(n),lh):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&Dt.Self?ch():this.parent).get(n,e=i&Dt.Optional&&e===Pc?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[Id]=s[Id]||[]).unshift(an(n)),r)throw s;return function ZM(t,n,e,i){const r=t[Id];throw n[Cv]&&r.unshift(n[Cv]),t.message=function YM(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==GM?t.slice(2):t;let r=an(n);if(Array.isArray(n))r=n.map(an).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):an(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(HM,"\n  ")}`}("\n"+t.message,r,e,i),t[jM]=r,t[Id]=null,t}(s,n,"R3InjectorError",this.source)}throw s}finally{Nr(o),rl(r)}}resolveInjectorInitializers(){const n=rl(this),e=Nr(void 0);try{const i=this.get(ub.multi,nn,Dt.Self);for(const r of i)r()}finally{rl(n),Nr(e)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(an(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new De(205,!1)}processProvider(n){let e=ma(n=ut(n))?n:ut(n&&n.provide);const i=function wI(t){return Eg(t)?wl(void 0,t.useValue):wl(yb(t),lh)}(n);if(ma(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=wl(void 0,lh,!0),r.factory=()=>wp(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){return e.value===lh&&(e.value=bI,e.value=e.factory()),"object"==typeof e.value&&e.value&&function TI(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=ut(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Dg(t){const n=Md(t),e=null!==n?n.factory:ua(t);if(null!==e)return e;if(t instanceof St)throw new De(204,!1);if(t instanceof Function)return function CI(t){const n=t.length;if(n>0)throw Zc(n,"?"),new De(204,!1);const e=function zM(t){return t&&(t[kd]||t[yv])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new De(204,!1)}function yb(t,n,e){let i;if(ma(t)){const r=ut(t);return ua(r)||Dg(r)}if(Eg(t))i=()=>ut(t.useValue);else if(function _b(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...wp(t.deps||[]));else if(function mb(t){return!(!t||!t.useExisting)}(t))i=()=>bt(ut(t.useExisting));else{const r=ut(t&&(t.useClass||t.provide));if(!function EI(t){return!!t.deps}(t))return ua(r)||Dg(r);i=()=>new r(...wp(t.deps))}return i}function wl(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Sg(t,n){for(const e of t)Array.isArray(e)?Sg(e,n):e&&Ac(e)?Sg(e.\u0275providers,n):n(e)}class DI{}class bb{}class MI{resolveComponentFactory(n){throw function SI(t){const n=Error(`No component factory found for ${an(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let uh=(()=>{class t{}return t.NULL=new MI,t})();function kI(){return El(_i(),Se())}function El(t,n){return new Bn(_r(t,n))}let Bn=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=kI,t})();function II(t){return t instanceof Bn?t.nativeElement:t}class tu{}let _a=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function OI(){const t=Se(),e=rr(_i().index,t);return(mr(e)?e:t)[Lt]}(),t})(),AI=(()=>{class t{}return t.\u0275prov=kt({token:t,providedIn:"root",factory:()=>null}),t})();class dh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const PI=new dh("15.2.8"),Mg={},kg="ngOriginalError";function Ig(t){return t[kg]}class Tl{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Ig(n);for(;e&&Ig(e);)e=Ig(e);return e||null}}function nu(t){return t.ownerDocument}function Eb(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}const Tb="ng-template";function HI(t,n,e){let i=0,r=!0;for(;i<t.length;){let o=t[i++];if("string"==typeof o&&r){const s=t[i++];if(e&&"class"===o&&-1!==Eb(s.toLowerCase(),n,0))return!0}else{if(1===o){for(;i<t.length&&"string"==typeof(o=t[i++]);)if(o.toLowerCase()===n)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function xb(t){return 4===t.type&&t.value!==Tb}function GI(t,n,e){return n===(4!==t.type||e?t.value:Tb)}function $I(t,n,e){let i=4;const r=t.attrs||[],o=function YI(t){for(let n=0;n<t.length;n++)if(ey(t[n]))return n;return t.length}(r);let s=!1;for(let a=0;a<n.length;a++){const l=n[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!GI(t,l,e)||""===l&&1===n.length){if(lo(i))return!1;s=!0}}else{const c=8&i?l:n[++a];if(8&i&&null!==t.attrs){if(!HI(t.attrs,c,e)){if(lo(i))return!1;s=!0}continue}const h=WI(8&i?"class":l,r,xb(t),e);if(-1===h){if(lo(i))return!1;s=!0;continue}if(""!==c){let g;g=h>o?"":r[h+1].toLowerCase();const E=8&i?g:null;if(E&&-1!==Eb(E,c,0)||2&i&&c!==g){if(lo(i))return!1;s=!0}}}}else{if(!s&&!lo(i)&&!lo(l))return!1;if(s&&lo(l))continue;s=!1,i=l|1&i}}return lo(i)||s}function lo(t){return 0==(1&t)}function WI(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function qI(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function Db(t,n,e=!1){for(let i=0;i<n.length;i++)if($I(t,n[i],e))return!0;return!1}function KI(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function Sb(t,n){return t?":not("+n.trim()+")":n}function XI(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!lo(s)&&(n+=Sb(o,r),r=""),i=s,o=o||!lo(i);e++}return""!==r&&(n+=Sb(o,r)),n}const At={};function I(t){Mb(Jt(),Se(),$i()+t,!1)}function Mb(t,n,e,i){if(!i)if(3==(3&n[Ft])){const o=t.preOrderCheckHooks;null!==o&&jd(n,o,e)}else{const o=t.preOrderHooks;null!==o&&Hd(n,o,0,e)}da(e)}function Ab(t,n=null,e=null,i){const r=Pb(t,n,e,i);return r.resolveInjectorInitializers(),r}function Pb(t,n=null,e=null,i,r=new Set){const o=[e||nn,_I(t)];return i=i||("object"==typeof t?void 0:an(t)),new vb(o,n||ch(),i||null,r)}let So=(()=>{class t{static create(e,i){if(Array.isArray(e))return Ab({name:""},i,e,"");{const r=e.name??"";return Ab({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=Pc,t.NULL=new fb,t.\u0275prov=kt({token:t,providedIn:"any",factory:()=>bt(db)}),t.__NG_ELEMENT_ID__=-1,t})();function J(t,n=Dt.Default){const e=Se();return null===e?bt(t,n):cy(_i(),e,ut(t),n)}function Ub(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const o=e[i+1];if(-1!==o){const s=t.data[o];Fp(e[i]),s.contentQueries(2,n[o],o)}}}function fh(t,n,e,i,r,o,s,a,l,c,u){const h=n.blueprint.slice();return h[as]=r,h[Ft]=76|i,(null!==u||t&&1024&t[Ft])&&(h[Ft]|=1024),zv(h),h[Ln]=h[sl]=t,h[Hn]=e,h[Nd]=s||t&&t[Nd],h[Lt]=a||t&&t[Lt],h[xp]=l||t&&t[xp]||null,h[Fd]=c||t&&t[Fd]||null,h[Si]=o,h[Uc]=function f2(){return h2++}(),h[kv]=u,h[Mi]=2==n.type?t[Mi]:h,h}function Sl(t,n,e,i,r){let o=t.data[n];if(null===o)o=function Ng(t,n,e,i,r){const o=jv(),s=Ip(),l=t.data[n]=function TO(t,n,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l,l.prev=o)),l}(t,n,e,i,r),function vk(){return Ot.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function jc(){const t=Ot.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return To(o,!0),o}function iu(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Rg(t,n,e){Np(n);try{const i=t.viewQuery;null!==i&&$g(1,i,e);const r=t.template;null!==r&&Vb(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Ub(t,n),t.staticViewQueries&&$g(2,t.viewQuery,e);const o=t.components;null!==o&&function CO(t,n){for(let e=0;e<n.length;e++)GO(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[Ft]&=-5,Rp()}}function ph(t,n,e,i){const r=n[Ft];if(128!=(128&r)){Np(n);try{zv(n),function Gv(t){return Ot.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Vb(t,n,e,2,i);const s=3==(3&r);if(s){const c=t.preOrderCheckHooks;null!==c&&jd(n,c,null)}else{const c=t.preOrderHooks;null!==c&&Hd(n,c,0,null),Lp(n,0)}if(function jO(t){for(let n=og(t);null!==n;n=sg(n)){if(!n[Iv])continue;const e=n[ll];for(let i=0;i<e.length;i++){const r=e[i];512&r[Ft]||kp(r[Ln],1),r[Ft]|=512}}}(n),function VO(t){for(let n=og(t);null!==n;n=sg(n))for(let e=Hi;e<n.length;e++){const i=n[e],r=i[Qe];Ud(i)&&ph(r,i,r.template,i[Hn])}}(n),null!==t.contentQueries&&Ub(t,n),s){const c=t.contentCheckHooks;null!==c&&jd(n,c)}else{const c=t.contentHooks;null!==c&&Hd(n,c,1),Lp(n,1)}!function yO(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)da(~r);else{const o=r,s=e[++i],a=e[++i];yk(s,o),a(2,n[o])}}}finally{da(-1)}}(t,n);const a=t.components;null!==a&&function bO(t,n){for(let e=0;e<n.length;e++)HO(t,n[e])}(n,a);const l=t.viewQuery;if(null!==l&&$g(2,l,i),s){const c=t.viewCheckHooks;null!==c&&jd(n,c)}else{const c=t.viewHooks;null!==c&&Hd(n,c,2),Lp(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Ft]&=-41,512&n[Ft]&&(n[Ft]&=-513,kp(n[Ln],-1))}finally{Rp()}}}function Vb(t,n,e,i,r){const o=$i(),s=2&i;try{da(-1),s&&n.length>Cn&&Mb(t,n,Cn,!1),Rr(s?2:0,r),e(i,r)}finally{da(o),Rr(s?3:1,r)}}function Lg(t,n,e){if(Sp(n)){const r=n.directiveEnd;for(let o=n.directiveStart;o<r;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function Bg(t,n,e){Vv()&&(function OO(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;Vc(e)&&function BO(t,n,e){const i=_r(n,t),r=jb(e),o=t[Nd],s=gh(t,fh(t,r,null,e.onPush?32:16,i,n,o,o.createRenderer(i,e),null,null,null));t[n.index]=s}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Zd(e,n),Ii(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const l=t.data[a],c=ha(n,t,a,e);Ii(c,n),null!==s&&zO(0,a-r,c,l,0,s),ao(l)&&(rr(e.index,n)[Hn]=ha(n,t,a,e))}}(t,n,e,_r(e,n)),64==(64&e.flags)&&Zb(t,n,e))}function zg(t,n,e=_r){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function jb(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Ug(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Ug(t,n,e,i,r,o,s,a,l,c){const u=Cn+i,h=u+r,g=function wO(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:At);return e}(u,h),E="function"==typeof c?c():c;return g[Qe]={type:t,blueprint:g,template:e,queries:null,viewQuery:a,declTNode:n,data:g.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:E,incompleteFirstPass:!1}}function Hb(t,n,e,i){const r=qb(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Kb(t).push(i,r.length-1))}function Gb(t,n,e,i){for(let r in t)if(t.hasOwnProperty(r)){e=null===e?{}:e;const o=t[r];null===i?$b(e,n,r,o):i.hasOwnProperty(r)&&$b(e,n,i[r],o)}return e}function $b(t,n,e,i){t.hasOwnProperty(e)?t[e].push(n,i):t[e]=[n,i]}function br(t,n,e,i,r,o,s,a){const l=_r(n,e);let u,c=n.inputs;!a&&null!=c&&(u=c[i])?(Wg(t,e,u,i,r),Vc(n)&&function SO(t,n){const e=rr(n,t);16&e[Ft]||(e[Ft]|=32)}(e,n.index)):3&n.type&&(i=function DO(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(l,i,r))}function Vg(t,n,e,i){if(Vv()){const r=null===i?null:{"":-1},o=function PO(t,n){const e=t.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(Db(n,s.selectors,!1))if(i||(i=[]),ao(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),jg(t,n,a.length)}else i.unshift(s),jg(t,n,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(t,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&Wb(t,n,e,s,r,a),r&&function FO(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new De(-301,!1);i.push(n[r],o)}}}(e,i,r)}e.mergedAttrs=Gc(e.mergedAttrs,e.attrs)}function Wb(t,n,e,i,r,o){for(let c=0;c<i.length;c++)Hp(Zd(e,n),t,i[c].type);!function RO(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,l=iu(t,n,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];e.mergedAttrs=Gc(e.mergedAttrs,u.hostAttrs),LO(t,e,n,l,u),NO(l,u,r),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const h=u.type.prototype;!s&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((t.preOrderHooks??(t.preOrderHooks=[])).push(e.index),s=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(e.index),a=!0),l++}!function xO(t,n,e){const r=n.directiveEnd,o=t.data,s=n.attrs,a=[];let l=null,c=null;for(let u=n.directiveStart;u<r;u++){const h=o[u],g=e?e.get(h):null,L=g?g.outputs:null;l=Gb(h.inputs,u,l,g?g.inputs:null),c=Gb(h.outputs,u,c,L);const Z=null===l||null===s||xb(n)?null:UO(l,u,s);a.push(Z)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=c}(t,e,o)}function Zb(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function bk(){return Ot.lFrame.currentDirectiveIndex}();try{da(o);for(let a=i;a<r;a++){const l=t.data[a],c=n[a];Ap(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&AO(l,c)}}finally{da(-1),Ap(s)}}function AO(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function jg(t,n,e){n.componentOffset=e,(t.components??(t.components=[])).push(n.index)}function NO(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;ao(n)&&(e[""]=t)}}function LO(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=ua(r.type)),s=new Hc(o,ao(r),J);t.blueprint[i]=s,e[i]=s,function kO(t,n,e,i,r){const o=r.hostBindings;if(o){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~n.index;(function IO(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,i,o)}}(t,n,i,iu(t,e,r.hostVars,At),r)}function Mo(t,n,e,i,r,o){const s=_r(t,n);!function Hg(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?xt(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[Lt],s,o,t.value,e,i,r)}function zO(t,n,e,i,r,o){const s=o[n];if(null!==s){const a=i.setInput;for(let l=0;l<s.length;){const c=s[l++],u=s[l++],h=s[l++];null!==a?i.setInput(e,h,c,u):e[u]=h}}}function UO(t,n,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===i&&(i=[]);const s=t[o];for(let a=0;a<s.length;a+=2)if(s[a]===n){i.push(o,s[a+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Yb(t,n,e,i){return[t,!0,!1,n,null,0,i,e,null,null]}function HO(t,n){const e=rr(n,t);if(Ud(e)){const i=e[Qe];48&e[Ft]?ph(i,e,i.template,e[Hn]):e[ca]>0&&Gg(e)}}function Gg(t){for(let i=og(t);null!==i;i=sg(i))for(let r=Hi;r<i.length;r++){const o=i[r];if(Ud(o))if(512&o[Ft]){const s=o[Qe];ph(s,o,s.template,o[Hn])}else o[ca]>0&&Gg(o)}const e=t[Qe].components;if(null!==e)for(let i=0;i<e.length;i++){const r=rr(e[i],t);Ud(r)&&r[ca]>0&&Gg(r)}}function GO(t,n){const e=rr(n,t),i=e[Qe];(function $O(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),Rg(i,e,e[Hn])}function gh(t,n){return t[Bc]?t[Mv][oo]=n:t[Bc]=n,t[Mv]=n,n}function mh(t){for(;t;){t[Ft]|=32;const n=Xc(t);if(ek(t)&&!n)return t;t=n}return null}function _h(t,n,e,i=!0){const r=n[Nd];r.begin&&r.begin();try{ph(t,n,t.template,e)}catch(s){throw i&&Qb(n,s),s}finally{r.end&&r.end()}}function $g(t,n,e){Fp(0),n(t,e)}function qb(t){return t[ol]||(t[ol]=[])}function Kb(t){return t.cleanup||(t.cleanup=[])}function Qb(t,n){const e=t[Fd],i=e?e.get(Tl,null):null;i&&i.handleError(n)}function Wg(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],l=n[s],c=t.data[s];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function hs(t,n,e){const i=zd(n,t);!function Ly(t,n,e){t.setValue(n,e)}(t[Lt],i,e)}function vh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=la(r,a):2==o&&(i=la(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}function yh(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&i.push(mi(o)),so(o))for(let a=Hi;a<o.length;a++){const l=o[a],c=l[Qe].firstChild;null!==c&&yh(l[Qe],l,c,i)}const s=e.type;if(8&s)yh(t,n,e.child,i);else if(32&s){const a=rg(e,n);let l;for(;l=a();)i.push(l)}else if(16&s){const a=Yy(n,e);if(Array.isArray(a))i.push(...a);else{const l=Xc(n[Mi]);yh(l[Qe],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class ru{get rootNodes(){const n=this._lView,e=n[Qe];return yh(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Hn]}set context(n){this._lView[Hn]=n}get destroyed(){return 128==(128&this._lView[Ft])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Ln];if(so(n)){const e=n[Ld],i=e?e.indexOf(this):-1;i>-1&&(cg(n,i),qd(e,i))}this._attachedToViewContainer=!1}zy(this._lView[Qe],this._lView)}onDestroy(n){Hb(this._lView[Qe],this._lView,null,n)}markForCheck(){mh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ft]&=-65}reattach(){this._lView[Ft]|=64}detectChanges(){_h(this._lView[Qe],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new De(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function M2(t,n){Qc(t,n,n[Lt],2,null,null)}(this._lView[Qe],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new De(902,!1);this._appRef=n}}class WO extends ru{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;_h(n[Qe],n,n[Hn],!1)}checkNoChanges(){}get context(){return null}}class Jb extends uh{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=un(n);return new ou(e,this.ngModule)}}function e1(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class YO{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=Od(i);const r=this.injector.get(n,Mg,i);return r!==Mg||e===Mg?r:this.parentInjector.get(n,e,i)}}class ou extends bb{get inputs(){return e1(this.componentDef.inputs)}get outputs(){return e1(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function QI(t){return t.map(XI).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,r){let o=(r=r||this.ngModule)instanceof Cl?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new YO(n,o):n,a=s.get(tu,null);if(null===a)throw new De(407,!1);const l=s.get(AI,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=i?function EO(t,n,e){return t.selectRootElement(n,e===ro.ShadowDom)}(c,i,this.componentDef.encapsulation):lg(c,u,function ZO(t){const n=t.toLowerCase();return"svg"===n?Rv:"math"===n?"math":null}(u)),g=this.componentDef.onPush?288:272,E=Ug(0,null,null,1,0,null,null,null,null,null),L=fh(null,E,null,g,null,null,a,c,l,s,null);let Z,re;Np(L);try{const oe=this.componentDef;let ce,ue=null;oe.findHostDirectiveDefs?(ce=[],ue=new Map,oe.findHostDirectiveDefs(oe,ce,ue),ce.push(oe)):ce=[oe];const be=function KO(t,n){const e=t[Qe],i=Cn;return t[i]=n,Sl(e,i,2,"#host",null)}(L,h),Ke=function XO(t,n,e,i,r,o,s,a){const l=r[Qe];!function QO(t,n,e,i){for(const r of t)n.mergedAttrs=Gc(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(vh(n,n.mergedAttrs,!0),null!==e&&Xy(i,e,n))}(i,t,n,s);const c=o.createRenderer(n,e),u=fh(r,jb(e),null,e.onPush?32:16,r[t.index],t,o,c,a||null,null,null);return l.firstCreatePass&&jg(l,t,i.length-1),gh(r,u),r[t.index]=u}(be,h,oe,ce,L,a,c);re=Bv(E,Cn),h&&function eA(t,n,e,i){if(i)zp(t,e,["ng-version",PI.full]);else{const{attrs:r,classes:o}=function JI(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!lo(r))break;r=o}i++}return{attrs:n,classes:e}}(n.selectors[0]);r&&zp(t,e,r),o&&o.length>0&&Ky(t,e,o.join(" "))}}(c,oe,h,i),void 0!==e&&function tA(t,n,e){const i=t.projection=[];for(let r=0;r<n.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(re,this.ngContentSelectors,e),Z=function JO(t,n,e,i,r,o){const s=_i(),a=r[Qe],l=_r(s,r);Wb(a,r,s,e,null,i);for(let u=0;u<e.length;u++)Ii(ha(r,a,s.directiveStart+u,s),r);Zb(a,r,s),l&&Ii(l,r);const c=ha(r,a,s.directiveStart+s.componentOffset,s);if(t[Hn]=r[Hn]=c,null!==o)for(const u of o)u(c,n);return Lg(a,s,t),c}(Ke,oe,ce,ue,L,[nA]),Rg(E,L,null)}finally{Rp()}return new qO(this.componentType,Z,El(re,L),L,re)}}class qO extends DI{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new WO(r),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){const o=this._rootLView;Wg(o[Qe],o,r,n,e),mh(rr(this._tNode.index,o))}}get injector(){return new hl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function nA(){const t=_i();Vd(Se()[Qe],t)}function fn(t){let n=function t1(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(ao(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new De(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=Zg(t.inputs),s.declaredInputs=Zg(t.declaredInputs),s.outputs=Zg(t.outputs);const a=r.hostBindings;a&&sA(t,a);const l=r.viewQuery,c=r.contentQueries;if(l&&rA(t,l),c&&oA(t,c),Ps(t.inputs,r.inputs),Ps(t.declaredInputs,r.declaredInputs),Ps(t.outputs,r.outputs),ao(r)&&r.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===fn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function iA(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Gc(r.hostAttrs,e=Gc(e,r.hostAttrs))}}(i)}function Zg(t){return t===rs?{}:t===nn?[]:t}function rA(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function oA(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function sA(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}function bh(t){return!!Yg(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function Yg(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ko(t,n,e){return t[n]=e}function Oi(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function va(t,n,e,i){const r=Oi(t,n,e);return Oi(t,n+1,i)||r}function zr(t,n,e,i){const r=Se();return Oi(r,ul(),n)&&(Jt(),Mo(In(),r,t,n,e,i)),zr}function kl(t,n,e,i){return Oi(t,ul(),e)?n+xt(e)+i:At}function Il(t,n,e,i,r,o){const a=va(t,function ls(){return Ot.lFrame.bindingIndex}(),e,r);return cs(2),a?n+xt(e)+i+xt(r)+o:At}function Q(t,n,e,i,r,o,s,a){const l=Se(),c=Jt(),u=t+Cn,h=c.firstCreatePass?function mA(t,n,e,i,r,o,s,a,l){const c=n.consts,u=Sl(n,t,4,s||null,Ns(c,a));Vg(n,e,u,Ns(c,l)),Vd(n,u);const h=u.tView=Ug(2,u,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c);return null!==n.queries&&(n.queries.template(n,u),h.queries=n.queries.embeddedTView(u)),u}(u,c,l,n,e,i,r,o,s):c.data[u];To(h,!1);const g=l[Lt].createComment("");nh(c,l,g,h),Ii(g,l),gh(l,l[u]=Yb(g,l,g,h)),Bd(h)&&Bg(c,l,h),null!=s&&zg(l,h,a)}function Pt(t){return cl(function _k(){return Ot.lFrame.contextLView}(),Cn+t)}function S(t,n,e){const i=Se();return Oi(i,ul(),n)&&br(Jt(),In(),i,t,n,i[Lt],e,!1),S}function qg(t,n,e,i,r){const s=r?"class":"style";Wg(t,e,n.inputs[s],s,i)}function T(t,n,e,i){const r=Se(),o=Jt(),s=Cn+t,a=r[Lt],l=o.firstCreatePass?function vA(t,n,e,i,r,o){const s=n.consts,l=Sl(n,t,2,i,Ns(s,r));return Vg(n,e,l,Ns(s,o)),null!==l.attrs&&vh(l,l.attrs,!1),null!==l.mergedAttrs&&vh(l,l.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,l),l}(s,o,r,n,e,i):o.data[s],c=r[s]=lg(a,n,function Sk(){return Ot.lFrame.currentNamespace}()),u=Bd(l);return To(l,!0),Xy(a,c,l),32!=(32&l.flags)&&nh(o,r,c,l),0===function hk(){return Ot.lFrame.elementDepthCount}()&&Ii(c,r),function fk(){Ot.lFrame.elementDepthCount++}(),u&&(Bg(o,r,l),Lg(o,l,r)),null!==i&&zg(r,l),T}function P(){let t=_i();Ip()?Op():(t=t.parent,To(t,!1));const n=t;!function pk(){Ot.lFrame.elementDepthCount--}();const e=Jt();return e.firstCreatePass&&(Vd(e,t),Sp(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Ok(t){return 0!=(8&t.flags)}(n)&&qg(e,n,Se(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Ak(t){return 0!=(16&t.flags)}(n)&&qg(e,n,Se(),n.stylesWithoutHost,!1),P}function Le(t,n,e,i){return T(t,n,e,i),P(),Le}function je(t,n,e){const i=Se(),r=Jt(),o=t+Cn,s=r.firstCreatePass?function yA(t,n,e,i,r){const o=n.consts,s=Ns(o,i),a=Sl(n,t,8,"ng-container",s);return null!==s&&vh(a,s,!0),Vg(n,e,a,Ns(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];To(s,!0);const a=i[o]=i[Lt].createComment("");return nh(r,i,a,s),Ii(a,i),Bd(s)&&(Bg(r,i,s),Lg(r,s,i)),null!=e&&zg(i,s),je}function He(){let t=_i();const n=Jt();return Ip()?Op():(t=t.parent,To(t,!1)),n.firstCreatePass&&(Vd(n,t),Sp(t)&&n.queries.elementEnd(t)),He}function wn(t,n,e){return je(t,n,e),He(),wn}function et(){return Se()}function wh(t){return!!t&&"function"==typeof t.then}const g1=function p1(t){return!!t&&"function"==typeof t.subscribe};function de(t,n,e,i){const r=Se(),o=Jt(),s=_i();return function _1(t,n,e,i,r,o,s){const a=Bd(i),c=t.firstCreatePass&&Kb(t),u=n[Hn],h=qb(n);let g=!0;if(3&i.type||s){const Z=_r(i,n),re=s?s(Z):Z,oe=h.length,ce=s?be=>s(mi(be[i.index])):i.index;let ue=null;if(!s&&a&&(ue=function bA(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[ol],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==ue)(ue.__ngLastListenerFn__||ue).__ngNextListenerFn__=o,ue.__ngLastListenerFn__=o,g=!1;else{o=y1(i,n,u,o,!1);const be=e.listen(re,r,o);h.push(o,be),c&&c.push(r,ce,oe,oe+1)}}else o=y1(i,n,u,o,!1);const E=i.outputs;let L;if(g&&null!==E&&(L=E[r])){const Z=L.length;if(Z)for(let re=0;re<Z;re+=2){const Ke=n[L[re]][L[re+1]].subscribe(o),ft=h.length;h.push(o,Ke),c&&c.push(r,i.index,ft,-(ft+1))}}}(o,r,r[Lt],s,t,n,i),de}function v1(t,n,e,i){try{return Rr(6,n,e),!1!==e(i)}catch(r){return Qb(t,r),!1}finally{Rr(7,n,e)}}function y1(t,n,e,i,r){return function o(s){if(s===Function)return i;mh(t.componentOffset>-1?rr(t.index,n):n);let l=v1(n,e,i,s),c=o.__ngNextListenerFn__;for(;c;)l=v1(n,e,c,s)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(s.preventDefault(),s.returnValue=!1),l}}function H(t=1){return function wk(t){return(Ot.lFrame.contextLView=function Ek(t,n){for(;t>0;)n=n[sl],t--;return n}(t,Ot.lFrame.contextLView))[Hn]}(t)}function CA(t,n){let e=null;const i=function ZI(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?Db(t,o,!0):KI(i,o))return r}else e=r}return e}function Kg(t){const n=Se()[Mi][Si];if(!n.projection){const i=n.projection=Zc(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?CA(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function Xg(t,n=0,e){const i=Se(),r=Jt(),o=Sl(r,Cn+t,16,null,e||null);null===o.projection&&(o.projection=n),Op(),32!=(32&o.flags)&&function R2(t,n,e){qy(n[Lt],0,n,e,Uy(t,e,n),Gy(e.parent||n[Si],e,n))}(r,i,o)}function vn(t,n,e){return Qg(t,"",n,"",e),vn}function Qg(t,n,e,i,r){const o=Se(),s=kl(o,n,e,i);return s!==At&&br(Jt(),In(),o,t,s,o[Lt],r,!1),Qg}function Eh(t,n){return t<<17|n<<2}function Rs(t){return t>>17&32767}function Jg(t){return 2|t}function ya(t){return(131068&t)>>2}function em(t,n){return-131069&t|n<<2}function tm(t){return 1|t}function M1(t,n,e,i,r){const o=t[e+1],s=null===n;let a=i?Rs(o):ya(o),l=!1;for(;0!==a&&(!1===l||s);){const u=t[a+1];SA(t[a],n)&&(l=!0,t[a+1]=i?tm(u):Jg(u)),a=i?Rs(u):ya(u)}l&&(t[e+1]=i?Jg(o):tm(o))}function SA(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&_l(t,n)>=0}const si={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function k1(t){return t.substring(si.key,si.keyEnd)}function MA(t){return t.substring(si.value,si.valueEnd)}function O1(t,n){const e=si.textEnd;let i=si.key=Ll(t,n,e);return e===i?-1:(i=si.keyEnd=function AA(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=P1(t,i,e),i=si.value=Ll(t,i,e),i=si.valueEnd=function PA(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const l=t.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=F1(t,l,s,e):n===s-4&&85===o&&82===r&&76===i&&40===l?a=s=F1(t,41,s,e):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(t,i,e),P1(t,i,e))}function Ll(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function P1(t,n,e,i){return(n=Ll(t,n,e))<e&&n++,n}function F1(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function dn(t,n,e){return co(t,n,e,!1),dn}function Th(t,n){return co(t,n,null,!0),Th}function Cr(t){!function uo(t,n,e,i){const r=Jt(),o=cs(2);r.firstUpdatePass&&R1(r,null,o,i);const s=Se();if(e!==At&&Oi(s,o,e)){const a=r.data[$i()];if(U1(a,i)&&!N1(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=la(l,e||"")),qg(r,a,s,e,i)}else!function jA(t,n,e,i,r,o,s,a){r===At&&(r=nn);let l=0,c=0,u=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;null!==u||null!==h;){const g=l<r.length?r[l+1]:void 0,E=c<o.length?o[c+1]:void 0;let Z,L=null;u===h?(l+=2,c+=2,g!==E&&(L=h,Z=E)):null===h||null!==u&&u<h?(l+=2,L=u):(c+=2,L=h,Z=E),null!==L&&B1(t,n,e,i,L,Z,s,a),u=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}(r,a,s,s[Lt],s[o+1],s[o+1]=function UA(t,n,e){if(null==e||""===e)return nn;const i=[],r=yr(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}(L1,FA,t,!1)}function FA(t,n){for(let e=function IA(t){return function A1(t){si.key=0,si.keyEnd=0,si.value=0,si.valueEnd=0,si.textEnd=t.length}(t),O1(t,Ll(t,0,si.textEnd))}(n);e>=0;e=O1(n,e))L1(t,k1(n),MA(n))}function co(t,n,e,i){const r=Se(),o=Jt(),s=cs(2);o.firstUpdatePass&&R1(o,t,s,i),n!==At&&Oi(r,s,n)&&B1(o,o.data[$i()],r,r[Lt],t,r[s+1]=function HA(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=an(yr(t)))),t}(n,e),i,s)}function N1(t,n){return n>=t.expandoStartIndex}function R1(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[$i()],s=N1(t,e);U1(o,i)&&null===n&&!s&&(n=!1),n=function RA(t,n,e,i){const r=function Pp(t){const n=Ot.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=au(e=nm(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=nm(r,t,n,e,i),null===o){let l=function LA(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==ya(i))return t[Rs(i)]}(t,n,i);void 0!==l&&Array.isArray(l)&&(l=nm(null,t,n,l[1],i),l=au(l,n.attrs,i),function BA(t,n,e,i){t[Rs(e?n.classBindings:n.styleBindings)]=i}(t,n,i,l))}else o=function zA(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=au(i,t[o].hostAttrs,e);return au(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function xA(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Rs(s),l=ya(s);t[i]=e;let u,c=!1;if(Array.isArray(e)?(u=e[1],(null===u||_l(e,u)>0)&&(c=!0)):u=e,r)if(0!==l){const g=Rs(t[a+1]);t[i+1]=Eh(g,a),0!==g&&(t[g+1]=em(t[g+1],i)),t[a+1]=function EA(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Eh(a,0),0!==a&&(t[a+1]=em(t[a+1],i)),a=i;else t[i+1]=Eh(l,0),0===a?a=i:t[l+1]=em(t[l+1],i),l=i;c&&(t[i+1]=Jg(t[i+1])),M1(t,u,i,!0),M1(t,u,i,!1),function DA(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&_l(o,n)>=0&&(e[i+1]=tm(e[i+1]))}(n,u,t,i,o),s=Eh(a,l),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function nm(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=au(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function au(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),vr(t,s,!!e||n[++o]))}return void 0===t?null:t}function L1(t,n,e){vr(t,n,yr(e))}function B1(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const l=t.data,c=l[a+1],u=function TA(t){return 1==(1&t)}(c)?z1(l,n,e,r,ya(c),s):void 0;xh(u)||(xh(o)||function wA(t){return 2==(2&t)}(c)&&(o=z1(l,null,e,r,a,s)),function B2(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:or.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=or.Important),t.setStyle(e,i,r,o))}}(i,s,zd($i(),e),r,o))}function z1(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const l=t[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let g=e[r+1];g===At&&(g=h?nn:void 0);let E=h?Yp(g,i):u===i?g:void 0;if(c&&!xh(E)&&(E=Yp(l,i)),xh(E)&&(a=E,s))return a;const L=t[r+1];r=s?Rs(L):ya(L)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(a=Yp(l,i))}return a}function xh(t){return void 0!==t}function U1(t,n){return 0!=(t.flags&(n?8:16))}function q(t,n=""){const e=Se(),i=Jt(),r=t+Cn,o=i.firstCreatePass?Sl(i,r,1,n,null):i.data[r],s=e[r]=function ag(t,n){return t.createText(n)}(e[Lt],n);nh(i,e,s,o),To(o,!1)}function gt(t){return Gn("",t,""),gt}function Gn(t,n,e){const i=Se(),r=kl(i,t,n,e);return r!==At&&hs(i,$i(),r),Gn}function Bl(t,n,e,i,r){const o=Se(),s=Il(o,t,n,e,i,r);return s!==At&&hs(o,$i(),s),Bl}const ba=void 0;var cP=["en",[["a","p"],["AM","PM"],ba],[["AM","PM"],ba,ba],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ba,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ba,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ba,"{1} 'at' {0}",ba],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function lP(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let zl={};function Wi(t){const n=function uP(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=sC(n);if(e)return e;const i=n.split("-")[0];if(e=sC(i),e)return e;if("en"===i)return cP;throw new De(701,!1)}function sC(t){return t in zl||(zl[t]=bn.ng&&bn.ng.common&&bn.ng.common.locales&&bn.ng.common.locales[t]),zl[t]}var qe=(()=>((qe=qe||{})[qe.LocaleId=0]="LocaleId",qe[qe.DayPeriodsFormat=1]="DayPeriodsFormat",qe[qe.DayPeriodsStandalone=2]="DayPeriodsStandalone",qe[qe.DaysFormat=3]="DaysFormat",qe[qe.DaysStandalone=4]="DaysStandalone",qe[qe.MonthsFormat=5]="MonthsFormat",qe[qe.MonthsStandalone=6]="MonthsStandalone",qe[qe.Eras=7]="Eras",qe[qe.FirstDayOfWeek=8]="FirstDayOfWeek",qe[qe.WeekendRange=9]="WeekendRange",qe[qe.DateFormat=10]="DateFormat",qe[qe.TimeFormat=11]="TimeFormat",qe[qe.DateTimeFormat=12]="DateTimeFormat",qe[qe.NumberSymbols=13]="NumberSymbols",qe[qe.NumberFormats=14]="NumberFormats",qe[qe.CurrencyCode=15]="CurrencyCode",qe[qe.CurrencySymbol=16]="CurrencySymbol",qe[qe.CurrencyName=17]="CurrencyName",qe[qe.Currencies=18]="Currencies",qe[qe.Directionality=19]="Directionality",qe[qe.PluralCase=20]="PluralCase",qe[qe.ExtraData=21]="ExtraData",qe))();const Ul="en-US";let aC=Ul;function om(t,n,e,i,r){if(t=ut(t),Array.isArray(t))for(let o=0;o<t.length;o++)om(t[o],n,e,i,r);else{const o=Jt(),s=Se();let a=ma(t)?t:ut(t.provide),l=yb(t);const c=_i(),u=1048575&c.providerIndexes,h=c.directiveStart,g=c.providerIndexes>>20;if(ma(t)||!t.multi){const E=new Hc(l,r,J),L=am(a,n,r?u:u+g,h);-1===L?(Hp(Zd(c,s),o,a),sm(o,t,n.length),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(E),s.push(E)):(e[L]=E,s[L]=E)}else{const E=am(a,n,u+g,h),L=am(a,n,u,u+g),re=L>=0&&e[L];if(r&&!re||!r&&!(E>=0&&e[E])){Hp(Zd(c,s),o,a);const oe=function a3(t,n,e,i,r){const o=new Hc(t,e,J);return o.multi=[],o.index=n,o.componentProviders=0,AC(o,r,i&&!e),o}(r?s3:o3,e.length,r,i,l);!r&&re&&(e[L].providerFactory=oe),sm(o,t,n.length,0),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(oe),s.push(oe)}else sm(o,t,E>-1?E:L,AC(e[r?L:E],l,!r&&i));!r&&i&&re&&e[L].componentProviders++}}}function sm(t,n,e,i){const r=ma(n),o=function yI(t){return!!t.useClass}(n);if(r||o){const l=(o?ut(n.useClass):n).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function AC(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function am(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function o3(t,n,e,i){return lm(this.multi,[])}function s3(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=ha(e,e[Qe],this.providerFactory.index,i);o=a.slice(0,s),lm(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],lm(r,o);return o}function lm(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function En(t,n=[]){return e=>{e.providersResolver=(i,r)=>function r3(t,n,e){const i=Jt();if(i.firstCreatePass){const r=ao(t);om(e,i.data,i.blueprint,r,!0),om(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class Vl{}class l3{}class PC extends Vl{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Jb(this);const i=function gr(t,n){const e=t[Tv]||null;if(!e&&!0===n)throw new Error(`Type ${an(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function ds(t){return t instanceof Function?t():t}(i.bootstrap),this._r3Injector=Pb(n,e,[{provide:Vl,useValue:this},{provide:uh,useValue:this.componentFactoryResolver}],an(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class cm extends l3{constructor(n){super(),this.moduleType=n}create(n){return new PC(this.moduleType,n)}}function Ca(t,n,e){const i=Gi()+t,r=Se();return r[i]===At?ko(r,i,e?n.call(e):n()):function su(t,n){return t[n]}(r,i)}function dt(t,n,e,i){return function VC(t,n,e,i,r,o){const s=n+e;return Oi(t,s,r)?ko(t,s+1,o?i.call(o,r):i(r)):fu(t,s+1)}(Se(),Gi(),t,n,e,i)}function vi(t,n,e,i,r){return jC(Se(),Gi(),t,n,e,i,r)}function Ih(t,n,e,i,r,o){return function HC(t,n,e,i,r,o,s,a){const l=n+e;return function Ch(t,n,e,i,r){const o=va(t,n,e,i);return Oi(t,n+2,r)||o}(t,l,r,o,s)?ko(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):fu(t,l+3)}(Se(),Gi(),t,n,e,i,r,o)}function fu(t,n){const e=t[n];return e===At?void 0:e}function jC(t,n,e,i,r,o,s){const a=n+e;return va(t,a,r,o)?ko(t,a+2,s?i.call(s,r,o):i(r,o)):fu(t,a+2)}function Zt(t,n){const e=Jt();let i;const r=t+Cn;e.firstCreatePass?(i=function S3(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ua(i.type)),s=Nr(J);try{const a=Wd(!1),l=o();return Wd(a),function _A(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,Se(),r,l),l}finally{Nr(s)}}function Yt(t,n,e,i){const r=t+Cn,o=Se(),s=cl(o,r);return function pu(t,n){return t[Qe].data[n].pure}(o,r)?jC(o,Gi(),n,s.transform,e,i,s):s.transform(e,i)}function dm(t){return n=>{setTimeout(t,void 0,n)}}const Ht=class A3 extends Ue{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const l=n;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=dm(o),r&&(r=dm(r)),s&&(s=dm(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof p&&n.add(a),a}};function P3(){return this._results[Symbol.iterator]()}class hm{get changes(){return this._changes||(this._changes=new Ht)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=hm.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=P3)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=function Lr(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function jk(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let fs=(()=>{class t{}return t.__NG_ELEMENT_ID__=R3,t})();const F3=fs,N3=class extends F3{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n,e){const i=this._declarationTContainer.tView,r=fh(this._declarationLView,i,n,16,null,i.declTNode,null,null,null,null,e||null);r[zc]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[Eo];return null!==s&&(r[Eo]=s.createEmbeddedView(i)),Rg(i,r,n),new ru(r)}};function R3(){return Oh(_i(),Se())}function Oh(t,n){return 4&t.type?new N3(n,t,El(t,n)):null}let ar=(()=>{class t{}return t.__NG_ELEMENT_ID__=L3,t})();function L3(){return YC(_i(),Se())}const B3=ar,WC=class extends B3{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return El(this._hostTNode,this._hostLView)}get injector(){return new hl(this._hostTNode,this._hostLView)}get parentInjector(){const n=jp(this._hostTNode,this._hostLView);if(iy(n)){const e=$d(n,this._hostLView),i=Gd(n);return new hl(e[Qe].data[i+8],e)}return new hl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=ZC(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-Hi}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=n.createEmbeddedView(e||{},o);return this.insert(s,r),s}createComponent(n,e,i,r,o){const s=n&&!function Wc(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const h=e||{};a=h.index,i=h.injector,r=h.projectableNodes,o=h.environmentInjector||h.ngModuleRef}const l=s?n:new ou(un(n)),c=i||this.parentInjector;if(!o&&null==l.ngModule){const g=(s?c:this.parentInjector).get(Cl,null);g&&(o=g)}const u=l.create(c,r,void 0,o);return this.insert(u.hostView,a),u}insert(n,e){const i=n._lView,r=i[Qe];if(function dk(t){return so(t[Ln])}(i)){const u=this.indexOf(n);if(-1!==u)this.detach(u);else{const h=i[Ln],g=new WC(h,h[Si],h[Ln]);g.detach(g.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;!function I2(t,n,e,i){const r=Hi+i,o=e.length;i>0&&(e[r-1][oo]=n),i<o-Hi?(n[oo]=e[r],gy(e,Hi+i,n)):(e.push(n),n[oo]=null),n[Ln]=e;const s=n[zc];null!==s&&e!==s&&function O2(t,n){const e=t[ll];n[Mi]!==n[Ln][Ln][Mi]&&(t[Iv]=!0),null===e?t[ll]=[n]:e.push(n)}(s,n);const a=n[Eo];null!==a&&a.insertView(t),n[Ft]|=64}(r,i,s,o);const a=hg(o,s),l=i[Lt],c=th(l,s[Rd]);return null!==c&&function S2(t,n,e,i,r,o){i[as]=r,i[Si]=n,Qc(t,i,e,1,r,o)}(r,s[Si],l,i,c,a),n.attachToViewContainerRef(),gy(fm(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=ZC(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=cg(this._lContainer,e);i&&(qd(fm(this._lContainer),e),zy(i[Qe],i))}detach(n){const e=this._adjustIndex(n,-1),i=cg(this._lContainer,e);return i&&null!=qd(fm(this._lContainer),e)?new ru(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function ZC(t){return t[Ld]}function fm(t){return t[Ld]||(t[Ld]=[])}function YC(t,n){let e;const i=n[t.index];if(so(i))e=i;else{let r;if(8&t.type)r=mi(i);else{const o=n[Lt];r=o.createComment("");const s=_r(t,n);pa(o,th(o,s),r,function N2(t,n){return t.nextSibling(n)}(o,s),!1)}n[t.index]=e=Yb(i,n,r,t),gh(n,e)}return new WC(e,t,n)}class pm{constructor(n){this.queryList=n,this.matches=null}clone(){return new pm(this.queryList)}setDirty(){this.queryList.setDirty()}}class gm{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new gm(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==JC(n,e).matches&&this.queries[e].setDirty()}}class qC{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class mm{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new mm(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class _m{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new _m(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,z3(e,o)),this.matchTNodeWithReadOption(n,e,Yd(e,n,o,!1,!1))}else i===fs?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Yd(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Bn||r===ar||r===fs&&4&e.type)this.addMatch(e.index,-2);else{const o=Yd(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function z3(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function V3(t,n,e,i){return-1===e?function U3(t,n){return 11&t.type?El(t,n):4&t.type?Oh(t,n):null}(n,t):-2===e?function j3(t,n,e){return e===Bn?El(n,t):e===fs?Oh(n,t):e===ar?YC(n,t):void 0}(t,n,i):ha(t,t[Qe],e,n)}function KC(t,n,e,i){const r=n[Eo].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let l=0;l<s.length;l+=2){const c=s[l];a.push(c<0?null:V3(n,o[c],s[l+1],e.metadata.read))}r.matches=a}return r.matches}function vm(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=KC(t,n,r,e);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const c=o[a+1],u=n[-l];for(let h=Hi;h<u.length;h++){const g=u[h];g[zc]===g[Ln]&&vm(g[Qe],g,c,i)}if(null!==u[ll]){const h=u[ll];for(let g=0;g<h.length;g++){const E=h[g];vm(E[Qe],E,c,i)}}}}}return i}function On(t){const n=Se(),e=Jt(),i=Wv();Fp(i+1);const r=JC(e,i);if(t.dirty&&function uk(t){return 4==(4&t[Ft])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?vm(e,n,i,[]):KC(e,n,r,i);t.reset(o,II),t.notifyOnChanges()}return!0}return!1}function An(t,n,e){const i=Jt();i.firstCreatePass&&(function QC(t,n,e){null===t.queries&&(t.queries=new mm),t.queries.track(new _m(n,e))}(i,new qC(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function XC(t,n,e){const i=new hm(4==(4&e));Hb(t,n,i,i.destroy),null===n[Eo]&&(n[Eo]=new gm),n[Eo].queries.push(new pm(i))}(i,Se(),n)}function Pn(){return function G3(t,n){return t[Eo].queries[n].queryList}(Se(),Wv())}function JC(t,n){return t.queries.getByIndex(n)}function Un(t,n){return Oh(t,n)}function Ph(...t){}const vw=new St("Application Initializer");let Fh=(()=>{class t{constructor(e){this.appInits=e,this.resolve=Ph,this.reject=Ph,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(wh(o))e.push(o);else if(g1(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(bt(vw,8))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const mu=new St("AppId",{providedIn:"root",factory:function yw(){return`${Em()}${Em()}${Em()}`}});function Em(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const bw=new St("Platform Initializer"),Cw=new St("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),ww=new St("AnimationModuleType"),ps=new St("LocaleId",{providedIn:"root",factory:()=>Ev(ps,Dt.Optional|Dt.SkipSelf)||function dF(){return typeof $localize<"u"&&$localize.locale||Ul}()}),mF=(()=>Promise.resolve(0))();function Tm(t){typeof Zone>"u"?mF.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Gt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ht(!1),this.onMicrotaskEmpty=new Ht(!1),this.onStable=new Ht(!1),this.onError=new Ht(!1),typeof Zone>"u")throw new De(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function _F(){let t=bn.requestAnimationFrame,n=bn.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function bF(t){const n=()=>{!function yF(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(bn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Dm(t),t.isCheckStableRunning=!0,xm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Dm(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return xw(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),Dw(t)}},onInvoke:(e,i,r,o,s,a,l)=>{try{return xw(t),e.invoke(r,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),Dw(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,Dm(t),xm(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gt.isInAngularZone())throw new De(909,!1)}static assertNotInAngularZone(){if(Gt.isInAngularZone())throw new De(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,vF,Ph,Ph);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const vF={};function xm(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Dm(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function xw(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Dw(t){t._nesting--,xm(t)}class CF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ht,this.onMicrotaskEmpty=new Ht,this.onStable=new Ht,this.onError=new Ht}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}const Sw=new St(""),Nh=new St("");let km,Sm=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,km||(function wF(t){km=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gt.assertNotInAngularZone(),Tm(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Tm(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt),bt(Mm),bt(Nh))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})(),Mm=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return km?.findTestabilityInTree(this,e,i)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const gs=!1;let Ls=null;const Mw=new St("AllowMultipleToken"),Im=new St("PlatformDestroyListeners"),EF=new St("appBootstrapListener");function Iw(t,n,e=[]){const i=`Platform: ${n}`,r=new St(i);return(o=[])=>{let s=Om();if(!s||s.injector.get(Mw,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function DF(t){if(Ls&&!Ls.get(Mw,!1))throw new De(400,!1);Ls=t;const n=t.get(Aw);(function kw(t){const n=t.get(bw,null);n&&n.forEach(e=>e())})(t)}(function Ow(t=[],n){return So.create({name:n,providers:[{provide:Tg,useValue:"platform"},{provide:Im,useValue:new Set([()=>Ls=null])},...t]})}(a,i))}return function MF(t){const n=Om();if(!n)throw new De(401,!1);return n}()}}function Om(){return Ls?.get(Aw)??null}let Aw=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function Fw(t,n){let e;return e="noop"===t?new CF:("zone.js"===t?void 0:t)||new Gt(n),e}(i?.ngZone,function Pw(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(i)),o=[{provide:Gt,useValue:r}];return r.run(()=>{const s=So.create({providers:o,parent:this.injector,name:e.moduleType.name}),a=e.create(s),l=a.injector.get(Tl,null);if(!l)throw new De(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Lh(this._modules,a),c.unsubscribe()})}),function Nw(t,n,e){try{const i=e();return wh(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(Fh);return c.runInitializers(),c.donePromise.then(()=>(function lC(t){Fr(t,"Expected localeId to be defined"),"string"==typeof t&&(aC=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(ps,Ul)||Ul),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,i=[]){const r=Rw({},i);return function TF(t,n,e){const i=new cm(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Rh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new De(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new De(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(Im,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(bt(So))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function Rw(t,n){return Array.isArray(n)?n.reduce(Rw,t):{...t,...n}}let Rh=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,i,r){this._zone=e,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new xe(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new xe(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Gt.assertNotInAngularZone(),Tm(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Gt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=Dd(o,s.pipe(function Sd(t={}){const{connector:n=(()=>new Ue),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return o=>{let s,a,l,c=0,u=!1,h=!1;const g=()=>{a?.unsubscribe(),a=void 0},E=()=>{g(),s=l=void 0,u=h=!1},L=()=>{const Z=s;E(),Z?.unsubscribe()};return Ie((Z,re)=>{c++,!h&&!u&&g();const oe=l=l??n();re.add(()=>{c--,0===c&&!h&&!u&&(a=As(L,r))}),oe.subscribe(re),!s&&c>0&&(s=new Ce({next:ce=>oe.next(ce),error:ce=>{h=!0,g(),a=As(E,e,ce),oe.error(ce)},complete:()=>{u=!0,g(),a=As(E,i),oe.complete()}}),eo(Z).subscribe(s))})(o)}}()))}bootstrap(e,i){const r=e instanceof bb;if(!this._injector.get(Fh).done){!r&&function Lc(t){const n=un(t)||Di(t)||ir(t);return null!==n&&n.standalone}(e);throw new De(405,gs)}let s;s=r?e:this._injector.get(uh).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function xF(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Vl),c=s.create(So.NULL,[],i||s.selector,a),u=c.location.nativeElement,h=c.injector.get(Sw,null);return h?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Lh(this.components,c),h?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new De(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Lh(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(EF,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Lh(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new De(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt),bt(Cl),bt(Tl))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Lh(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let Ai=(()=>{class t{}return t.__NG_ELEMENT_ID__=IF,t})();function IF(t){return function OF(t,n,e){if(Vc(t)&&!e){const i=rr(t.index,n);return new ru(i,i)}return 47&t.type?new ru(n[Mi],n):null}(_i(),Se(),16==(16&t))}class Vw{constructor(){}supports(n){return bh(n)}create(n){return new LF(n)}}const RF=(t,n)=>n;class LF{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||RF}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<Hw(i,r,o)?e:i,a=Hw(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const c=a-r,u=l-r;if(c!=u){for(let g=0;g<c;g++){const E=g<o.length?o[g]:o[g]=0,L=E+g;u<=L&&L<c&&(o[g]=E+1)}o[s.previousIndex]=u-c}}a!==l&&n(s,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!bh(n))throw new De(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function fA(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new BF(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new jw),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new jw),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class BF{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class zF{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class jw{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new zF,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Hw(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class Gw{constructor(){}supports(n){return n instanceof Map||Yg(n)}create(){return new UF}}class UF{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||Yg(n)))throw new De(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new VF(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class VF{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function $w(){return new Uh([new Vw])}let Uh=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||$w()),deps:[[t,new Qd,new Xd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new De(901,!1)}}return t.\u0275prov=kt({token:t,providedIn:"root",factory:$w}),t})();function Ww(){return new _u([new Gw])}let _u=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||Ww()),deps:[[t,new Qd,new Xd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new De(901,!1)}}return t.\u0275prov=kt({token:t,providedIn:"root",factory:Ww}),t})();const GF=Iw(null,"core",[]);let $F=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(bt(Rh))},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({}),t})();function Rm(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let Lm=null;function Gl(){return Lm}class YF{}const wr=new St("DocumentToken");var $n=(()=>(($n=$n||{})[$n.Format=0]="Format",$n[$n.Standalone=1]="Standalone",$n))(),$t=(()=>(($t=$t||{})[$t.Narrow=0]="Narrow",$t[$t.Abbreviated=1]="Abbreviated",$t[$t.Wide=2]="Wide",$t[$t.Short=3]="Short",$t))(),Fn=(()=>((Fn=Fn||{})[Fn.Short=0]="Short",Fn[Fn.Medium=1]="Medium",Fn[Fn.Long=2]="Long",Fn[Fn.Full=3]="Full",Fn))(),mt=(()=>((mt=mt||{})[mt.Decimal=0]="Decimal",mt[mt.Group=1]="Group",mt[mt.List=2]="List",mt[mt.PercentSign=3]="PercentSign",mt[mt.PlusSign=4]="PlusSign",mt[mt.MinusSign=5]="MinusSign",mt[mt.Exponential=6]="Exponential",mt[mt.SuperscriptingExponent=7]="SuperscriptingExponent",mt[mt.PerMille=8]="PerMille",mt[mt.Infinity=9]="Infinity",mt[mt.NaN=10]="NaN",mt[mt.TimeSeparator=11]="TimeSeparator",mt[mt.CurrencyDecimal=12]="CurrencyDecimal",mt[mt.CurrencyGroup=13]="CurrencyGroup",mt))();function Vh(t,n){return Vr(Wi(t)[qe.DateFormat],n)}function jh(t,n){return Vr(Wi(t)[qe.TimeFormat],n)}function Hh(t,n){return Vr(Wi(t)[qe.DateTimeFormat],n)}function Ur(t,n){const e=Wi(t),i=e[qe.NumberSymbols][n];if(typeof i>"u"){if(n===mt.CurrencyDecimal)return e[qe.NumberSymbols][mt.Decimal];if(n===mt.CurrencyGroup)return e[qe.NumberSymbols][mt.Group]}return i}function qw(t){if(!t[qe.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[qe.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Vr(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function zm(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const cN=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,vu={},uN=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var ai=(()=>((ai=ai||{})[ai.Short=0]="Short",ai[ai.ShortGMT=1]="ShortGMT",ai[ai.Long=2]="Long",ai[ai.Extended=3]="Extended",ai))(),yt=(()=>((yt=yt||{})[yt.FullYear=0]="FullYear",yt[yt.Month=1]="Month",yt[yt.Date=2]="Date",yt[yt.Hours=3]="Hours",yt[yt.Minutes=4]="Minutes",yt[yt.Seconds=5]="Seconds",yt[yt.FractionalSeconds=6]="FractionalSeconds",yt[yt.Day=7]="Day",yt))(),Nt=(()=>((Nt=Nt||{})[Nt.DayPeriods=0]="DayPeriods",Nt[Nt.Days=1]="Days",Nt[Nt.Months=2]="Months",Nt[Nt.Eras=3]="Eras",Nt))();function dN(t,n,e,i){let r=function bN(t){if(Qw(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return Gh(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(cN))return function CN(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,l,c),n}(i)}const n=new Date(t);if(!Qw(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=ms(e,n)||n;let a,s=[];for(;n;){if(a=uN.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;n=u}}let l=r.getTimezoneOffset();i&&(l=Xw(i,l),r=function yN(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function vN(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(Xw(n,r)-r))}(r,i,!0));let c="";return s.forEach(u=>{const h=function _N(t){if(Vm[t])return Vm[t];let n;switch(t){case"G":case"GG":case"GGG":n=yn(Nt.Eras,$t.Abbreviated);break;case"GGGG":n=yn(Nt.Eras,$t.Wide);break;case"GGGGG":n=yn(Nt.Eras,$t.Narrow);break;case"y":n=Jn(yt.FullYear,1,0,!1,!0);break;case"yy":n=Jn(yt.FullYear,2,0,!0,!0);break;case"yyy":n=Jn(yt.FullYear,3,0,!1,!0);break;case"yyyy":n=Jn(yt.FullYear,4,0,!1,!0);break;case"Y":n=Yh(1);break;case"YY":n=Yh(2,!0);break;case"YYY":n=Yh(3);break;case"YYYY":n=Yh(4);break;case"M":case"L":n=Jn(yt.Month,1,1);break;case"MM":case"LL":n=Jn(yt.Month,2,1);break;case"MMM":n=yn(Nt.Months,$t.Abbreviated);break;case"MMMM":n=yn(Nt.Months,$t.Wide);break;case"MMMMM":n=yn(Nt.Months,$t.Narrow);break;case"LLL":n=yn(Nt.Months,$t.Abbreviated,$n.Standalone);break;case"LLLL":n=yn(Nt.Months,$t.Wide,$n.Standalone);break;case"LLLLL":n=yn(Nt.Months,$t.Narrow,$n.Standalone);break;case"w":n=Um(1);break;case"ww":n=Um(2);break;case"W":n=Um(1,!0);break;case"d":n=Jn(yt.Date,1);break;case"dd":n=Jn(yt.Date,2);break;case"c":case"cc":n=Jn(yt.Day,1);break;case"ccc":n=yn(Nt.Days,$t.Abbreviated,$n.Standalone);break;case"cccc":n=yn(Nt.Days,$t.Wide,$n.Standalone);break;case"ccccc":n=yn(Nt.Days,$t.Narrow,$n.Standalone);break;case"cccccc":n=yn(Nt.Days,$t.Short,$n.Standalone);break;case"E":case"EE":case"EEE":n=yn(Nt.Days,$t.Abbreviated);break;case"EEEE":n=yn(Nt.Days,$t.Wide);break;case"EEEEE":n=yn(Nt.Days,$t.Narrow);break;case"EEEEEE":n=yn(Nt.Days,$t.Short);break;case"a":case"aa":case"aaa":n=yn(Nt.DayPeriods,$t.Abbreviated);break;case"aaaa":n=yn(Nt.DayPeriods,$t.Wide);break;case"aaaaa":n=yn(Nt.DayPeriods,$t.Narrow);break;case"b":case"bb":case"bbb":n=yn(Nt.DayPeriods,$t.Abbreviated,$n.Standalone,!0);break;case"bbbb":n=yn(Nt.DayPeriods,$t.Wide,$n.Standalone,!0);break;case"bbbbb":n=yn(Nt.DayPeriods,$t.Narrow,$n.Standalone,!0);break;case"B":case"BB":case"BBB":n=yn(Nt.DayPeriods,$t.Abbreviated,$n.Format,!0);break;case"BBBB":n=yn(Nt.DayPeriods,$t.Wide,$n.Format,!0);break;case"BBBBB":n=yn(Nt.DayPeriods,$t.Narrow,$n.Format,!0);break;case"h":n=Jn(yt.Hours,1,-12);break;case"hh":n=Jn(yt.Hours,2,-12);break;case"H":n=Jn(yt.Hours,1);break;case"HH":n=Jn(yt.Hours,2);break;case"m":n=Jn(yt.Minutes,1);break;case"mm":n=Jn(yt.Minutes,2);break;case"s":n=Jn(yt.Seconds,1);break;case"ss":n=Jn(yt.Seconds,2);break;case"S":n=Jn(yt.FractionalSeconds,1);break;case"SS":n=Jn(yt.FractionalSeconds,2);break;case"SSS":n=Jn(yt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=Wh(ai.Short);break;case"ZZZZZ":n=Wh(ai.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=Wh(ai.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=Wh(ai.Long);break;default:return null}return Vm[t]=n,n}(u);c+=h?h(r,e,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Gh(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function ms(t,n){const e=function XF(t){return Wi(t)[qe.LocaleId]}(t);if(vu[e]=vu[e]||{},vu[e][n])return vu[e][n];let i="";switch(n){case"shortDate":i=Vh(t,Fn.Short);break;case"mediumDate":i=Vh(t,Fn.Medium);break;case"longDate":i=Vh(t,Fn.Long);break;case"fullDate":i=Vh(t,Fn.Full);break;case"shortTime":i=jh(t,Fn.Short);break;case"mediumTime":i=jh(t,Fn.Medium);break;case"longTime":i=jh(t,Fn.Long);break;case"fullTime":i=jh(t,Fn.Full);break;case"short":const r=ms(t,"shortTime"),o=ms(t,"shortDate");i=$h(Hh(t,Fn.Short),[r,o]);break;case"medium":const s=ms(t,"mediumTime"),a=ms(t,"mediumDate");i=$h(Hh(t,Fn.Medium),[s,a]);break;case"long":const l=ms(t,"longTime"),c=ms(t,"longDate");i=$h(Hh(t,Fn.Long),[l,c]);break;case"full":const u=ms(t,"fullTime"),h=ms(t,"fullDate");i=$h(Hh(t,Fn.Full),[u,h])}return i&&(vu[e][n]=i),i}function $h(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function fo(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function Jn(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function fN(t,n){switch(t){case yt.FullYear:return n.getFullYear();case yt.Month:return n.getMonth();case yt.Date:return n.getDate();case yt.Hours:return n.getHours();case yt.Minutes:return n.getMinutes();case yt.Seconds:return n.getSeconds();case yt.FractionalSeconds:return n.getMilliseconds();case yt.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===yt.Hours)0===a&&-12===e&&(a=12);else if(t===yt.FractionalSeconds)return function hN(t,n){return fo(t,3).substring(0,n)}(a,n);const l=Ur(s,mt.MinusSign);return fo(a,n,l,i,r)}}function yn(t,n,e=$n.Format,i=!1){return function(r,o){return function pN(t,n,e,i,r,o){switch(e){case Nt.Months:return function eN(t,n,e){const i=Wi(t),o=Vr([i[qe.MonthsFormat],i[qe.MonthsStandalone]],n);return Vr(o,e)}(n,r,i)[t.getMonth()];case Nt.Days:return function JF(t,n,e){const i=Wi(t),o=Vr([i[qe.DaysFormat],i[qe.DaysStandalone]],n);return Vr(o,e)}(n,r,i)[t.getDay()];case Nt.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const c=function rN(t){const n=Wi(t);return qw(n),(n[qe.ExtraData][2]||[]).map(i=>"string"==typeof i?zm(i):[zm(i[0]),zm(i[1])])}(n),u=function oN(t,n,e){const i=Wi(t);qw(i);const o=Vr([i[qe.ExtraData][0],i[qe.ExtraData][1]],n)||[];return Vr(o,e)||[]}(n,r,i),h=c.findIndex(g=>{if(Array.isArray(g)){const[E,L]=g,Z=s>=E.hours&&a>=E.minutes,re=s<L.hours||s===L.hours&&a<L.minutes;if(E.hours<L.hours){if(Z&&re)return!0}else if(Z||re)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(-1!==h)return u[h]}return function QF(t,n,e){const i=Wi(t),o=Vr([i[qe.DayPeriodsFormat],i[qe.DayPeriodsStandalone]],n);return Vr(o,e)}(n,r,i)[s<12?0:1];case Nt.Eras:return function tN(t,n){return Vr(Wi(t)[qe.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function Wh(t){return function(n,e,i){const r=-1*i,o=Ur(e,mt.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case ai.Short:return(r>=0?"+":"")+fo(s,2,o)+fo(Math.abs(r%60),2,o);case ai.ShortGMT:return"GMT"+(r>=0?"+":"")+fo(s,1,o);case ai.Long:return"GMT"+(r>=0?"+":"")+fo(s,2,o)+":"+fo(Math.abs(r%60),2,o);case ai.Extended:return 0===i?"Z":(r>=0?"+":"")+fo(s,2,o)+":"+fo(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const gN=0,Zh=4;function Kw(t){return Gh(t.getFullYear(),t.getMonth(),t.getDate()+(Zh-t.getDay()))}function Um(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=Kw(e),s=function mN(t){const n=Gh(t,gN,1).getDay();return Gh(t,0,1+(n<=Zh?Zh:Zh+7)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return fo(r,t,Ur(i,mt.MinusSign))}}function Yh(t,n=!1){return function(e,i){return fo(Kw(e).getFullYear(),t,Ur(i,mt.MinusSign),n)}}const Vm={};function Xw(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function Qw(t){return t instanceof Date&&!isNaN(t.valueOf())}const Zm=/\s+/,nE=[];let li=(()=>{class t{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this.initialClasses=nE,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(Zm):nE}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(Zm):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,Boolean(e[i]));this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(Zm).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(J(Uh),J(_u),J(Bn),J(_a))},t.\u0275dir=vt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class NN{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Vn=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new NN(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),oE(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{oE(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(J(ar),J(fs),J(Uh))},t.\u0275dir=vt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function oE(t,n){t.context.$implicit=n.item}let pn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new LN,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){sE("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){sE("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(J(ar),J(fs))},t.\u0275dir=vt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class LN{constructor(){this.$implicit=null,this.ngIf=null}}function sE(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${an(n)}'.`)}class Ym{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Ea=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),bu=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new Ym(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(J(ar),J(fs),J(Ea,9))},t.\u0275dir=vt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})(),Cu=(()=>{class t{constructor(e,i,r){r._addDefault(new Ym(e,i))}}return t.\u0275fac=function(e){return new(e||t)(J(ar),J(fs),J(Ea,9))},t.\u0275dir=vt({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0}),t})(),Ta=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:or.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(J(Bn),J(_u),J(_a))},t.\u0275dir=vt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),wu=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:o,ngTemplateOutletInjector:s}=this;this._viewRef=i.createEmbeddedView(r,o,s?{injector:s}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(J(ar))},t.\u0275dir=vt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[kn]}),t})();const qN=new St("DATE_PIPE_DEFAULT_TIMEZONE"),KN=new St("DATE_PIPE_DEFAULT_OPTIONS");let lE=(()=>{class t{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return dN(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw function po(t,n){return new De(2100,!1)}()}}}return t.\u0275fac=function(e){return new(e||t)(J(ps,16),J(qN,24),J(KN,24))},t.\u0275pipe=ji({name:"date",type:t,pure:!0,standalone:!0}),t})(),uE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({}),t})();class LR extends YF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Jm extends LR{static makeCurrent(){!function ZF(t){Lm||(Lm=t)}(new Jm)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function BR(){return Tu=Tu||document.querySelector("base"),Tu?Tu.getAttribute("href"):null}();return null==e?null:function zR(t){Qh=Qh||document.createElement("a"),Qh.setAttribute("href",t);const n=Qh.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){Tu=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function PN(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let Qh,Tu=null;const _E=new St("TRANSITION_ID"),VR=[{provide:vw,useFactory:function UR(t,n,e){return()=>{e.get(Fh).donePromise.then(()=>{const i=Gl(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[_E,wr,So],multi:!0}];let HR=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();const Jh=new St("EventManagerPlugins");let ef=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(bt(Jh),bt(Gt))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();class vE{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=Gl().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let yE=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,i){const r=this.usageCount;let o=r.get(e)??0;return o+=i,o>0?r.set(e,o):r.delete(e),o}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})(),xu=(()=>{class t extends yE{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.forEach(o=>o.remove()),i.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,i){const r=this.doc.createElement("style");r.textContent=i,e.appendChild(r);const o=this.styleRef.get(i);o?o.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return t.\u0275fac=function(e){return new(e||t)(bt(wr))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();const e_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},t_=/%COMP%/g,wE=new St("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function EE(t,n){return n.flat(100).map(e=>e.replace(t_,t))}function TE(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let tf=(()=>{class t{constructor(e,i,r,o){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=o,this.rendererByCompId=new Map,this.defaultRenderer=new n_(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(e,i);return r instanceof SE?r.applyToHost(e):r instanceof i_&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case ro.Emulated:o=new SE(s,a,i,this.appId,l);break;case ro.ShadowDom:return new KR(s,a,e,i);default:o=new i_(s,a,i,l)}o.onDestroy=()=>r.delete(i.id),r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(bt(ef),bt(xu),bt(mu),bt(wE))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();class n_{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(e_[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(DE(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(DE(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=e_[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=e_[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(or.DashCase|or.Important)?n.style.setProperty(e,i,r&or.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&or.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,TE(i)):this.eventManager.addEventListener(n,e,TE(i))}}function DE(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class KR extends n_{constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=EE(r.id,r.styles);for(const s of o){const a=document.createElement("style");a.textContent=s,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class i_ extends n_{constructor(n,e,i,r,o=i.id){super(n),this.sharedStylesHost=e,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=EE(o,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class SE extends i_{constructor(n,e,i,r,o){const s=r+"-"+i.id;super(n,e,i,o,s),this.contentAttr=function ZR(t){return"_ngcontent-%COMP%".replace(t_,t)}(s),this.hostAttr=function YR(t){return"_nghost-%COMP%".replace(t_,t)}(s)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let XR=(()=>{class t extends vE{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(bt(wr))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();const ME=["alt","control","meta","shift"],QR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},JR={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let eL=(()=>{class t extends vE{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Gl().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),ME.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),s+=c+".")}),s+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(e,i){let r=QR[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),ME.forEach(s=>{s!==r&&(0,JR[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(bt(wr))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();const IE=[{provide:Cw,useValue:"browser"},{provide:bw,useValue:function tL(){Jm.makeCurrent()},multi:!0},{provide:wr,useFactory:function iL(){return function H2(t){mg=t}(document),document},deps:[]}],rL=Iw(GF,"browser",IE),OE=new St(""),AE=[{provide:Nh,useClass:class jR{addToWindow(n){bn.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},bn.getAllAngularTestabilities=()=>n.getAllTestabilities(),bn.getAllAngularRootElements=()=>n.getAllRootElements(),bn.frameworkStabilizers||(bn.frameworkStabilizers=[]),bn.frameworkStabilizers.push(i=>{const r=bn.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(l){s=s||l,o--,0==o&&i(s)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?Gl().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:Sw,useClass:Sm,deps:[Gt,Mm,Nh]},{provide:Sm,useClass:Sm,deps:[Gt,Mm,Nh]}],PE=[{provide:Tg,useValue:"root"},{provide:Tl,useFactory:function nL(){return new Tl},deps:[]},{provide:Jh,useClass:XR,multi:!0,deps:[wr,Gt,Cw]},{provide:Jh,useClass:eL,multi:!0,deps:[wr]},{provide:tf,useClass:tf,deps:[ef,xu,mu,wE]},{provide:tu,useExisting:tf},{provide:yE,useExisting:xu},{provide:xu,useClass:xu,deps:[wr]},{provide:ef,useClass:ef,deps:[Jh,Gt]},{provide:class uR{},useClass:HR,deps:[]},[]];let FE=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:mu,useValue:e.appId},{provide:_E,useExisting:mu},VR]}}}return t.\u0275fac=function(e){return new(e||t)(bt(OE,12))},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({providers:[...PE,...AE],imports:[uE,$F]}),t})();typeof window<"u"&&window;let LE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:function(e){let i=null;return i=e?new(e||t):bt(BE),i},providedIn:"root"}),t})(),BE=(()=>{class t extends LE{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case _n.NONE:return i;case _n.HTML:return Do(i,"HTML")?yr(i):lb(this._doc,String(i)).toString();case _n.STYLE:return Do(i,"Style")?yr(i):i;case _n.SCRIPT:if(Do(i,"Script"))return yr(i);throw new Error("unsafe value used in a script context");case _n.URL:return Do(i,"URL")?yr(i):sh(String(i));case _n.RESOURCE_URL:if(Do(i,"ResourceURL"))return yr(i);throw new Error(`unsafe value used in a resource URL context (see ${Fs})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${Fs})`)}}bypassSecurityTrustHtml(e){return function K2(t){return new G2(t)}(e)}bypassSecurityTrustStyle(e){return function X2(t){return new $2(t)}(e)}bypassSecurityTrustScript(e){return function Q2(t){return new W2(t)}(e)}bypassSecurityTrustUrl(e){return function J2(t){return new Z2(t)}(e)}bypassSecurityTrustResourceUrl(e){return function eI(t){return new Y2(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(bt(wr))},t.\u0275prov=kt({token:t,factory:function(e){let i=null;return i=e?new e:function dL(t){return new BE(t.get(wr))}(bt(So)),i},providedIn:"root"}),t})();Y(5386);const{isArray:hL}=Array,{getPrototypeOf:fL,prototype:pL,keys:gL}=Object;const{isArray:vL}=Array;function CL(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function wL(...t){const n=function sa(t){return O(ns(t))?t.pop():void 0}(t),{args:e,keys:i}=function mL(t){if(1===t.length){const n=t[0];if(hL(n))return{args:n,keys:null};if(function _L(t){return t&&"object"==typeof t&&fL(t)===pL}(n)){const e=gL(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new xe(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let l=s,c=s;for(let u=0;u<s;u++){let h=!1;eo(e[u]).subscribe(Fe(o,g=>{h||(h=!0,c--),a[u]=g},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?CL(i,a):a),o.complete())}))}});return n?r.pipe(function bL(t){return nt(n=>function yL(t,n){return vL(n)?t(...n):t(n)}(t,n))}(n)):r}let zE=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Bn))},t.\u0275dir=vt({type:t}),t})(),xa=(()=>{class t extends zE{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,features:[fn]}),t})();const Oo=new St("NgValueAccessor"),EL={provide:Oo,useExisting:ln(()=>s_),multi:!0};let s_=(()=>{class t extends xa{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&de("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[En([EL]),fn]}),t})();const TL={provide:Oo,useExisting:ln(()=>Pi),multi:!0},DL=new St("CompositionEventMode");let Pi=(()=>{class t extends zE{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function xL(){const t=Gl()?Gl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Bn),J(DL,8))},t.\u0275dir=vt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&de("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[En([TL]),fn]}),t})();const SL=!1;function zs(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function UE(t){return null!=t&&"number"==typeof t.length}const Fi=new St("NgValidators"),Us=new St("NgAsyncValidators");function HE(t){return zs(t.value)?{required:!0}:null}function nf(t){return null}function qE(t){return null!=t}function KE(t){const n=wh(t)?Pr(t):t;if(SL&&!g1(n)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new De(-1101,e)}return n}function XE(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function QE(t,n){return n.map(e=>e(t))}function JE(t){return t.map(n=>function kL(t){return!t.validate}(n)?n:e=>n.validate(e))}function a_(t){return null!=t?function eT(t){if(!t)return null;const n=t.filter(qE);return 0==n.length?null:function(e){return XE(QE(e,n))}}(JE(t)):null}function l_(t){return null!=t?function tT(t){if(!t)return null;const n=t.filter(qE);return 0==n.length?null:function(e){return wL(QE(e,n).map(KE)).pipe(nt(XE))}}(JE(t)):null}function nT(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function c_(t){return t?Array.isArray(t)?t:[t]:[]}function rf(t,n){return Array.isArray(t)?t.includes(n):t===n}function oT(t,n){const e=c_(n);return c_(t).forEach(r=>{rf(e,r)||e.push(r)}),e}function sT(t,n){return c_(n).filter(e=>!rf(t,e))}class aT{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=a_(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=l_(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Yi extends aT{get formDirective(){return null}get path(){return null}}class Vs extends aT{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class lT{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let qi=(()=>{class t extends lT{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(J(Vs,2))},t.\u0275dir=vt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Th("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[fn]}),t})(),$l=(()=>{class t extends lT{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(J(Yi,10))},t.\u0275dir=vt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Th("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[fn]}),t})();function cT(t,n){return t?`with name: '${n}'`:`at index: ${n}`}const h_=!1,Du="VALID",sf="INVALID",Wl="PENDING",Su="DISABLED";function f_(t){return(af(t)?t.validators:t)||null}function p_(t,n){return(af(n)?n.asyncValidators:t)||null}function af(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class hT{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===Du}get invalid(){return this.status===sf}get pending(){return this.status==Wl}get disabled(){return this.status===Su}get enabled(){return this.status!==Su}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(oT(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(oT(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(sT(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(sT(n,this._rawAsyncValidators))}hasValidator(n){return rf(this._rawValidators,n)}hasAsyncValidator(n){return rf(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Wl,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Su,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Du,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Du||this.status===Wl)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Su:Du}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Wl,this._hasOwnPendingAsyncValidator=!0;const e=KE(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Ht,this.statusChanges=new Ht}_calculateStatus(){return this._allControlsDisabled()?Su:this.errors?sf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Wl)?Wl:this._anyControlsHaveStatus(sf)?sf:Du}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){af(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function RL(t){return Array.isArray(t)?a_(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function LL(t){return Array.isArray(t)?l_(t):t||null}(this._rawAsyncValidators)}}class g_ extends hT{constructor(n,e,i){super(f_(e),p_(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function dT(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new De(1002,h_?function NL(t,n){return`Must supply a value for form control ${cT(t,n)}`}(n,r):"")})})(this,!0,n),Object.keys(n).forEach(i=>{(function uT(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new De(1e3,h_?function PL(t){return`\n    There are no form controls registered with this ${t?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!i[e])throw new De(1001,h_?function FL(t,n){return`Cannot find form control ${cT(t,n)}`}(n,e):"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const Zl=new St("CallSetDisabledState",{providedIn:"root",factory:()=>lf}),lf="always";function Mu(t,n,e=lf){m_(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function UL(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&fT(t,n)})}(t,n),function jL(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function VL(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&fT(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function zL(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function df(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function m_(t,n){const e=function iT(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(nT(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function rT(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(nT(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();df(n._rawValidators,r),df(n._rawAsyncValidators,r)}function fT(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const ZL={provide:Yi,useExisting:ln(()=>js)},ku=(()=>Promise.resolve())();let js=(()=>{class t extends Yi{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Ht,this.form=new g_({},a_(e),l_(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){ku.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Mu(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){ku.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){ku.then(()=>{const i=this._findContainer(e.path),r=new g_({});(function pT(t,n){m_(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){ku.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){ku.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function gT(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(J(Fi,10),J(Us,10),J(Zl,8))},t.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&de("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[En([ZL]),fn]}),t})();function mT(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function _T(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const vT=class extends hT{constructor(n=null,e,i){super(f_(e),p_(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),af(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=_T(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){mT(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){mT(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){_T(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},KL={provide:Vs,useExisting:ln(()=>Ni)},CT=(()=>Promise.resolve())();let Ni=(()=>{class t extends Vs{constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new vT,this._registered=!1,this.update=new Ht,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function y_(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===Pi?e=o:function $L(t){return Object.getPrototypeOf(t.constructor)===xa}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function v_(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Mu(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){CT.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&Rm(i);CT.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function cf(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(J(Yi,9),J(Fi,10),J(Us,10),J(Oo,10),J(Ai,8),J(Zl,8))},t.\u0275dir=vt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[En([KL]),fn,kn]}),t})(),Yl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const XL={provide:Oo,useExisting:ln(()=>ql),multi:!0};let ql=(()=>{class t extends xa{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&de("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([XL]),fn]}),t})();const QL={provide:Oo,useExisting:ln(()=>Iu),multi:!0};let wT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({}),t})(),JL=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:wT}),t})(),Iu=(()=>{class t extends xa{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=Ev(Zl,{optional:!0})??lf}ngOnInit(){this._control=this._injector.get(Vs),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Bn),J(JL),J(So))},t.\u0275dir=vt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&de("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[En([QL]),fn]}),t})();const e4={provide:Oo,useExisting:ln(()=>Da),multi:!0};let Da=(()=>{class t extends xa{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&de("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([e4]),fn]}),t})();const s4={provide:Oo,useExisting:ln(()=>_s),multi:!0};function ST(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let _s=(()=>{class t extends xa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=ST(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function a4(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&de("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([s4]),fn]}),t})(),Hs=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(ST(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(J(Bn),J(_a),J(_s,9))},t.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const l4={provide:Oo,useExisting:ln(()=>E_),multi:!0};function MT(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let E_=(()=>{class t extends xa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const c=this._getOptionValue(s[a].value);r.push(c)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function c4(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&de("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([l4]),fn]}),t})(),Gs=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(MT(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(MT(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(J(Bn),J(_a),J(E_,9))},t.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function kT(t){return"number"==typeof t?t:parseInt(t,10)}function IT(t){return"number"==typeof t?t:parseFloat(t)}let Sa=(()=>{class t{constructor(){this._validator=nf}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):nf,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,features:[kn]}),t})();const u4={provide:Fi,useExisting:ln(()=>T_),multi:!0};let T_=(()=>{class t extends Sa{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>IT(e),this.createValidator=e=>function jE(t){return n=>{if(zs(n.value)||zs(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&zr("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[En([u4]),fn]}),t})();const d4={provide:Fi,useExisting:ln(()=>x_),multi:!0};let x_=(()=>{class t extends Sa{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>IT(e),this.createValidator=e=>function VE(t){return n=>{if(zs(n.value)||zs(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&zr("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[En([d4]),fn]}),t})();const h4={provide:Fi,useExisting:ln(()=>ff),multi:!0};let ff=(()=>{class t extends Sa{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Rm,this.createValidator=e=>HE}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&zr("required",i._enabled?"":null)},inputs:{required:"required"},features:[En([h4]),fn]}),t})();const g4={provide:Fi,useExisting:ln(()=>D_),multi:!0};let D_=(()=>{class t extends Sa{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>kT(e),this.createValidator=e=>function WE(t){return n=>zs(n.value)||!UE(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&zr("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[En([g4]),fn]}),t})();const m4={provide:Fi,useExisting:ln(()=>S_),multi:!0};let S_=(()=>{class t extends Sa{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>kT(e),this.createValidator=e=>function ZE(t){return n=>UE(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=ki(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&zr("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[En([m4]),fn]}),t})(),v4=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({imports:[wT]}),t})(),b4=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Zl,useValue:e.callSetDisabledState??lf}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({imports:[v4]}),t})();class FT{}class C4{}const vs="*";function Ao(t,n){return{type:7,name:t,definitions:n,options:{}}}function yi(t,n=null){return{type:4,styles:n,timings:t}}function NT(t,n=null){return{type:2,steps:t,options:n}}function wt(t){return{type:6,styles:t,offset:null}}function RT(t,n,e){return{type:0,name:t,styles:n,options:e}}function go(t){return{type:5,steps:t}}function bi(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function LT(t){Promise.resolve().then(t)}class Ou{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){LT(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class BT{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?LT(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const M_="!";function zT(t){return new De(3e3,!1)}function n5(){return typeof window<"u"&&typeof window.document<"u"}function k_(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function $s(t){switch(t.length){case 0:return new Ou;case 1:return t[0];default:return new BT(t)}}function UT(t,n,e,i,r=new Map,o=new Map){const s=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const h=u.get("offset"),g=h==l,E=g&&c||new Map;u.forEach((L,Z)=>{let re=Z,oe=L;if("offset"!==Z)switch(re=n.normalizePropertyName(re,s),oe){case M_:oe=r.get(Z);break;case vs:oe=o.get(Z);break;default:oe=n.normalizeStyleValue(Z,re,oe,s)}E.set(re,oe)}),g||a.push(E),c=E,l=h}),s.length)throw function G4(t){return new De(3502,!1)}();return a}function I_(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&O_(e,"start",t)));break;case"done":t.onDone(()=>i(e&&O_(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&O_(e,"destroy",t)))}}function O_(t,n,e){const o=A_(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function A_(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function Er(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function VT(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let P_=(t,n)=>!1,jT=(t,n,e)=>[],HT=null;function F_(t){const n=t.parentNode||t.host;return n===HT?null:n}(k_()||typeof Element<"u")&&(n5()?(HT=(()=>document.documentElement)(),P_=(t,n)=>{for(;n;){if(n===t)return!0;n=F_(n)}return!1}):P_=(t,n)=>t.contains(n),jT=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let Ma=null,GT=!1;const $T=P_,WT=jT;let ZT=(()=>{class t{validateStyleProperty(e){return function r5(t){Ma||(Ma=function o5(){return typeof document<"u"?document.body:null}()||{},GT=!!Ma.style&&"WebkitAppearance"in Ma.style);let n=!0;return Ma.style&&!function i5(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Ma.style,!n&&GT&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Ma.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return $T(e,i)}getParentElement(e){return F_(e)}query(e,i,r){return WT(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],l){return new Ou(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})(),N_=(()=>{class t{}return t.NOOP=new ZT,t})();const s5=1e3,R_="ng-enter",pf="ng-leave",gf="ng-trigger",mf=".ng-trigger",qT="ng-animating",L_=".ng-animating";function ys(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:B_(parseFloat(n[1]),n[2])}function B_(t,n){return"s"===n?t*s5:t}function _f(t,n,e){return t.hasOwnProperty("duration")?t:function l5(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(zT()),{duration:0,delay:0,easing:""};r=B_(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=B_(parseFloat(l),a[4]));const c=a[5];c&&(s=c)}else r=t;if(!e){let a=!1,l=n.length;r<0&&(n.push(function w4(){return new De(3100,!1)}()),a=!0),o<0&&(n.push(function E4(){return new De(3101,!1)}()),a=!0),a&&n.splice(l,0,zT())}return{duration:r,delay:o,easing:s}}(t,n,e)}function Au(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function KT(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function Ws(t,n=new Map,e){if(e)for(let[i,r]of e)n.set(i,r);for(let[i,r]of t)n.set(i,r);return n}function QT(t,n,e){return e?n+":"+e+";":""}function JT(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=QT(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=QT(0,h5(e),t.style[e]));t.setAttribute("style",n)}function Po(t,n,e){t.style&&(n.forEach((i,r)=>{const o=U_(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i}),k_()&&JT(t))}function ka(t,n){t.style&&(n.forEach((e,i)=>{const r=U_(i);t.style[r]=""}),k_()&&JT(t))}function Pu(t){return Array.isArray(t)?1==t.length?t[0]:NT(t):t}const z_=new RegExp("{{\\s*(.+?)\\s*}}","g");function ex(t){let n=[];if("string"==typeof t){let e;for(;e=z_.exec(t);)n.push(e[1]);z_.lastIndex=0}return n}function Fu(t,n,e){const i=t.toString(),r=i.replace(z_,(o,s)=>{let a=n[s];return null==a&&(e.push(function x4(t){return new De(3003,!1)}()),a=""),a.toString()});return r==i?t:r}function vf(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const d5=/-+([a-z0-9])/g;function U_(t){return t.replace(d5,(...n)=>n[1].toUpperCase())}function h5(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Tr(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function D4(t){return new De(3004,!1)}()}}function tx(t,n){return window.getComputedStyle(t)[n]}const Cf="*";function v5(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function y5(t,n,e){if(":"==t[0]){const l=function b5(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function U4(t){return new De(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function z4(t){return new De(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(nx(r,s));"<"==o[0]&&!(r==Cf&&s==Cf)&&n.push(nx(s,r))}(i,e,n)):e.push(t),e}const wf=new Set(["true","1"]),Ef=new Set(["false","0"]);function nx(t,n){const e=wf.has(t)||Ef.has(t),i=wf.has(n)||Ef.has(n);return(r,o)=>{let s=t==Cf||t==r,a=n==Cf||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?wf.has(t):Ef.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?wf.has(n):Ef.has(n)),s&&a}}const C5=new RegExp("s*:selfs*,?","g");function V_(t,n,e,i){return new w5(t).build(n,e,i)}class w5{constructor(n){this._driver=n}build(n,e,i){const r=new x5(e);return this._resetContextStyleTimingState(r),Tr(this,Pu(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function M4(){return new De(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,e))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,e);i+=l.queryCount,r+=l.depCount,s.push(l)}else e.errors.push(function k4(){return new De(3007,!1)}())}),{type:7,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{ex(l).forEach(c=>{s.hasOwnProperty(c)||o.add(c)})})}),o.size&&(vf(o.values()),e.errors.push(function I4(t,n){return new De(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=Tr(this,Pu(n.animation),e);return{type:1,matchers:v5(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ia(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>Tr(this,i,e)),options:Ia(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=Tr(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:Ia(n.options)}}visitAnimate(n,e){const i=function S5(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return j_(_f(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=j_(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=_f(e,n);return j_(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:wt({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const c={};i.easing&&(c.easing=i.easing),s=wt(c)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,e);l.isEmptyStep=a,r=l}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===vs?i.push(a):e.errors.push(new De(3002,!1)):i.push(KT(a));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let l of a.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{const c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l);let h=!0;u&&(o!=r&&o>=u.startTime&&r<=u.endTime&&(e.errors.push(function A4(t,n,e,i,r){return new De(3010,!1)}()),h=!1),o=u.startTime),h&&c.set(l,{startTime:o,endTime:r}),e.options&&function u5(t,n,e){const i=n.params||{},r=ex(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function T4(t){return new De(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function P4(){return new De(3011,!1)}()),i;let o=0;const s=[];let a=!1,l=!1,c=0;const u=n.steps.map(oe=>{const ce=this._makeStyleAst(oe,e);let ue=null!=ce.offset?ce.offset:function D5(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(ce.styles),be=0;return null!=ue&&(o++,be=ce.offset=ue),l=l||be<0||be>1,a=a||be<c,c=be,s.push(be),ce});l&&e.errors.push(function F4(){return new De(3012,!1)}()),a&&e.errors.push(function N4(){return new De(3200,!1)}());const h=n.steps.length;let g=0;o>0&&o<h?e.errors.push(function R4(){return new De(3202,!1)}()):0==o&&(g=1/(h-1));const E=h-1,L=e.currentTime,Z=e.currentAnimateTimings,re=Z.duration;return u.forEach((oe,ce)=>{const ue=g>0?ce==E?1:g*ce:s[ce],be=ue*re;e.currentTime=L+Z.delay+be,Z.duration=be,this._validateStyleAst(oe,e),oe.offset=ue,i.styles.push(oe)}),i}visitReference(n,e){return{type:8,animation:Tr(this,Pu(n.animation),e),options:Ia(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:Ia(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:Ia(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function E5(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(C5,"")),t=t.replace(/@\*/g,mf).replace(/@\w+/g,e=>mf+"-"+e.slice(1)).replace(/:animating/g,L_),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,Er(e.collectedStyles,e.currentQuerySelector,new Map);const a=Tr(this,Pu(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:Ia(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function L4(){return new De(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:_f(n.timings,e.errors,!0);return{type:12,animation:Tr(this,Pu(n.animation),e),timings:i,options:null}}}class x5{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ia(t){return t?(t=Au(t)).params&&(t.params=function T5(t){return t?Au(t):null}(t.params)):t={},t}function j_(t,n,e){return{duration:t,delay:n,easing:e}}function H_(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Tf{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const I5=new RegExp(":enter","g"),A5=new RegExp(":leave","g");function G_(t,n,e,i,r,o=new Map,s=new Map,a,l,c=[]){return(new P5).buildKeyframes(t,n,e,i,r,o,s,a,l,c)}class P5{buildKeyframes(n,e,i,r,o,s,a,l,c,u=[]){c=c||new Tf;const h=new $_(n,e,c,r,o,u,[]);h.options=l;const g=l.delay?ys(l.delay):0;h.currentTimeline.delayNextStep(g),h.currentTimeline.setStyles([s],null,h.errors,l),Tr(this,i,h);const E=h.timelines.filter(L=>L.containsAnimation());if(E.length&&a.size){let L;for(let Z=E.length-1;Z>=0;Z--){const re=E[Z];if(re.element===e){L=re;break}}L&&!L.allowOnlyTimelineStyles()&&L.setStyles([a],null,h.errors,l)}return E.length?E.map(L=>L.buildKeyframes()):[H_(e,[],[],[],0,g,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:ys(Fu(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?ys(i.duration):null,a=null!=i.delay?ys(i.delay):null;return 0!==s&&n.forEach(l=>{const c=e.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Tr(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=xf);const s=ys(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>Tr(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?ys(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),Tr(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return _f(e.params?Fu(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?ys(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=xf);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;const h=e.createSubContext(n.options,c);o&&h.delayNextStep(o),c===e.element&&(l=h.currentTimeline),Tr(this,n.animation,h),h.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,h.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let l=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=e.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;Tr(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const xf={};class $_{constructor(n,e,i,r,o,s,a,l){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=xf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Df(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=ys(i.duration)),null!=i.delay&&(r.delay=ys(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Fu(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new $_(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=xf,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new F5(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(I5,"."+this._enterClassName)).replace(A5,"."+this._leaveClassName);let c=this._driver.query(this.element,n,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!o&&0==a.length&&s.push(function B4(t){return new De(3014,!1)}()),a}}class Df{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Df(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||vs),this._currentKeyframe.set(e,vs);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function N5(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i=i||n.keys();for(let o of i)e.set(o,vs)}else Ws(r,e)}),e}(n,this._globalTimelineStyles);for(let[a,l]of s){const c=Fu(l,o,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??vs),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Ws(a,new Map,this._backFill);c.forEach((u,h)=>{u===M_?n.add(h):u===vs&&e.add(h)}),i||c.set("offset",l/this.duration),r.push(c)});const o=n.size?vf(n.values()):[],s=e.size?vf(e.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return H_(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class F5 extends Df{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,l=Ws(n[0]);l.set("offset",0),o.push(l);const c=Ws(n[0]);c.set("offset",ox(a)),o.push(c);const u=n.length-1;for(let h=1;h<=u;h++){let g=Ws(n[h]);const E=g.get("offset");g.set("offset",ox((e+E*i)/s)),o.push(g)}i=s,e=0,r="",n=o}return H_(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function ox(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class W_{}const R5=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class L5 extends W_{normalizePropertyName(n,e){return U_(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(R5.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function S4(t,n){return new De(3005,!1)}())}return s+o}}function sx(t,n,e,i,r,o,s,a,l,c,u,h,g){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:g}}const Z_={};class ax{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function B5(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,l,c,u){const h=[],g=this.ast.options&&this.ast.options.params||Z_,L=this.buildStyles(i,a&&a.params||Z_,h),Z=l&&l.params||Z_,re=this.buildStyles(r,Z,h),oe=new Set,ce=new Map,ue=new Map,be="void"===r,Ke={params:z5(Z,g),delay:this.ast.options?.delay},ft=u?[]:G_(n,e,this.ast.animation,o,s,L,re,Ke,c,h);let Xe=0;if(ft.forEach(Tt=>{Xe=Math.max(Tt.duration+Tt.delay,Xe)}),h.length)return sx(e,this._triggerName,i,r,be,L,re,[],[],ce,ue,Xe,h);ft.forEach(Tt=>{const lt=Tt.element,zt=Er(ce,lt,new Set);Tt.preStyleProps.forEach(Kr=>zt.add(Kr));const Qi=Er(ue,lt,new Set);Tt.postStyleProps.forEach(Kr=>Qi.add(Kr)),lt!==e&&oe.add(lt)});const Bt=vf(oe.values());return sx(e,this._triggerName,i,r,be,L,re,ft,Bt,ce,ue,Xe)}}function z5(t,n){const e=Au(n);for(const i in t)t.hasOwnProperty(i)&&null!=t[i]&&(e[i]=t[i]);return e}class U5{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=Au(this.defaultParams);return Object.keys(n).forEach(o=>{const s=n[o];null!==s&&(r[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Fu(s,r,e));const l=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,l,s,e),i.set(a,s)})}),i}}class j5{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new U5(r.style,r.options&&r.options.params||{},i))}),lx(this.states,"true","1"),lx(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new ax(n,r,this.states))}),this.fallbackTransition=function H5(t,n,e){return new ax(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function lx(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const G5=new Tf;class $5{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],r=[],o=V_(this._driver,e,i,r);if(i.length)throw function $4(t){return new De(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=UT(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=G_(this._driver,e,o,R_,pf,new Map,new Map,i,G5,r),s.forEach(u=>{const h=Er(a,u.element,new Map);u.postStyleProps.forEach(g=>h.set(g,null))})):(r.push(function W4(){return new De(3300,!1)}()),s=[]),r.length)throw function Z4(t){return new De(3504,!1)}();a.forEach((u,h)=>{u.forEach((g,E)=>{u.set(E,this._driver.computeStyle(h,E,vs))})});const c=$s(s.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Y4(t){return new De(3301,!1)}();return e}listen(n,e,i,r){const o=A_(e,"","","");return I_(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const cx="ng-animate-queued",Y_="ng-animate-disabled",K5=[],ux={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},X5={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},jr="__ng_removed";class q_{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function tB(t){return t??null}(i?n.value:n),i){const o=Au(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Nu="void",K_=new q_(Nu);class Q5{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Hr(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function q4(t,n){return new De(3302,!1)}();if(null==i||0==i.length)throw function K4(t){return new De(3303,!1)}();if(!function nB(t){return"start"==t||"done"==t}(i))throw function X4(t,n){return new De(3400,!1)}();const o=Er(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=Er(this._engine.statesByElement,n,new Map);return a.has(e)||(Hr(n,gf),Hr(n,gf+"-"+e),a.set(e,K_)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function Q4(t){return new De(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new X_(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(Hr(n,gf),Hr(n,gf+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e);const c=new q_(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=K_),c.value!==Nu&&l.value===c.value){if(!function oB(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,c.params)){const Z=[],re=o.matchStyles(l.value,l.params,Z),oe=o.matchStyles(c.value,c.params,Z);Z.length?this._engine.reportError(Z):this._engine.afterFlush(()=>{ka(n,re),Po(n,oe)})}return}const g=Er(this._engine.playersByElement,n,[]);g.forEach(Z=>{Z.namespaceId==this.id&&Z.triggerName==e&&Z.queued&&Z.destroy()});let E=o.matchTransition(l.value,c.value,n,c.params),L=!1;if(!E){if(!r)return;E=o.fallbackTransition,L=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:E,fromState:l,toState:c,player:s,isFallbackTransition:L}),L||(Hr(n,cx),s.onStart(()=>{Kl(n,cx)})),s.onDone(()=>{let Z=this.players.indexOf(s);Z>=0&&this.players.splice(Z,1);const re=this._engine.playersByElement.get(n);if(re){let oe=re.indexOf(s);oe>=0&&re.splice(oe,1)}}),this.players.push(s),g.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,mf,!0);i.forEach(r=>{if(r[jr])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((l,c)=>{if(s.set(c,l.value),this._triggers.has(c)){const u=this.trigger(n,c,Nu,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&$s(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers.get(s).fallbackTransition,c=i.get(s)||K_,u=new q_(Nu),h=new X_(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[jr];(!o||o===ux)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){Hr(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=A_(o,i.triggerName,i.fromState.value,i.toState.value);l._data=n,I_(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class J5{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new Q5(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(Sf(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!Sf(e))return;const o=e[jr];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Hr(n,Y_)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Kl(n,Y_))}removeNode(n,e,i,r){if(Sf(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[jr]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return Sf(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,mf,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,L_,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return $s(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[jr];if(e&&e.setForRemoval){if(n[jr]=ux,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(Y_)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Hr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?$s(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function J4(t){return new De(3402,!1)}()}_flushAnimations(n,e){const i=new Tf,r=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(tt=>{u.add(tt);const ht=this.driver.query(tt,".ng-animate-queued",!0);for(let _t=0;_t<ht.length;_t++)u.add(ht[_t])});const h=this.bodyNode,g=Array.from(this.statesByElement.keys()),E=fx(g,this.collectedEnterElements),L=new Map;let Z=0;E.forEach((tt,ht)=>{const _t=R_+Z++;L.set(ht,_t),tt.forEach(Qt=>Hr(Qt,_t))});const re=[],oe=new Set,ce=new Set;for(let tt=0;tt<this.collectedLeaveElements.length;tt++){const ht=this.collectedLeaveElements[tt],_t=ht[jr];_t&&_t.setForRemoval&&(re.push(ht),oe.add(ht),_t.hasAnimation?this.driver.query(ht,".ng-star-inserted",!0).forEach(Qt=>oe.add(Qt)):ce.add(ht))}const ue=new Map,be=fx(g,Array.from(oe));be.forEach((tt,ht)=>{const _t=pf+Z++;ue.set(ht,_t),tt.forEach(Qt=>Hr(Qt,_t))}),n.push(()=>{E.forEach((tt,ht)=>{const _t=L.get(ht);tt.forEach(Qt=>Kl(Qt,_t))}),be.forEach((tt,ht)=>{const _t=ue.get(ht);tt.forEach(Qt=>Kl(Qt,_t))}),re.forEach(tt=>{this.processLeaveNode(tt)})});const Ke=[],ft=[];for(let tt=this._namespaceList.length-1;tt>=0;tt--)this._namespaceList[tt].drainQueuedTransitions(e).forEach(_t=>{const Qt=_t.player,Nn=_t.element;if(Ke.push(Qt),this.collectedEnterElements.length){const Ui=Nn[jr];if(Ui&&Ui.setForMove){if(Ui.previousTriggersValues&&Ui.previousTriggersValues.has(_t.triggerName)){const Xa=Ui.previousTriggersValues.get(_t.triggerName),Qr=this.statesByElement.get(_t.element);if(Qr&&Qr.has(_t.triggerName)){const up=Qr.get(_t.triggerName);up.value=Xa,Qr.set(_t.triggerName,up)}}return void Qt.destroy()}}const Ir=!h||!this.driver.containsElement(h,Nn),ri=ue.get(Nn),Ji=L.get(Nn),Rn=this._buildInstruction(_t,i,Ji,ri,Ir);if(Rn.errors&&Rn.errors.length)return void ft.push(Rn);if(Ir)return Qt.onStart(()=>ka(Nn,Rn.fromStyles)),Qt.onDestroy(()=>Po(Nn,Rn.toStyles)),void r.push(Qt);if(_t.isFallbackTransition)return Qt.onStart(()=>ka(Nn,Rn.fromStyles)),Qt.onDestroy(()=>Po(Nn,Rn.toStyles)),void r.push(Qt);const RM=[];Rn.timelines.forEach(Ui=>{Ui.stretchStartingKeyframe=!0,this.disabledNodes.has(Ui.element)||RM.push(Ui)}),Rn.timelines=RM,i.append(Nn,Rn.timelines),s.push({instruction:Rn,player:Qt,element:Nn}),Rn.queriedElements.forEach(Ui=>Er(a,Ui,[]).push(Qt)),Rn.preStyleProps.forEach((Ui,Xa)=>{if(Ui.size){let Qr=l.get(Xa);Qr||l.set(Xa,Qr=new Set),Ui.forEach((up,mv)=>Qr.add(mv))}}),Rn.postStyleProps.forEach((Ui,Xa)=>{let Qr=c.get(Xa);Qr||c.set(Xa,Qr=new Set),Ui.forEach((up,mv)=>Qr.add(mv))})});if(ft.length){const tt=[];ft.forEach(ht=>{tt.push(function e5(t,n){return new De(3505,!1)}())}),Ke.forEach(ht=>ht.destroy()),this.reportError(tt)}const Xe=new Map,Bt=new Map;s.forEach(tt=>{const ht=tt.element;i.has(ht)&&(Bt.set(ht,ht),this._beforeAnimationBuild(tt.player.namespaceId,tt.instruction,Xe))}),r.forEach(tt=>{const ht=tt.element;this._getPreviousPlayers(ht,!1,tt.namespaceId,tt.triggerName,null).forEach(Qt=>{Er(Xe,ht,[]).push(Qt),Qt.destroy()})});const Tt=re.filter(tt=>gx(tt,l,c)),lt=new Map;hx(lt,this.driver,ce,c,vs).forEach(tt=>{gx(tt,l,c)&&Tt.push(tt)});const Qi=new Map;E.forEach((tt,ht)=>{hx(Qi,this.driver,new Set(tt),l,M_)}),Tt.forEach(tt=>{const ht=lt.get(tt),_t=Qi.get(tt);lt.set(tt,new Map([...Array.from(ht?.entries()??[]),...Array.from(_t?.entries()??[])]))});const Kr=[],Xr=[],Jo={};s.forEach(tt=>{const{element:ht,player:_t,instruction:Qt}=tt;if(i.has(ht)){if(u.has(ht))return _t.onDestroy(()=>Po(ht,Qt.toStyles)),_t.disabled=!0,_t.overrideTotalTime(Qt.totalTime),void r.push(_t);let Nn=Jo;if(Bt.size>1){let ri=ht;const Ji=[];for(;ri=ri.parentNode;){const Rn=Bt.get(ri);if(Rn){Nn=Rn;break}Ji.push(ri)}Ji.forEach(Rn=>Bt.set(Rn,Nn))}const Ir=this._buildAnimation(_t.namespaceId,Qt,Xe,o,Qi,lt);if(_t.setRealPlayer(Ir),Nn===Jo)Kr.push(_t);else{const ri=this.playersByElement.get(Nn);ri&&ri.length&&(_t.parentPlayer=$s(ri)),r.push(_t)}}else ka(ht,Qt.fromStyles),_t.onDestroy(()=>Po(ht,Qt.toStyles)),Xr.push(_t),u.has(ht)&&r.push(_t)}),Xr.forEach(tt=>{const ht=o.get(tt.element);if(ht&&ht.length){const _t=$s(ht);tt.setRealPlayer(_t)}}),r.forEach(tt=>{tt.parentPlayer?tt.syncPlayerEvents(tt.parentPlayer):tt.destroy()});for(let tt=0;tt<re.length;tt++){const ht=re[tt],_t=ht[jr];if(Kl(ht,pf),_t&&_t.hasAnimation)continue;let Qt=[];if(a.size){let Ir=a.get(ht);Ir&&Ir.length&&Qt.push(...Ir);let ri=this.driver.query(ht,L_,!0);for(let Ji=0;Ji<ri.length;Ji++){let Rn=a.get(ri[Ji]);Rn&&Rn.length&&Qt.push(...Rn)}}const Nn=Qt.filter(Ir=>!Ir.destroyed);Nn.length?iB(this,ht,Nn):this.processLeaveNode(ht)}return re.length=0,Kr.forEach(tt=>{this.players.push(tt),tt.onDone(()=>{tt.destroy();const ht=this.players.indexOf(tt);this.players.splice(ht,1)}),tt.play()}),Kr}elementContainsData(n,e){let i=!1;const r=e[jr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const l=!o||o==Nu;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||s.push(c)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,u=c!==o,h=Er(i,c,[]);this._getPreviousPlayers(c,u,s,a,e.toState).forEach(E=>{const L=E.getRealPlayer();L.beforeDestroy&&L.beforeDestroy(),E.destroy(),h.push(E)})}ka(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,l=e.element,c=[],u=new Set,h=new Set,g=e.timelines.map(L=>{const Z=L.element;u.add(Z);const re=Z[jr];if(re&&re.removedBeforeQueried)return new Ou(L.duration,L.delay);const oe=Z!==l,ce=function rB(t){const n=[];return px(t,n),n}((i.get(Z)||K5).map(Xe=>Xe.getRealPlayer())).filter(Xe=>!!Xe.element&&Xe.element===Z),ue=o.get(Z),be=s.get(Z),Ke=UT(0,this._normalizer,0,L.keyframes,ue,be),ft=this._buildPlayer(L,Ke,ce);if(L.subTimeline&&r&&h.add(Z),oe){const Xe=new X_(n,a,Z);Xe.setRealPlayer(ft),c.push(Xe)}return ft});c.forEach(L=>{Er(this.playersByQueriedElement,L.element,[]).push(L),L.onDone(()=>function eB(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,L.element,L))}),u.forEach(L=>Hr(L,qT));const E=$s(g);return E.onDestroy(()=>{u.forEach(L=>Kl(L,qT)),Po(l,e.toStyles)}),h.forEach(L=>{Er(r,L,[]).push(E)}),E}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Ou(n.duration,n.delay)}}class X_{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Ou,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>I_(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Er(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Sf(t){return t&&1===t.nodeType}function dx(t,n){const e=t.style.display;return t.style.display=n??"none",e}function hx(t,n,e,i,r){const o=[];e.forEach(l=>o.push(dx(l)));const s=[];i.forEach((l,c)=>{const u=new Map;l.forEach(h=>{const g=n.computeStyle(c,h,r);u.set(h,g),(!g||0==g.length)&&(c[jr]=X5,s.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>dx(l,o[a++])),s}function fx(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const i=1,r=new Set(n),o=new Map;function s(a){if(!a)return i;let l=o.get(a);if(l)return l;const c=a.parentNode;return l=e.has(c)?c:r.has(c)?i:s(c),o.set(a,l),l}return n.forEach(a=>{const l=s(a);l!==i&&e.get(l).push(a)}),e}function Hr(t,n){t.classList?.add(n)}function Kl(t,n){t.classList?.remove(n)}function iB(t,n,e){$s(e).onDone(()=>t.processLeaveNode(n))}function px(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof BT?px(i.players,n):n.push(i)}}function gx(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class Mf{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new J5(n,e,i),this._timelineEngine=new $5(n,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],c=[],u=V_(this._driver,o,l,c);if(l.length)throw function H4(t,n){return new De(3404,!1)}();a=function V5(t,n,e){return new j5(t,n,e)}(r,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=VT(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=VT(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let aB=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Po(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Po(this._element,this._initialStyles),this._endStyles&&(Po(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(ka(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ka(this._element,this._endStyles),this._endStyles=null),Po(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function Q_(t){let n=null;return t.forEach((e,i)=>{(function lB(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class mx{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:tx(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class cB{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return $T(n,e)}getParentElement(n){return F_(n)}query(n,e,i){return WT(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const c=new Map,u=s.filter(E=>E instanceof mx);(function f5(t,n){return 0===t||0===n})(i,r)&&u.forEach(E=>{E.currentSnapshot.forEach((L,Z)=>c.set(Z,L))});let h=function c5(t){return t.length?t[0]instanceof Map?t:t.map(n=>KT(n)):[]}(e).map(E=>Ws(E));h=function p5(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,tx(t,a)))}}return n}(n,h,c);const g=function sB(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=Q_(n[0]),n.length>1&&(i=Q_(n[n.length-1]))):n instanceof Map&&(e=Q_(n)),e||i?new aB(t,e,i):null}(n,h);return new mx(n,h,l,g)}}let uB=(()=>{class t extends FT{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:ro.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?NT(e):e;return _x(this._renderer,null,i,"register",[r]),new dB(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(bt(tu),bt(wr))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();class dB extends C4{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new hB(this._id,n,e||{},this._renderer)}}class hB{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return _x(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function _x(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const vx="@.disabled";let fB=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=s?.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(o);return u||(u=new yx("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,u)),u}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,a,e,u.name,u)};return i.data.animation.forEach(l),new pB(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(bt(tu),bt(Mf),bt(Gt))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();class yx{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==vx?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class pB extends yx{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==vx?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function gB(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function mB(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let _B=(()=>{class t extends Mf{constructor(e,i,r,o){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(bt(wr),bt(N_),bt(W_),bt(Rh))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();const bx=[{provide:FT,useClass:uB},{provide:W_,useFactory:function vB(){return new L5}},{provide:Mf,useClass:_B},{provide:tu,useFactory:function yB(t,n,e){return new fB(t,n,e)},deps:[tf,Mf,Gt]}],J_=[{provide:N_,useFactory:()=>new cB},{provide:ww,useValue:"BrowserAnimations"},...bx],Cx=[{provide:N_,useClass:ZT},{provide:ww,useValue:"NoopAnimations"},...bx];let bB=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?Cx:J_}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t}),t.\u0275inj=Co({providers:J_,imports:[FE]}),t})();var Mt=Y(5861);let Xl=0;const Ru=new Map,If=new MessageChannel;function Ri(t){if(4294967296===Xl&&(Xl=0),++Xl in Ru)throw new Error("setZeroTimeout queue overflow.");return Ru.set(Xl,t),If.port2.postMessage(Xl),Xl}If.port1.onmessage=function(t){const n=Ru.get(t.data);Ru.delete(t.data),n&&n()},If.port1.start(),If.port2.start();class wx{}var e0=Y(1817),Ex=Y(8497),wB=Y(1082),Zs=(()=>{return(t=Zs||(Zs={}))[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH",Zs;var t})();const EB=wB("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),TB=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class Tn{get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:Zs.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}parse(n){try{this.peerId=n;let e=TB.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=Ex.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return Tx(this.digestUserId,this.roomId,this.roomName,n)===this.digestPassword&&this.verifyRoomId(n)}verifyRoomId(n){return xx(this.roomId,this.roomName,n)===this.roomId}verifyPeer(n){let e=Tn.parse(n);return this.roomId==e.roomId&&this.roomName==e.roomName&&this.hasPassword==e.hasPassword&&(!this.hasPassword||(this.password.length<1?(console.error("do not know password."),!1):e.verifyPassword(this.password)))}static parse(n){return new Tn(n)}static create(...n){return n.length<=1?Tn._create.apply(this,n):Tn._createRoom.apply(this,n)}static _create(n=""){let e=function xB(t){return null==t?"":Of(t)}(n),i=new Tn(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=Of(n,6),s=xx(e,i,r),a=Tx(o,s,i,r),l=`${o}${s}${Ex.n(i)}-${a}`,c=new Tn(l);return c.userId=n,c.password=r,c}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function Tx(t,n,e,i){return null==n||null==i?"":0<i.length?Of(t+n+e+i,7):""}function xx(t,n,e){if(e.length<1)return t;let i=t.slice(0,2);return i+Of(i+n+e,1)}function Of(t,n=-1){if(null==t)return"";let e=e0(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=EB.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function Ql(t){let n=t.length;for(;--n>=0;)t[n]=0}const s0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Af=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),PB=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Px=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bs=new Array(576);Ql(bs);const zu=new Array(60);Ql(zu);const Uu=new Array(512);Ql(Uu);const Vu=new Array(256);Ql(Vu);const a0=new Array(29);Ql(a0);const Pf=new Array(30);function l0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let Fx,Nx,Rx;function c0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}Ql(Pf);const Lx=t=>t<256?Uu[t]:Uu[256+(t>>>7)],ju=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},cr=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,ju(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},Fo=(t,n,e)=>{cr(t,e[2*n],e[2*n+1])},Bx=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},zx=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)r=r+e[o-1]<<1,i[o]=r;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=Bx(i[a]++,a))}},Ux=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Vx=t=>{t.bi_valid>8?ju(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},jx=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},u0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&jx(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!jx(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},Hx=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?Fo(t,r,n):(s=Vu[r],Fo(t,s+256+1,n),a=s0[s],0!==a&&(r-=a0[s],cr(t,r,a)),i--,s=Lx(i),Fo(t,s,e),a=Af[s],0!==a&&(i-=Pf[s],cr(t,i,a)))}while(o<t.sym_next);Fo(t,256,n)},d0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,c,l=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=l=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,e[2*c]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=i[2*c+1]);for(n.max_code=l,s=t.heap_len>>1;s>=1;s--)u0(t,e,s);c=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],u0(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*c]=e[2*s]+e[2*a],t.depth[c]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=c,t.heap[1]=c++,u0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,l=n.stat_desc.max_length;let c,u,h,g,E,L,Z=0;for(g=0;g<=15;g++)t.bl_count[g]=0;for(e[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)u=t.heap[c],g=e[2*e[2*u+1]+1]+1,g>l&&(g=l,Z++),e[2*u+1]=g,!(u>i)&&(t.bl_count[g]++,E=0,u>=a&&(E=s[u-a]),L=e[2*u],t.opt_len+=L*(g+E),o&&(t.static_len+=L*(r[2*u+1]+E)));if(0!==Z){do{for(g=l-1;0===t.bl_count[g];)g--;t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[l]--,Z-=2}while(Z>0);for(g=l;0!==g;g--)for(u=t.bl_count[g];0!==u;)h=t.heap[--c],!(h>i)&&(e[2*h+1]!==g&&(t.opt_len+=(g-e[2*h+1])*e[2*h],e[2*h+1]=g),u--)}})(t,n),zx(e,l,t.bl_count)},Gx=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)&&(a<c?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4))},$x=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)){if(a<c)do{Fo(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(Fo(t,o,t.bl_tree),a--),Fo(t,16,t.bl_tree),cr(t,a-3,2)):a<=10?(Fo(t,17,t.bl_tree),cr(t,a-3,3)):(Fo(t,18,t.bl_tree),cr(t,a-11,7));a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4)}};let Wx=!1;const Zx=(t,n,e,i)=>{cr(t,0+(i?1:0),3),Vx(t),ju(t,e),ju(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var KB={_tr_init:t=>{Wx||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(a0[i]=e,t=0;t<1<<s0[i];t++)Vu[e++]=i;for(Vu[e-1]=i,r=0,i=0;i<16;i++)for(Pf[i]=r,t=0;t<1<<Af[i];t++)Uu[r++]=i;for(r>>=7;i<30;i++)for(Pf[i]=r<<7,t=0;t<1<<Af[i]-7;t++)Uu[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)bs[2*t+1]=8,t++,o[8]++;for(;t<=255;)bs[2*t+1]=9,t++,o[9]++;for(;t<=279;)bs[2*t+1]=7,t++,o[7]++;for(;t<=287;)bs[2*t+1]=8,t++,o[8]++;for(zx(bs,287,o),t=0;t<30;t++)zu[2*t+1]=5,zu[2*t]=Bx(t,5);Fx=new l0(bs,s0,257,286,15),Nx=new l0(zu,Af,0,30,15),Rx=new l0(new Array(0),PB,0,19,7)})(),Wx=!0),t.l_desc=new c0(t.dyn_ltree,Fx),t.d_desc=new c0(t.dyn_dtree,Nx),t.bl_desc=new c0(t.bl_tree,Rx),t.bi_buf=0,t.bi_valid=0,Ux(t)},_tr_stored_block:Zx,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),d0(t,t.l_desc),d0(t,t.d_desc),s=(t=>{let n;for(Gx(t,t.dyn_ltree,t.l_desc.max_code),Gx(t,t.dyn_dtree,t.d_desc.max_code),d0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*Px[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?Zx(t,n,e,i):4===t.strategy||o===r?(cr(t,2+(i?1:0),3),Hx(t,bs,zu)):(cr(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(cr(t,n-257,5),cr(t,e-1,5),cr(t,i-4,4),r=0;r<i;r++)cr(t,t.bl_tree[2*Px[r]+1],3);$x(t,t.dyn_ltree,n-1),$x(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),Hx(t,t.dyn_ltree,t.dyn_dtree)),Ux(t),i&&Vx(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(Vu[e]+256+1)]++,t.dyn_dtree[2*Lx(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{cr(t,2,3),Fo(t,256,bs),(t=>{16===t.bi_valid?(ju(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Hu=(t,n,e,i)=>{let r=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const QB=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var fi=(t,n,e,i)=>{const r=QB,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return-1^t},Aa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Pa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:JB,_tr_stored_block:h0,_tr_flush_block:e6,_tr_tally:Ys,_tr_align:t6}=KB,{Z_NO_FLUSH:qs,Z_PARTIAL_FLUSH:n6,Z_FULL_FLUSH:i6,Z_FINISH:Gr,Z_BLOCK:Yx,Z_OK:Ci,Z_STREAM_END:qx,Z_STREAM_ERROR:No,Z_DATA_ERROR:r6,Z_BUF_ERROR:f0,Z_DEFAULT_COMPRESSION:o6,Z_FILTERED:s6,Z_HUFFMAN_ONLY:Ff,Z_RLE:a6,Z_FIXED:l6,Z_DEFAULT_STRATEGY:c6,Z_UNKNOWN:u6,Z_DEFLATED:Nf}=Pa,p0=286,g6=30,m6=19,_6=2*p0+1,v6=15,Ro=262,Ra=(t,n)=>(t.msg=Aa[n],n),Kx=t=>2*t-(t>4?9:0),Xs=t=>{let n=t.length;for(;--n>=0;)t[n]=0},C6=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let Qs=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const xr=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},Dr=(t,n)=>{e6(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,xr(t.strm)},rn=(t,n)=>{t.pending_buf[t.pending++]=n},$u=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},b0=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=Hu(t.adler,n,r,e):2===t.state.wrap&&(t.adler=fi(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},Xx=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-Ro?t.strstart-(t.w_size-Ro):0,c=t.window,u=t.w_mask,h=t.prev,g=t.strstart+258;let E=c[i+s-1],L=c[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,c[r+s]===L&&c[r+s-1]===E&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<g);if(o=258-(g-i),i=g-258,o>s){if(t.match_start=n,s=o,o>=a)break;E=c[i+s-1],L=c[i+s]}}}while((n=h[n&u])>l&&0!=--e);return s<=t.lookahead?s:t.lookahead},ic=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-Ro)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),C6(t),i+=n),0===t.strm.avail_in)break;if(e=b0(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Qs(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Qs(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Ro&&0!==t.strm.avail_in)},Qx=(t,n)=>{let i,r,o,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>o&&(i=o),i<e&&(0===i&&n!==Gr||n===qs||i!==r+t.strm.avail_in)))break;s=n===Gr&&i===r+t.strm.avail_in?1:0,h0(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,xr(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(b0(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===s);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:n!==qs&&n!==Gr&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(b0(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,r=t.strstart-t.block_start,(r>=e||(r||n===Gr)&&n!==qs&&0===t.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=n===Gr&&0===t.strm.avail_in&&i===r?1:0,h0(t,t.block_start,i,s),t.block_start+=i,xr(t.strm)),s?3:1)},C0=(t,n)=>{let e,i;for(;;){if(t.lookahead<Ro){if(ic(t),t.lookahead<Ro&&n===qs)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-Ro&&(t.match_length=Xx(t,e)),t.match_length>=3)if(i=Ys(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Qs(t,t.ins_h,t.window[t.strstart+1]);else i=Ys(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Dr(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===Gr?(Dr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Dr(t,!1),0===t.strm.avail_out)?1:2},rc=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<Ro){if(ic(t),t.lookahead<Ro&&n===qs)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-Ro&&(t.match_length=Xx(t,e),t.match_length<=5&&(t.strategy===s6||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Ys(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Qs(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(Dr(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Ys(t,0,t.window[t.strstart-1]),i&&Dr(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Ys(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===Gr?(Dr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Dr(t,!1),0===t.strm.avail_out)?1:2};function Lo(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const Wu=[new Lo(0,0,0,0,Qx),new Lo(4,4,8,4,C0),new Lo(4,5,16,8,C0),new Lo(4,6,32,32,C0),new Lo(4,4,16,16,rc),new Lo(8,16,32,32,rc),new Lo(8,16,128,128,rc),new Lo(8,32,128,256,rc),new Lo(32,128,258,1024,rc),new Lo(32,258,258,4096,rc)];function x6(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Nf,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*_6),this.dyn_dtree=new Uint16Array(2*(2*g6+1)),this.bl_tree=new Uint16Array(2*(2*m6+1)),Xs(this.dyn_ltree),Xs(this.dyn_dtree),Xs(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(v6+1),this.heap=new Uint16Array(2*p0+1),Xs(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*p0+1),Xs(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Zu=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},Jx=t=>{if(Zu(t))return Ra(t,No);t.total_in=t.total_out=0,t.data_type=u6;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,JB(n),Ci},eD=t=>{const n=Jx(t);return n===Ci&&(t=>{t.window_size=2*t.w_size,Xs(t.head),t.max_lazy_match=Wu[t.level].max_lazy,t.good_match=Wu[t.level].good_length,t.nice_match=Wu[t.level].nice_length,t.max_chain_length=Wu[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},tD=(t,n,e,i,r,o)=>{if(!t)return No;let s=1;if(n===o6&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==Nf||i<8||i>15||n<0||n>9||o<0||o>l6||8===i&&1!==s)return Ra(t,No);8===i&&(i=9);const a=new x6;return t.state=a,a.strm=t,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=o,a.method=e,eD(t)};var Yu={deflateInit:(t,n)=>tD(t,n,Nf,15,8,c6),deflateInit2:tD,deflateReset:eD,deflateResetKeep:Jx,deflateSetHeader:(t,n)=>Zu(t)||2!==t.state.wrap?No:(t.state.gzhead=n,Ci),deflate:(t,n)=>{if(Zu(t)||n>Yx||n<0)return t?Ra(t,No):No;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==Gr)return Ra(t,0===t.avail_out?f0:No);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if(xr(t),0===t.avail_out)return e.last_flush=-1,Ci}else if(0===t.avail_in&&Kx(n)<=Kx(i)&&n!==Gr)return Ra(t,f0);if(666===e.status&&0!==t.avail_in)return Ra(t,f0);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=Nf+(e.w_bits-8<<4)<<8,o=-1;if(o=e.strategy>=Ff||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=o<<6,0!==e.strstart&&(r|=32),r+=31-r%31,$u(e,r),0!==e.strstart&&($u(e,t.adler>>>16),$u(e,65535&t.adler)),t.adler=1,e.status=113,xr(t),0!==e.pending)return e.last_flush=-1,Ci}if(57===e.status)if(t.adler=0,rn(e,31),rn(e,139),rn(e,8),e.gzhead)rn(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),rn(e,255&e.gzhead.time),rn(e,e.gzhead.time>>8&255),rn(e,e.gzhead.time>>16&255),rn(e,e.gzhead.time>>24&255),rn(e,9===e.level?2:e.strategy>=Ff||e.level<2?4:0),rn(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(rn(e,255&e.gzhead.extra.length),rn(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=fi(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(rn(e,0),rn(e,0),rn(e,0),rn(e,0),rn(e,0),rn(e,9===e.level?2:e.strategy>=Ff||e.level<2?4:0),rn(e,3),e.status=113,xr(t),0!==e.pending)return e.last_flush=-1,Ci;if(69===e.status){if(e.gzhead.extra){let r=e.pending,o=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,xr(t),0!==e.pending)return e.last_flush=-1,Ci;r=0,o-=a}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),xr(t),0!==e.pending)return e.last_flush=-1,Ci;r=0}o=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,rn(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),xr(t),0!==e.pending)return e.last_flush=-1,Ci;r=0}o=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,rn(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(xr(t),0!==e.pending))return e.last_flush=-1,Ci;rn(e,255&t.adler),rn(e,t.adler>>8&255),t.adler=0}if(e.status=113,xr(t),0!==e.pending)return e.last_flush=-1,Ci}if(0!==t.avail_in||0!==e.lookahead||n!==qs&&666!==e.status){let r=0===e.level?Qx(e,n):e.strategy===Ff?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(ic(t),0===t.lookahead)){if(n===qs)return 1;break}if(t.match_length=0,e=Ys(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(Dr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Gr?(Dr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Dr(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===a6?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(ic(t),t.lookahead<=258&&n===qs)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=Ys(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Ys(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(Dr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Gr?(Dr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Dr(t,!1),0===t.strm.avail_out)?1:2})(e,n):Wu[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),Ci;if(2===r&&(n===n6?t6(e):n!==Yx&&(h0(e,0,0,!1),n===i6&&(Xs(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),xr(t),0===t.avail_out))return e.last_flush=-1,Ci}return n!==Gr?Ci:e.wrap<=0?qx:(2===e.wrap?(rn(e,255&t.adler),rn(e,t.adler>>8&255),rn(e,t.adler>>16&255),rn(e,t.adler>>24&255),rn(e,255&t.total_in),rn(e,t.total_in>>8&255),rn(e,t.total_in>>16&255),rn(e,t.total_in>>24&255)):($u(e,t.adler>>>16),$u(e,65535&t.adler)),xr(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?Ci:qx)},deflateEnd:t=>{if(Zu(t))return No;const n=t.state.status;return t.state=null,113===n?Ra(t,r6):Ci},deflateSetDictionary:(t,n)=>{let e=n.length;if(Zu(t))return No;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return No;if(1===r&&(t.adler=Hu(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(Xs(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(n.subarray(e-i.w_size,e),0),n=l,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,ic(i);i.lookahead>=3;){let l=i.strstart,c=i.lookahead-2;do{i.ins_h=Qs(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++}while(--c);i.strstart=l,i.lookahead=2,ic(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,Ci},deflateInfo:"pako deflate (from Nodeca project)"};const U6=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var Rf={assign:function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)U6(e,i)&&(t[i]=e[i])}}return t},flattenChunks:t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e}};let nD=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{nD=!1}const qu=new Uint8Array(256);for(let t=0;t<256;t++)qu[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;qu[254]=qu[254]=1;var Ku={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},buf2string:(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=qu[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&nD)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},utf8border:(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+qu[t[e]]>n?e:n}},iD=function Z6(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const rD=Object.prototype.toString,{Z_NO_FLUSH:Y6,Z_SYNC_FLUSH:q6,Z_FULL_FLUSH:K6,Z_FINISH:X6,Z_OK:Lf,Z_STREAM_END:Q6,Z_DEFAULT_COMPRESSION:J6,Z_DEFAULT_STRATEGY:e8,Z_DEFLATED:t8}=Pa;function Xu(t){this.options=Rf.assign({level:J6,method:t8,chunkSize:16384,windowBits:15,memLevel:8,strategy:e8},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iD,this.strm.avail_out=0;let e=Yu.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==Lf)throw new Error(Aa[e]);if(n.header&&Yu.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Ku.string2buf(n.dictionary):"[object ArrayBuffer]"===rD.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Yu.deflateSetDictionary(this.strm,i),e!==Lf)throw new Error(Aa[e]);this._dict_set=!0}}function w0(t,n){const e=new Xu(n);if(e.push(t,!0),e.err)throw e.msg||Aa[e.err];return e.result}Xu.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?X6:Y6,e.input="string"==typeof t?Ku.string2buf(t):"[object ArrayBuffer]"===rD.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===q6||o===K6)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Yu.deflate(e,o),r===Q6)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Yu.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Lf;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Xu.prototype.onData=function(t){this.chunks.push(t)},Xu.prototype.onEnd=function(t){t===Lf&&(this.result=Rf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var c8={Deflate:Xu,deflate:w0,deflateRaw:function n8(t,n){return(n=n||{}).raw=!0,w0(t,n)},gzip:function i8(t,n){return(n=n||{}).gzip=!0,w0(t,n)},constants:Pa};const Bf=16209;var d8=function(n,e){let i,r,o,s,a,l,c,u,h,g,E,L,Z,re,oe,ce,ue,be,Ke,ft,Xe,Bt,Tt,lt;const zt=n.state;i=n.next_in,Tt=n.input,r=i+(n.avail_in-5),o=n.next_out,lt=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),l=zt.dmax,c=zt.wsize,u=zt.whave,h=zt.wnext,g=zt.window,E=zt.hold,L=zt.bits,Z=zt.lencode,re=zt.distcode,oe=(1<<zt.lenbits)-1,ce=(1<<zt.distbits)-1;e:do{L<15&&(E+=Tt[i++]<<L,L+=8,E+=Tt[i++]<<L,L+=8),ue=Z[E&oe];t:for(;;){if(be=ue>>>24,E>>>=be,L-=be,be=ue>>>16&255,0===be)lt[o++]=65535&ue;else{if(!(16&be)){if(64&be){if(32&be){zt.mode=16191;break e}n.msg="invalid literal/length code",zt.mode=Bf;break e}ue=Z[(65535&ue)+(E&(1<<be)-1)];continue t}for(Ke=65535&ue,be&=15,be&&(L<be&&(E+=Tt[i++]<<L,L+=8),Ke+=E&(1<<be)-1,E>>>=be,L-=be),L<15&&(E+=Tt[i++]<<L,L+=8,E+=Tt[i++]<<L,L+=8),ue=re[E&ce];;){if(be=ue>>>24,E>>>=be,L-=be,be=ue>>>16&255,16&be){if(ft=65535&ue,be&=15,L<be&&(E+=Tt[i++]<<L,L+=8,L<be&&(E+=Tt[i++]<<L,L+=8)),ft+=E&(1<<be)-1,ft>l){n.msg="invalid distance too far back",zt.mode=Bf;break e}if(E>>>=be,L-=be,be=o-s,ft>be){if(be=ft-be,be>u&&zt.sane){n.msg="invalid distance too far back",zt.mode=Bf;break e}if(Xe=0,Bt=g,0===h){if(Xe+=c-be,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}}else if(h<be){if(Xe+=c+h-be,be-=h,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);if(Xe=0,h<Ke){be=h,Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}}}else if(Xe+=h-be,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}for(;Ke>2;)lt[o++]=Bt[Xe++],lt[o++]=Bt[Xe++],lt[o++]=Bt[Xe++],Ke-=3;Ke&&(lt[o++]=Bt[Xe++],Ke>1&&(lt[o++]=Bt[Xe++]))}else{Xe=o-ft;do{lt[o++]=lt[Xe++],lt[o++]=lt[Xe++],lt[o++]=lt[Xe++],Ke-=3}while(Ke>2);Ke&&(lt[o++]=lt[Xe++],Ke>1&&(lt[o++]=lt[Xe++]))}break}if(64&be){n.msg="invalid distance code",zt.mode=Bf;break e}ue=re[(65535&ue)+(E&(1<<be)-1)]}}break}}while(i<r&&o<a);Ke=L>>3,i-=Ke,L-=Ke<<3,E&=(1<<L)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),zt.hold=E,zt.bits=L};const h8=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),f8=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),p8=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),g8=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Qu=(t,n,e,i,r,o,s,a)=>{const l=a.bits;let ue,be,Ke,ft,Xe,Tt,c=0,u=0,h=0,g=0,E=0,L=0,Z=0,re=0,oe=0,ce=0,Bt=null;const lt=new Uint16Array(16),zt=new Uint16Array(16);let Kr,Xr,Jo,Qi=null;for(c=0;c<=15;c++)lt[c]=0;for(u=0;u<i;u++)lt[n[e+u]]++;for(E=l,g=15;g>=1&&0===lt[g];g--);if(E>g&&(E=g),0===g)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(h=1;h<g&&0===lt[h];h++);for(E<h&&(E=h),re=1,c=1;c<=15;c++)if(re<<=1,re-=lt[c],re<0)return-1;if(re>0&&(0===t||1!==g))return-1;for(zt[1]=0,c=1;c<15;c++)zt[c+1]=zt[c]+lt[c];for(u=0;u<i;u++)0!==n[e+u]&&(s[zt[n[e+u]]++]=u);if(0===t?(Bt=Qi=s,Tt=20):1===t?(Bt=h8,Qi=f8,Tt=257):(Bt=p8,Qi=g8,Tt=0),ce=0,u=0,c=h,Xe=o,L=E,Z=0,Ke=-1,oe=1<<E,ft=oe-1,1===t&&oe>852||2===t&&oe>592)return 1;for(;;){Kr=c-Z,s[u]+1<Tt?(Xr=0,Jo=s[u]):s[u]>=Tt?(Xr=Qi[s[u]-Tt],Jo=Bt[s[u]-Tt]):(Xr=96,Jo=0),ue=1<<c-Z,be=1<<L,h=be;do{be-=ue,r[Xe+(ce>>Z)+be]=Kr<<24|Xr<<16|Jo|0}while(0!==be);for(ue=1<<c-1;ce&ue;)ue>>=1;if(0!==ue?(ce&=ue-1,ce+=ue):ce=0,u++,0==--lt[c]){if(c===g)break;c=n[e+s[u]]}if(c>E&&(ce&ft)!==Ke){for(0===Z&&(Z=E),Xe+=h,L=c-Z,re=1<<L;L+Z<g&&(re-=lt[L+Z],!(re<=0));)L++,re<<=1;if(oe+=1<<L,1===t&&oe>852||2===t&&oe>592)return 1;Ke=ce&ft,r[Ke]=E<<24|L<<16|Xe-o|0}}return 0!==ce&&(r[Xe+ce]=c-Z<<24|64<<16|0),a.bits=E,0};const{Z_FINISH:dD,Z_BLOCK:_8,Z_TREES:zf,Z_OK:La,Z_STREAM_END:v8,Z_NEED_DICT:y8,Z_STREAM_ERROR:$r,Z_DATA_ERROR:hD,Z_MEM_ERROR:fD,Z_BUF_ERROR:b8,Z_DEFLATED:pD}=Pa,Uf=16180,Vf=16190,Cs=16191,jf=16199,Hf=16200,Mn=16209,BD=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function T8(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ba=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<Uf||n.mode>16211?1:0},zD=t=>{if(Ba(t))return $r;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=Uf,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,La},UD=t=>{if(Ba(t))return $r;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,zD(t)},VD=(t,n)=>{let e;if(Ba(t))return $r;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?$r:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,UD(t))},jD=(t,n)=>{if(!t)return $r;const e=new T8;t.state=e,e.strm=t,e.window=null,e.mode=Uf;const i=VD(t,n);return i!==La&&(t.state=null),i};let S0,M0,HD=!0;const D8=t=>{if(HD){S0=new Int32Array(512),M0=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(Qu(1,t.lens,0,288,S0,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;Qu(2,t.lens,0,32,M0,0,t.work,{bits:5}),HD=!1}t.lencode=S0,t.lenbits=9,t.distcode=M0,t.distbits=5},GD=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var ws={inflateReset:UD,inflateReset2:VD,inflateResetKeep:zD,inflateInit:t=>jD(t,15),inflateInit2:jD,inflate:(t,n)=>{let e,i,r,o,s,a,l,c,u,h,g,E,L,Z,oe,ce,ue,be,Ke,ft,Xe,Bt,re=0;const Tt=new Uint8Array(4);let lt,zt;const Qi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ba(t)||!t.output||!t.input&&0!==t.avail_in)return $r;e=t.state,e.mode===Cs&&(e.mode=16192),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,h=a,g=l,Bt=La;e:for(;;)switch(e.mode){case Uf:if(0===e.wrap){e.mode=16192;break}for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(2&e.wrap&&35615===c){0===e.wbits&&(e.wbits=15),e.check=0,Tt[0]=255&c,Tt[1]=c>>>8&255,e.check=fi(e.check,Tt,2,0),c=0,u=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",e.mode=Mn;break}if((15&c)!==pD){t.msg="unknown compression method",e.mode=Mn;break}if(c>>>=4,u-=4,Xe=8+(15&c),0===e.wbits&&(e.wbits=Xe),Xe>15||Xe>e.wbits){t.msg="invalid window size",e.mode=Mn;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&c?16189:Cs,c=0,u=0;break;case 16181:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.flags=c,(255&e.flags)!==pD){t.msg="unknown compression method",e.mode=Mn;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Mn;break}e.head&&(e.head.text=c>>8&1),512&e.flags&&4&e.wrap&&(Tt[0]=255&c,Tt[1]=c>>>8&255,e.check=fi(e.check,Tt,2,0)),c=0,u=0,e.mode=16182;case 16182:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.time=c),512&e.flags&&4&e.wrap&&(Tt[0]=255&c,Tt[1]=c>>>8&255,Tt[2]=c>>>16&255,Tt[3]=c>>>24&255,e.check=fi(e.check,Tt,4,0)),c=0,u=0,e.mode=16183;case 16183:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.xflags=255&c,e.head.os=c>>8),512&e.flags&&4&e.wrap&&(Tt[0]=255&c,Tt[1]=c>>>8&255,e.check=fi(e.check,Tt,2,0)),c=0,u=0,e.mode=16184;case 16184:if(1024&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length=c,e.head&&(e.head.extra_len=c),512&e.flags&&4&e.wrap&&(Tt[0]=255&c,Tt[1]=c>>>8&255,e.check=fi(e.check,Tt,2,0)),c=0,u=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(E=e.length,E>a&&(E=a),E&&(e.head&&(Xe=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+E),Xe)),512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,e.length-=E),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;E=0;do{Xe=i[o+E++],e.head&&Xe&&e.length<65536&&(e.head.name+=String.fromCharCode(Xe))}while(Xe&&E<a);if(512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,Xe)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;E=0;do{Xe=i[o+E++],e.head&&Xe&&e.length<65536&&(e.head.comment+=String.fromCharCode(Xe))}while(Xe&&E<a);if(512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,Xe)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(4&e.wrap&&c!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Mn;break}c=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Cs;break;case 16189:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}t.adler=e.check=BD(c),c=0,u=0,e.mode=Vf;case Vf:if(0===e.havedict)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,y8;t.adler=e.check=1,e.mode=Cs;case Cs:if(n===_8||n===zf)break e;case 16192:if(e.last){c>>>=7&u,u-=7&u,e.mode=16206;break}for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}switch(e.last=1&c,c>>>=1,u-=1,3&c){case 0:e.mode=16193;break;case 1:if(D8(e),e.mode=jf,n===zf){c>>>=2,u-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Mn}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Mn;break}if(e.length=65535&c,c=0,u=0,e.mode=16194,n===zf)break e;case 16194:e.mode=16195;case 16195:if(E=e.length,E){if(E>a&&(E=a),E>l&&(E=l),0===E)break e;r.set(i.subarray(o,o+E),s),a-=E,o+=E,l-=E,s+=E,e.length-=E;break}e.mode=Cs;break;case 16196:for(;u<14;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.nlen=257+(31&c),c>>>=5,u-=5,e.ndist=1+(31&c),c>>>=5,u-=5,e.ncode=4+(15&c),c>>>=4,u-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Mn;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.lens[Qi[e.have++]]=7&c,c>>>=3,u-=3}for(;e.have<19;)e.lens[Qi[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,lt={bits:e.lenbits},Bt=Qu(0,e.lens,0,19,e.lencode,0,e.work,lt),e.lenbits=lt.bits,Bt){t.msg="invalid code lengths set",e.mode=Mn;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;re=e.lencode[c&(1<<e.lenbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(ue<16)c>>>=oe,u-=oe,e.lens[e.have++]=ue;else{if(16===ue){for(zt=oe+2;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(c>>>=oe,u-=oe,0===e.have){t.msg="invalid bit length repeat",e.mode=Mn;break}Xe=e.lens[e.have-1],E=3+(3&c),c>>>=2,u-=2}else if(17===ue){for(zt=oe+3;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=oe,u-=oe,Xe=0,E=3+(7&c),c>>>=3,u-=3}else{for(zt=oe+7;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=oe,u-=oe,Xe=0,E=11+(127&c),c>>>=7,u-=7}if(e.have+E>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Mn;break}for(;E--;)e.lens[e.have++]=Xe}}if(e.mode===Mn)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Mn;break}if(e.lenbits=9,lt={bits:e.lenbits},Bt=Qu(1,e.lens,0,e.nlen,e.lencode,0,e.work,lt),e.lenbits=lt.bits,Bt){t.msg="invalid literal/lengths set",e.mode=Mn;break}if(e.distbits=6,e.distcode=e.distdyn,lt={bits:e.distbits},Bt=Qu(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,lt),e.distbits=lt.bits,Bt){t.msg="invalid distances set",e.mode=Mn;break}if(e.mode=jf,n===zf)break e;case jf:e.mode=Hf;case Hf:if(a>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,d8(t,g),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,e.mode===Cs&&(e.back=-1);break}for(e.back=0;re=e.lencode[c&(1<<e.lenbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(ce&&!(240&ce)){for(be=oe,Ke=ce,ft=ue;re=e.lencode[ft+((c&(1<<be+Ke)-1)>>be)],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(be+oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=be,u-=be,e.back+=be}if(c>>>=oe,u-=oe,e.back+=oe,e.length=ue,0===ce){e.mode=16205;break}if(32&ce){e.back=-1,e.mode=Cs;break}if(64&ce){t.msg="invalid literal/length code",e.mode=Mn;break}e.extra=15&ce,e.mode=16201;case 16201:if(e.extra){for(zt=e.extra;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;re=e.distcode[c&(1<<e.distbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(!(240&ce)){for(be=oe,Ke=ce,ft=ue;re=e.distcode[ft+((c&(1<<be+Ke)-1)>>be)],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(be+oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=be,u-=be,e.back+=be}if(c>>>=oe,u-=oe,e.back+=oe,64&ce){t.msg="invalid distance code",e.mode=Mn;break}e.offset=ue,e.extra=15&ce,e.mode=16203;case 16203:if(e.extra){for(zt=e.extra;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Mn;break}e.mode=16204;case 16204:if(0===l)break e;if(E=g-l,e.offset>E){if(E=e.offset-E,E>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Mn;break}E>e.wnext?(E-=e.wnext,L=e.wsize-E):L=e.wnext-E,E>e.length&&(E=e.length),Z=e.window}else Z=r,L=s-e.offset,E=e.length;E>l&&(E=l),l-=E,e.length-=E;do{r[s++]=Z[L++]}while(--E);0===e.length&&(e.mode=Hf);break;case 16205:if(0===l)break e;r[s++]=e.length,l--,e.mode=Hf;break;case 16206:if(e.wrap){for(;u<32;){if(0===a)break e;a--,c|=i[o++]<<u,u+=8}if(g-=l,t.total_out+=g,e.total+=g,4&e.wrap&&g&&(t.adler=e.check=e.flags?fi(e.check,r,g,s-g):Hu(e.check,r,g,s-g)),g=l,4&e.wrap&&(e.flags?c:BD(c))!==e.check){t.msg="incorrect data check",e.mode=Mn;break}c=0,u=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(4&e.wrap&&c!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Mn;break}c=0,u=0}e.mode=16208;case 16208:Bt=v8;break e;case Mn:Bt=hD;break e;case 16210:return fD;default:return $r}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,(e.wsize||g!==t.avail_out&&e.mode<Mn&&(e.mode<16206||n!==dD))&&GD(t,t.output,t.next_out,g-t.avail_out),h-=t.avail_in,g-=t.avail_out,t.total_in+=h,t.total_out+=g,e.total+=g,4&e.wrap&&g&&(t.adler=e.check=e.flags?fi(e.check,r,g,t.next_out-g):Hu(e.check,r,g,t.next_out-g)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Cs?128:0)+(e.mode===jf||16194===e.mode?256:0),(0===h&&0===g||n===dD)&&Bt===La&&(Bt=b8),Bt},inflateEnd:t=>{if(Ba(t))return $r;let n=t.state;return n.window&&(n.window=null),t.state=null,La},inflateGetHeader:(t,n)=>{if(Ba(t))return $r;const e=t.state;return 2&e.wrap?(e.head=n,n.done=!1,La):$r},inflateSetDictionary:(t,n)=>{const e=n.length;let i,r,o;return Ba(t)||(i=t.state,0!==i.wrap&&i.mode!==Vf)?$r:i.mode===Vf&&(r=1,r=Hu(r,n,e,0),r!==i.check)?hD:(o=GD(t,n,e,e),o?(i.mode=16210,fD):(i.havedict=1,La))},inflateInfo:"pako inflate (from Nodeca project)"},j8=function V8(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const $D=Object.prototype.toString,{Z_NO_FLUSH:H8,Z_FINISH:G8,Z_OK:Ju,Z_STREAM_END:k0,Z_NEED_DICT:I0,Z_STREAM_ERROR:$8,Z_DATA_ERROR:WD,Z_MEM_ERROR:W8}=Pa;function ed(t){this.options=Rf.assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(15&n.windowBits||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iD,this.strm.avail_out=0;let e=ws.inflateInit2(this.strm,n.windowBits);if(e!==Ju)throw new Error(Aa[e]);if(this.header=new j8,ws.inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Ku.string2buf(n.dictionary):"[object ArrayBuffer]"===$D.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=ws.inflateSetDictionary(this.strm,n.dictionary),e!==Ju)))throw new Error(Aa[e])}function O0(t,n){const e=new ed(n);if(e.push(t),e.err)throw e.msg||Aa[e.err];return e.result}ed.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?G8:H8,e.input="[object ArrayBuffer]"===$D.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=ws.inflate(e,s),o===I0&&r&&(o=ws.inflateSetDictionary(e,r),o===Ju?o=ws.inflate(e,s):o===WD&&(o=I0));e.avail_in>0&&o===k0&&e.state.wrap>0&&0!==t[e.next_in];)ws.inflateReset(e),o=ws.inflate(e,s);switch(o){case $8:case WD:case I0:case W8:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===k0))if("string"===this.options.to){let l=Ku.utf8border(e.output,e.next_out),c=e.next_out-l,u=Ku.buf2string(e.output,l);e.next_out=c,e.avail_out=i-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(u)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==Ju||0!==a){if(o===k0)return o=ws.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},ed.prototype.onData=function(t){this.chunks.push(t)},ed.prototype.onEnd=function(t){t===Ju&&(this.result="string"===this.options.to?this.chunks.join(""):Rf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var J8={Inflate:ed,inflate:O0,inflateRaw:function Z8(t,n){return(n=n||{}).raw=!0,O0(t,n)},ungzip:O0,constants:Pa};const{Deflate:ez}=c8,{Inflate:rz}=J8;var ZD=ez,YD=rz;function A0(){return(A0=(0,Mt.Z)(function*(t,n){const e=new ZD({level:2,gzip:!0});try{return yield qD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function P0(){return(P0=(0,Mt.Z)(function*(t,n){const e=new YD;try{return yield qD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function qD(t,n){return F0.apply(this,arguments)}function F0(){return(F0=(0,Mt.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield new Promise(t=>Ri(t)),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t})).apply(this,arguments)}var Sr,t,KD=Y(2391);(t=Sr||(Sr={})).encode=function n(i){try{return KD.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return KD.decode(i)}catch(r){console.error(r,i)}return null};class N0{get hasPassword(){return this.peers.some(n=>n.hasPassword)}constructor(n="",e="",i=[]){this.id="",this.name="",this.peers=[],this.id=n,this.name=e,this.peers=i}filterByPassword(n){return this.peers.filter(e=>e.verifyPassword(n))}static listFrom(n){let e=n.map(o=>Tn.parse(o)).sort((o,s)=>o.peerId>s.peerId?1:o.peerId<s.peerId?-1:0),i=new Map;for(let o of e)if(o.isRoom){let s=o.roomId+o.roomName,a=i.get(s)??new N0(o.roomId,o.roomName);a.peers.push(o),i.set(s,a)}return i.size<1?[]:Array.from(i.values()).sort((o,s)=>o.id+o.name<s.id+s.name?-1:o.id+o.name>s.id+s.name?1:0)}}var td,vz=Y(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(td||(td={}));class Bo{get isActive(){return null!=this.timeoutTimer}constructor(n,e,i=!0){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,i&&this.reset()}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class Gf{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new Bo(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,8e3)}static doMonitoringAsync(){var n=this;return(0,Mt.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}Gf.updateWebRTCStatsTimer=null,Gf.monitoringConnections=new Set;var Wr=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(Wr||(Wr={})),Wr))();class yz{constructor(n){this.peerConnection=n,this.candidateType=Wr.UNKNOWN}updateAsync(){var n=this;return(0,Mt.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(g){console.warn(g)}if(null==e)return void(n.candidateType=Wr.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],l=[],c=[];e.forEach(g=>{0<=g.type.indexOf("candidate-pair")&&i.push(g),0<=g.type.indexOf("local-candidate")&&r.push(g),0<=g.type.indexOf("remote-candidate")&&o.push(g)}),i.forEach(g=>{"succeeded"===g.state&&(s.push(g.localCandidateId),a.push(g.remoteCandidateId))}),r.forEach(g=>{s.includes(g.id)&&l.push(g)}),o.forEach(g=>{a.includes(g.id)&&c.push(g)});let u=Wr.UNKNOWN,h=Object.values(Wr);l.concat(c).forEach(g=>{let E=h.indexOf(g.candidateType);h.indexOf(u)<E&&(u=h[E])}),n.candidateType=u})()}}class XD extends vz.EventEmitter{get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){return this.conn._dc?.bufferedAmount??0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}constructor(n,e){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Wr.UNKNOWN,this.peer=Tn.parse(e.peerId),this.peer.userId=e.userId,this.peer.password=e.password,n.on("data",i=>this.onData(i)),n.on("open",()=>{this.stats=new yz(this.getPeerConnection()),this.peer.isOpen=!0,this.clearTimeoutTimer(),function bz(t){t._dc&&t._sendBuffer&&(t._startSendLoop=Cz)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.peer.isOpen=!1,this.clearTimeoutTimer(),this.emit("close")}),n.on("error",i=>{this.clearTimeoutTimer(),this.emit("error",i)}),this.setTimeoutTimer()}close(){this.peer.isOpen=!1,this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=Sr.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=td.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(Sr.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){Gf.add(this)}stopMonitoring(){Gf.remove(this)}updateStatsAsync(){var n=this;return(0,Mt.Z)(function*(){if(null==n.stats)return;n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType;let e=performance.now()-n.timestamp,i=e<=1e4?1:5e3/(e-1e4+5e3),r=i<1?e:n.ping,o=500/(r+500);switch(n.peer.session.health=i,n.peer.session.ping=r,n.peer.session.speed=o*i,n.candidateType){case Wr.HOST:n.peer.session.grade=Zs.HIGH;break;case Wr.SRFLX:case Wr.PRFLX:n.peer.session.grade=Zs.MIDDLE;break;case Wr.RELAY:n.peer.session.grade=Zs.LOW;break;default:n.peer.session.grade=Zs.UNSPECIFIED}n.peer.session.description=n.candidateType,n.emit("stats",n.stats)})()}sendPing(){let n=Sr.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=Sr.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=Sr.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let c of o.chanks)s.set(c,a),a+=c.byteLength;let l=Sr.decode(s);this.emit("data",l)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function Cz(){this.sendInterval||(this.sendInterval=Ri(QD.bind(this)))}function QD(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch{this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Ri(QD.bind(this))}class wz{constructor(){this.connections=[],this.needsRefreshPeers=!1,this._peers=[],this.needsRefreshPeerIds=!1,this._peerIds=[]}get length(){return this.connections.length}[Symbol.iterator](){let n=this.connections.concat(),e=0;return{next:()=>({value:n[e++],done:n.length+1<=e})}}get peers(){return this.needsRefreshPeers&&(this.needsRefreshPeers=!1,this._peers=this.connections.map(n=>n.peer),this._peers.sort((n,e)=>n.peerId>e.peerId?1:n.peerId<e.peerId?-1:0)),this._peers}get peerIds(){if(this.needsRefreshPeerIds){this.needsRefreshPeerIds=!1;let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);n.sort((e,i)=>e>i?1:e<i?-1:0),this._peerIds=n}return this._peerIds}add(n){let e=this.find(n.remoteId);if(null!=e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting.",e),e!==n){if(!(e.metadata.sortKey<n.metadata.sortKey))return this.remove(e),this.add(n);this.remove(n)}return null}return this.connections.push(n),this.refresh(),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),n}remove(n){n.close();let e=this.connections.indexOf(n);return 0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.refresh()),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length),0<=e?n:null}find(n){return this.connections.find(e=>e.remoteId===n)}refresh(){this.needsRefreshPeers=!0,this.needsRefreshPeerIds=!0}}class Ez{constructor(){this.peer=Tn.parse("???"),this.callback=new wx,this.bandwidthUsage=0,this.key="",this.connections=new wz,this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get userIds(){return this.peers.map(n=>n.userId).filter(n=>0<n.length).concat([this.peer.userId])}get peerId(){return this.peer.peerId}get peerIds(){return this.connections.peerIds}get peers(){return this.connections.peers}open(...n){console.log("open",n),this.peer=0===n.length?Tn.create(Tn.generateId()):1===n.length?Tn.create(n[0]):Tn.create(n[0],n[1],n[2],n[3]),this.openSkyWay()}close(){this.skyWay&&this.skyWay.destroy(),this.disconnectAll(),this.skyWay=null,this.peer=Tn.parse("???")}connect(n){if(!this.shouldConnect(n.peerId))return!1;let e=new XD(this.skyWay.connect(n.peerId,{serialization:"none",metadata:{sortKey:this.peer.digestUserId,token:this.peer.isRoom?"":JD(this.peer.digestUserId+n.userId)}}),n);return this.openDataConnection(e),!0}shouldConnect(n){return this.peer&&this.skyWay&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.connections.find(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):this.peer.verifyPeer(n)?!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. <"+n+"> is not valid."),!1):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.connections.find(n.peerId);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections)this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:Sr.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Ri((0,Mt.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let l=yield function gz(t,n){return A0.apply(this,arguments)}(r.data);l.byteLength<r.data.byteLength&&(r.data=l,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.connections.find(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.skyWay)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.skyWay.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}listAllRooms(){var n=this;return(0,Mt.Z)(function*(){let e=yield n.listAllPeers();return N0.listFrom(e)})()}openSkyWay(){this.skyWay&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peer.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),this.peer.peerId===e?(this.peer.isOpen=!0,console.log("My peer Context",this.peer),this.callback.onOpen&&this.callback.onOpen(this.peer)):console.error("...peer is not me? <"+e+">",this.peer)}),n.on("close",()=>{console.log("Peer close"),this.peer.isOpen&&(this.peer.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peer))}),n.on("connection",e=>{let i=this.peer.verifyPeer(e.remoteId),r=this.peer.isRoom||e.metadata.token===JD(e.metadata.sortKey+this.peer.userId);if(!i||!r)return e.close(),e.on("open",()=>e.close()),void console.log("connection is close. <"+e.remoteId+"> is not valid.");let o=Tn.parse(e.remoteId);this.openDataConnection(new XD(e,o))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(Tn.parse(r));break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peer&&this.peer.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peer))}this.callback.onError&&this.callback.onError(this.peer,e.type,i,e)}),this.skyWay=n}openDataConnection(n){null!=this.connections.add(n)&&(this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",e=>{this.onData(n,e)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),this.notifyUserList(),this.callback.onConnect&&this.callback.onConnect(n.peer)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{n.peer.session.health<.2&&this.closeDataConnection(n)}))}closeDataConnection(n){let e=this.connections.remove(n);this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),this.notifyUserList(),e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.peer)}onData(n,e){var i=this;if(e.users&&0<e.users.length&&this.onUpdateUserIds(n,e.users),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Ri((0,Mt.Z)(function*(){let a=e.isCompressed?yield function mz(t,n){return P0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.peer,Sr.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i){e.users&&0<e.users.length&&(e.users=this.userIds);for(let r of i){let o=this.connections.find(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}}onUpdateUserIds(n,e){let i=!1;e.forEach(a=>{let l=this.makeFriendPeer(a),c=this.connections.find(l.peerId);c&&c.peer.userId!==a&&(c.peer.userId=a,i=!0)});let r=function Tz(t,n){let e=[],i=[],r=!1,o=!1;for(let s of t.concat(n))r=t.includes(s),o=n.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this.userIds,e),s=r.diff2;if(this.relayingPeerIds.set(n.remoteId,r.diff1.map(a=>this.makeFriendPeer(a).peerId)),s.length)for(let a of s){let l=this.makeFriendPeer(a);!this.maybeUnavailablePeerIds.has(l.peerId)&&this.connect(l)&&console.log("auto connect to unknown Peer <"+l.peerId+">")}i&&this.notifyUserList()}notifyUserList(){if(this.connections.refresh(),this.connections.length<1)return;let n={data:Sr.encode([]),users:this.userIds,ttl:1};this.sendBroadcast(n)}makeFriendPeer(n){return this.peer.isRoom?Tn.create(n,this.peer.roomId,this.peer.roomName,this.peer.password):Tn.create(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}function JD(t){if(null==t)return"";let n=e0(t),e=Uint32Array.from(n.words).buffer;return btoa(String.fromCharCode(...new Uint8Array(e)))}const eS=Tn.parse("???");class zo{static get instance(){return zo._instance||(zo._instance=new zo),zo._instance}get isOpen(){return!!this.connection&&this.connection.peer.isOpen}get peerId(){return this.connection?this.connection.peerId:eS.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peer(){return this.connection?this.connection.peer:eS}get peers(){return this.connection?this.connection.peers.concat():[]}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}constructor(){this.callback=new wx,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}open(...n){this.connection&&this.connection.peer&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){this.connection&&this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n.peerId),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Ri(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peer,i)),this.sendInterval=0<this.queue.size?Ri(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}listAllRooms(){return this.connection?this.connection.listAllRooms():Promise.resolve([])}initializeConnection(){let n=new Ez;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Ri(this.sendCallback)),n}}class sc{constructor(n,e,i=zo.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===zo.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class R0{get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new R0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class za{static get instance(){return za._instance||(za._instance=new za,za._instance.initializeNetworkEvent()),za._instance}constructor(){this.listenerMap=new Map,this.keyMap=new Map,console.log("EventSystem ready...")}register(n){return new R0(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=[];if(null!=n)r=this.getListenersByKey(n);else if(null!=e)r=this.getListenersByEventName(e);else{let o=this.listenerMap.values();for(let s of o)r=r.concat(s)}for(let o of r.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListenersByEventName(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),e=this.getListenersByKey(n.key),e.push(n),this.keyMap.set(n.key,e),n}unregisterListener(n){let e=this.getListenersByEventName(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),e.length<1&&this.listenerMap.delete(n.eventName),e=this.getListenersByKey(n.key),i=e.indexOf(n),0<=i&&e.splice(i,1),e.length<1&&this.keyMap.delete(n.key),n.unregister(),n)}call(...n){"string"==typeof n[0]?this._call(new sc(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();zo.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof sc?n[0]:new sc(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new sc(n[0],n[1]))}_trigger(n){let e=this.getListenersByEventName(n.eventName).concat(this.getListenersByEventName("*"));for(let i of e)i.trigger(n);return n}getListenersByEventName(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}getListenersByKey(n){return this.keyMap.has(n)?this.keyMap.get(n):[]}initializeNetworkEvent(){let n=zo.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e.peerId})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e.peerId})},n.onConnect=e=>{this.sendSystemMessage("<"+e.userId+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e.peerId})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e.userId+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e.peerId})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e.userId+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e.peerId,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const pe=za.instance,We=zo.instance;function tS(t){return typeof t>"u"||null===t}var ci={isNothing:tS,isObject:function xz(t){return"object"==typeof t&&null!==t},toArray:function Dz(t){return Array.isArray(t)?t:tS(t)?[]:[t]},repeat:function Mz(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},isNegativeZero:function kz(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function Sz(t,n){var e,i,r,o;if(n)for(e=0,i=(o=Object.keys(n)).length;e<i;e+=1)t[r=o[e]]=n[r];return t}};function nS(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function nd(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=nS(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(nd.prototype=Object.create(Error.prototype)).constructor=nd,nd.prototype.toString=function(n){return this.name+": "+nS(this,n)};var Xi=nd;function L0(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function B0(t,n){return ci.repeat(" ",n-t.length)+t}var Lz=function Rz(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var l,c,a="",u=Math.min(t.line+n.linesAfter,r.length).toString().length,h=n.maxLength-(n.indent+u+3);for(l=1;l<=n.linesBefore&&!(s-l<0);l++)c=L0(t.buffer,i[s-l],r[s-l],t.position-(i[s]-i[s-l]),h),a=ci.repeat(" ",n.indent)+B0((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=L0(t.buffer,i[s],r[s],t.position,h),a+=ci.repeat(" ",n.indent)+B0((t.line+1).toString(),u)+" | "+c.str+"\n",a+=ci.repeat("-",n.indent+u+3+c.pos)+"^\n",l=1;l<=n.linesAfter&&!(s+l>=r.length);l++)c=L0(t.buffer,i[s+l],r[s+l],t.position-(i[s]-i[s+l]),h),a+=ci.repeat(" ",n.indent)+B0((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")},Bz=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],zz=["scalar","sequence","mapping"],wi=function Vz(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===Bz.indexOf(e))throw new Xi('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function Uz(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===zz.indexOf(this.kind))throw new Xi('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function iS(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function z0(t){return this.extend(t)}z0.prototype.extend=function(n){var e=[],i=[];if(n instanceof wi)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Xi("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof wi))throw new Xi("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new Xi("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new Xi("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof wi))throw new Xi("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(z0.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=iS(r,"implicit"),r.compiledExplicit=iS(r,"explicit"),r.compiledTypeMap=function jz(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var rS=z0,oS=new wi("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),sS=new wi("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),aS=new wi("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),lS=new rS({explicit:[oS,sS,aS]}),cS=new wi("tag:yaml.org,2002:null",{kind:"scalar",resolve:function Hz(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function Gz(){return null},predicate:function $z(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),uS=new wi("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function Wz(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function Zz(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function Yz(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function qz(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function Kz(t){return 48<=t&&t<=55}function Xz(t){return 48<=t&&t<=57}var dS=new wi("tag:yaml.org,2002:int",{kind:"scalar",resolve:function Qz(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!qz(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!Kz(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!Xz(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function Jz(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function eU(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!ci.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),tU=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),rU=/^[-+]?[0-9]+e/,hS=new wi("tag:yaml.org,2002:float",{kind:"scalar",resolve:function nU(t){return!(null===t||!tU.test(t)||"_"===t[t.length-1])},construct:function iU(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function sU(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||ci.isNegativeZero(t))},represent:function oU(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(ci.isNegativeZero(t))return"-0.0";return e=t.toString(10),rU.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),pS=lS.extend({implicit:[cS,uS,dS,hS]}),gS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),mS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),_S=new wi("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function aU(t){return null!==t&&(null!==gS.exec(t)||null!==mS.exec(t))},construct:function lU(t){var n,e,i,r,o,s,a,g,l=0,c=null;if(null===(n=gS.exec(t))&&(n=mS.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(c=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(c=-c)),g=new Date(Date.UTC(e,i,r,o,s,a,l)),c&&g.setTime(g.getTime()-c),g},instanceOf:Date,represent:function cU(t){return t.toISOString()}}),vS=new wi("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function uU(t){return"<<"===t||null===t}}),U0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",yS=new wi("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function dU(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=U0;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function hU(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=U0,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function pU(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function fU(t){var i,r,n="",e=0,o=t.length,s=U0;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),gU=Object.prototype.hasOwnProperty,mU=Object.prototype.toString,bS=new wi("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function _U(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==mU.call(r=a[e]))return!1;for(o in r)if(gU.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function vU(t){return null!==t?t:[]}}),yU=Object.prototype.toString,CS=new wi("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function bU(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==yU.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function CU(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),wU=Object.prototype.hasOwnProperty,wS=new wi("tag:yaml.org,2002:set",{kind:"mapping",resolve:function EU(t){if(null===t)return!0;var n,e=t;for(n in e)if(wU.call(e,n)&&null!==e[n])return!1;return!0},construct:function TU(t){return null!==t?t:{}}}),V0=pS.extend({implicit:[_S,vS],explicit:[yS,bS,CS,wS]}),Js=Object.prototype.hasOwnProperty,$f=1,ES=2,TS=3,Wf=4,j0=1,xU=2,xS=3,DU=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,SU=/[\x85\u2028\u2029]/,MU=/[,\[\]\{\}]/,DS=/^(?:!|!!|![a-z\-]+!)$/i,SS=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function MS(t){return Object.prototype.toString.call(t)}function Uo(t){return 10===t||13===t}function Ua(t){return 9===t||32===t}function ur(t){return 9===t||32===t||10===t||13===t}function ac(t){return 44===t||91===t||93===t||123===t||125===t}function kU(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function IU(t){return 120===t?2:117===t?4:85===t?8:0}function OU(t){return 48<=t&&t<=57?t-48:-1}function kS(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function AU(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var IS=new Array(256),OS=new Array(256),lc=0;lc<256;lc++)IS[lc]=kS(lc)?1:0,OS[lc]=kS(lc);function PU(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||V0,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function AS(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=Lz(e),new Xi(n,e)}function ot(t,n){throw AS(t,n)}function Zf(t,n){t.onWarning&&t.onWarning.call(null,AS(t,n))}var PS={YAML:function(n,e,i){var r,o,s;null!==n.version&&ot(n,"duplication of %YAML directive"),1!==i.length&&ot(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&ot(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&ot(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Zf(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&ot(n,"TAG directive accepts exactly two arguments"),o=i[1],DS.test(r=i[0])||ot(n,"ill-formed tag handle (first argument) of the TAG directive"),Js.call(n.tagMap,r)&&ot(n,'there is a previously declared suffix for "'+r+'" tag handle'),SS.test(o)||ot(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{ot(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function ea(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||ot(t,"expected valid JSON character");else DU.test(a)&&ot(t,"the stream contains non-printable characters");t.result+=a}}function FS(t,n,e,i){var r,o,s,a;for(ci.isObject(e)||ot(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)Js.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function cc(t,n,e,i,r,o,s,a,l){var c,u;if(Array.isArray(r))for(c=0,u=(r=Array.prototype.slice.call(r)).length;c<u;c+=1)Array.isArray(r[c])&&ot(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===MS(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===MS(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)FS(t,n,o[c],e);else FS(t,n,o,e);else!t.json&&!Js.call(e,r)&&Js.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,ot(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function H0(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):ot(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function ei(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Ua(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Uo(r))break;for(H0(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Zf(t,"deficient indentation"),i}function Yf(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!ur(e)))}function G0(t,n){1===n?t.result+=" ":n>1&&(t.result+=ci.repeat("\n",n-1))}function NS(t,n){var e,l,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);0!==l&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,ot(t,"tab characters must not be used in indentation")),45===l&&ur(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,ei(t,!0,-1)&&t.lineIndent<=n)o.push(null),l=t.input.charCodeAt(t.position);else if(e=t.line,uc(t,n,TS,!1,!0),o.push(t.result),ei(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==l)ot(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function UU(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&ot(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):ot(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!ur(s);)33===s&&(i?ot(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),DS.test(r)||ot(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),MU.test(o)&&ot(t,"tag suffix cannot contain flow indicator characters")}o&&!SS.test(o)&&ot(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{ot(t,"tag name is malformed: "+o)}return e?t.tag=o:Js.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:ot(t,'undeclared tag handle "'+r+'"'),!0}function VU(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&ot(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!ur(e)&&!ac(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&ot(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function uc(t,n,e,i,r){var o,s,a,h,g,E,L,Z,re,l=1,c=!1,u=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=Wf===e||TS===e,i&&ei(t,!0,-1)&&(c=!0,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)),1===l)for(;UU(t)||VU(t);)ei(t,!0,-1)?(c=!0,a=o,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=c||r),(1===l||Wf===e)&&(Z=$f===e||ES===e?n:n+1,re=t.position-t.lineStart,1===l?a&&(NS(t,re)||function zU(t,n,e){var i,r,o,s,a,l,ce,c=t.tag,u=t.anchor,h={},g=Object.create(null),E=null,L=null,Z=null,re=!1,oe=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=h),ce=t.input.charCodeAt(t.position);0!==ce;){if(!re&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,ot(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==ce&&58!==ce||!ur(i)){if(s=t.line,a=t.lineStart,l=t.position,!uc(t,e,ES,!1,!0))break;if(t.line===o){for(ce=t.input.charCodeAt(t.position);Ua(ce);)ce=t.input.charCodeAt(++t.position);if(58===ce)ur(ce=t.input.charCodeAt(++t.position))||ot(t,"a whitespace character is expected after the key-value separator within a block mapping"),re&&(cc(t,h,g,E,L,null,s,a,l),E=L=Z=null),oe=!0,re=!1,r=!1,E=t.tag,L=t.result;else{if(!oe)return t.tag=c,t.anchor=u,!0;ot(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!oe)return t.tag=c,t.anchor=u,!0;ot(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===ce?(re&&(cc(t,h,g,E,L,null,s,a,l),E=L=Z=null),oe=!0,re=!0,r=!0):re?(re=!1,r=!0):ot(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,ce=i;if((t.line===o||t.lineIndent>n)&&(re&&(s=t.line,a=t.lineStart,l=t.position),uc(t,n,Wf,!0,r)&&(re?L=t.result:Z=t.result),re||(cc(t,h,g,E,L,Z,s,a,l),E=L=Z=null),ei(t,!0,-1),ce=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==ce)ot(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return re&&cc(t,h,g,E,L,null,s,a,l),oe&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=h),oe}(t,re,Z))||function LU(t,n){var i,r,o,a,u,h,g,E,Z,re,oe,ce,e=!0,s=t.tag,l=t.anchor,L=Object.create(null);if(91===(ce=t.input.charCodeAt(t.position)))u=93,E=!1,a=[];else{if(123!==ce)return!1;u=125,E=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),ce=t.input.charCodeAt(++t.position);0!==ce;){if(ei(t,!0,n),(ce=t.input.charCodeAt(t.position))===u)return t.position++,t.tag=s,t.anchor=l,t.kind=E?"mapping":"sequence",t.result=a,!0;e?44===ce&&ot(t,"expected the node content, but found ','"):ot(t,"missed comma between flow collection entries"),oe=null,h=g=!1,63===ce&&ur(t.input.charCodeAt(t.position+1))&&(h=g=!0,t.position++,ei(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,uc(t,n,$f,!1,!0),re=t.tag,Z=t.result,ei(t,!0,n),ce=t.input.charCodeAt(t.position),(g||t.line===i)&&58===ce&&(h=!0,ce=t.input.charCodeAt(++t.position),ei(t,!0,n),uc(t,n,$f,!1,!0),oe=t.result),E?cc(t,a,L,re,Z,oe,i,r,o):a.push(h?cc(t,null,L,re,Z,oe,i,r,o):Z),ei(t,!0,n),44===(ce=t.input.charCodeAt(t.position))?(e=!0,ce=t.input.charCodeAt(++t.position)):e=!1}ot(t,"unexpected end of the stream within a flow collection")}(t,Z)?u=!0:(s&&function BU(t,n){var e,i,u,h,r=j0,o=!1,s=!1,a=n,l=0,c=!1;if(124===(h=t.input.charCodeAt(t.position)))i=!1;else{if(62!==h)return!1;i=!0}for(t.kind="scalar",t.result="";0!==h;)if(43===(h=t.input.charCodeAt(++t.position))||45===h)j0===r?r=43===h?xS:xU:ot(t,"repeat of a chomping mode identifier");else{if(!((u=OU(h))>=0))break;0===u?ot(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?ot(t,"repeat of an indentation width identifier"):(a=n+u-1,s=!0)}if(Ua(h)){do{h=t.input.charCodeAt(++t.position)}while(Ua(h));if(35===h)do{h=t.input.charCodeAt(++t.position)}while(!Uo(h)&&0!==h)}for(;0!==h;){for(H0(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===h;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Uo(h))l++;else{if(t.lineIndent<a){r===xS?t.result+=ci.repeat("\n",o?1+l:l):r===j0&&o&&(t.result+="\n");break}for(i?Ua(h)?(c=!0,t.result+=ci.repeat("\n",o?1+l:l)):c?(c=!1,t.result+=ci.repeat("\n",l+1)):0===l?o&&(t.result+=" "):t.result+=ci.repeat("\n",l):t.result+=ci.repeat("\n",o?1+l:l),o=!0,s=!0,l=0,e=t.position;!Uo(h)&&0!==h;)h=t.input.charCodeAt(++t.position);ea(t,e,t.position,!1)}}return!0}(t,Z)||function NU(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(ea(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Uo(e)?(ea(t,i,r,!0),G0(t,ei(t,!1,n)),i=r=t.position):t.position===t.lineStart&&Yf(t)?ot(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);ot(t,"unexpected end of the stream within a single quoted scalar")}(t,Z)||function RU(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return ea(t,e,t.position,!0),t.position++,!0;if(92===a){if(ea(t,e,t.position,!0),Uo(a=t.input.charCodeAt(++t.position)))ei(t,!1,n);else if(a<256&&IS[a])t.result+=OS[a],t.position++;else if((s=IU(a))>0){for(r=s,o=0;r>0;r--)(s=kU(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:ot(t,"expected hexadecimal character");t.result+=AU(o),t.position++}else ot(t,"unknown escape sequence");e=i=t.position}else Uo(a)?(ea(t,e,i,!0),G0(t,ei(t,!1,n)),e=i=t.position):t.position===t.lineStart&&Yf(t)?ot(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}ot(t,"unexpected end of the stream within a double quoted scalar")}(t,Z)?u=!0:function jU(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!ur(i)&&!ac(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&ot(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Js.call(t.anchorMap,e)||ot(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],ei(t,!0,-1),!0}(t)?(u=!0,(null!==t.tag||null!==t.anchor)&&ot(t,"alias node should not have any properties")):function FU(t,n,e){var r,o,s,a,l,c,u,E,h=t.kind,g=t.result;if(ur(E=t.input.charCodeAt(t.position))||ac(E)||35===E||38===E||42===E||33===E||124===E||62===E||39===E||34===E||37===E||64===E||96===E||(63===E||45===E)&&(ur(r=t.input.charCodeAt(t.position+1))||e&&ac(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==E;){if(58===E){if(ur(r=t.input.charCodeAt(t.position+1))||e&&ac(r))break}else if(35===E){if(ur(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Yf(t)||e&&ac(E))break;if(Uo(E)){if(l=t.line,c=t.lineStart,u=t.lineIndent,ei(t,!1,-1),t.lineIndent>=n){a=!0,E=t.input.charCodeAt(t.position);continue}t.position=s,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(ea(t,o,s,!1),G0(t,t.line-l),o=s=t.position,a=!1),Ua(E)||(s=t.position+1),E=t.input.charCodeAt(++t.position)}return ea(t,o,s,!1),!!t.result||(t.kind=h,t.result=g,!1)}(t,Z,$f===e)&&(u=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===l&&(u=a&&NS(t,re))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&ot(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,g=t.implicitTypes.length;h<g;h+=1)if((L=t.implicitTypes[h]).resolve(t.result)){t.result=L.construct(t.result),t.tag=L.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Js.call(t.typeMap[t.kind||"fallback"],t.tag))L=t.typeMap[t.kind||"fallback"][t.tag];else for(L=null,h=0,g=(E=t.typeMap.multi[t.kind||"fallback"]).length;h<g;h+=1)if(t.tag.slice(0,E[h].tag.length)===E[h].tag){L=E[h];break}L||ot(t,"unknown tag !<"+t.tag+">"),null!==t.result&&L.kind!==t.kind&&ot(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+L.kind+'", not "'+t.kind+'"'),L.resolve(t.result,t.tag)?(t.result=L.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):ot(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||u}function HU(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(ei(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!ur(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&ot(t,"directive name must not be less than one character in length");0!==s;){for(;Ua(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Uo(s));break}if(Uo(s))break;for(e=t.position;0!==s&&!ur(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&H0(t),Js.call(PS,i)?PS[i](t,i,r):Zf(t,'unknown document directive "'+i+'"')}ei(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,ei(t,!0,-1)):o&&ot(t,"directives end mark is expected"),uc(t,t.lineIndent-1,Wf,!1,!0),ei(t,!0,-1),t.checkLineBreaks&&SU.test(t.input.slice(n,t.position))&&Zf(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Yf(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,ei(t,!0,-1)):t.position<t.length-1&&ot(t,"end of the stream or a document separator is expected")}function RS(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new PU(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,ot(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)HU(e);return e.documents}var LS_load=function $U(t,n){var e=RS(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Xi("expected a single document in the stream, but found more")}};function K0(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var iM=LS_load;K0("safeLoad","load"),K0("safeLoadAll","loadAll"),K0("safeDump","dump");const rM=Object.getOwnPropertyNames(Object.prototype),HV=Object.getOwnPropertyNames(Array.prototype);let X0=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,Mt.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=iM(i);t.applyConfig(r)}catch(i){console.warn(i)}pe.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,Mt.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?rM.concat(HV):rM).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();var Q0;!function(t){t.resize=function n(e,i,r,o){let s=e.width,a=e.height,l=s/(i=Math.round(i)),c=a/(r=Math.round(r)),u=Math.ceil(l/2),h=Math.ceil(c/2),g=e.getContext("2d"),E=g.getImageData(0,0,s,a),L=g.createImageData(i,r),Z=E.data,re=L.data;for(let oe=0;oe<r;oe++)for(let ce=0;ce<i;ce++){let ue=4*(ce+oe*i),be=0,Ke=0,ft=0,Xe=0,Bt=0,Tt=0,lt=0,zt=(oe+.5)*c,Qi=Math.floor(oe*c),Kr=Math.ceil((oe+1)*c);for(let Xr=Qi;Xr<Kr;Xr++){let Jo=Math.abs(zt-(Xr+.5))/h,tt=(ce+.5)*l,ht=Jo*Jo,_t=Math.floor(ce*l),Qt=Math.ceil((ce+1)*l);for(let Nn=_t;Nn<Qt;Nn++){let Ir=Math.abs(tt-(Nn+.5))/u,ri=Math.sqrt(ht+Ir*Ir);if(ri>=1)continue;be=2*ri*ri*ri-3*ri*ri+1;let Ji=4*(Nn+Xr*s);lt+=be*Z[Ji+3],ft+=be,Z[Ji+3]<255&&(be=be*Z[Ji+3]/250),Xe+=be*Z[Ji],Bt+=be*Z[Ji+1],Tt+=be*Z[Ji+2],Ke+=be}}re[ue]=Xe/Ke,re[ue+1]=Bt/Ke,re[ue+2]=Tt/Ke,re[ue+3]=lt/ft}!0===o?(e.width=i,e.height=r):g.clearRect(0,0,s,a),g.putImageData(L,0,0)}}(Q0||(Q0={}));var mo,GV=Y(7412);!function(t){function r(){return r=(0,Mt.Z)(function*(l){return l instanceof Blob?function o(l){return s.apply(this,arguments)}(l):a(l)}),r.apply(this,arguments)}function s(){return(s=(0,Mt.Z)(function*(l){return a(yield t.readAsArrayBufferAsync(l))})).apply(this,arguments)}function a(l){let c=GV.create(l);return e0(c).toString()}t.readAsArrayBufferAsync=function n(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsArrayBuffer(l)})},t.readAsTextAsync=function e(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsText(l)})},t.calcSHA256Async=function i(l){return r.apply(this,arguments)}}(mo||(mo={}));var Ei=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Ei||(Ei={})),Ei))();class en{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Ei.URL:this.blob===this.thumbnail.blob?Ei.THUMBNAIL:Ei.COMPLETE:Ei.NULL}get isEmpty(){return this.state<=Ei.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}static createEmpty(n){let e=new en;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new en;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new en;return e.apply(n),e}}static createAsync(n){return(0,Mt.Z)(function*(){return n instanceof File?yield en._createAsync(n,n.name):n instanceof Blob?yield en._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Mt.Z)(function*(){let i=yield mo.readAsArrayBufferAsync(n),r=new en;r.context.identifier=yield mo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield en.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Ei.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Ei.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,l=r.height*s,c=document.createElement("canvas"),u=c.getContext("2d");c.width=r.width,c.height=r.height,u.drawImage(r,0,0),Q0.resize(c,a,l,!0),c.toBlob(h=>{let g={type:h.type,blob:h,url:window.URL.createObjectURL(h)};e(g)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}en.Empty=en.createEmpty("null");class Et{static get instance(){return Et._instance||(Et._instance=new Et),Et._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}constructor(){this.imageHash={},console.log("ImageStorage ready...")}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,Mt.Z)(function*(){let i=yield en.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=en.create(n);else if(n instanceof en)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=en.create(n)}return this._add(e)}_add(n){return Ei.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof en?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),pe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Bo(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Ei.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}class Vo{static get instance(){return Vo._instance||(Vo._instance=new Vo),Vo._instance}constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}const oM=Symbol("synchronize-variables"),sM=Symbol("synchronize-attributes");function aM(t){return n=>{const e=class extends n{constructor(...r){super(...r),this.constructor===e&&function WV(t){cM(t,oM,n=>function(){return this.context.syncData[n]},n=>function(i){this.context.syncData[n]=i,this.update()}),cM(t,sM,n=>function(){return this.context.syncData.attributes[n]},n=>function(i){this.context.syncData.attributes[n]=i,this.update()})}(this)}};return Vo.instance.register(e,t),e}}function hc(){return(t,n)=>{lM(t,oM,n)}}function lM(t,n,e){t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:new Set}),t[n].add(e)}function cM(t,n,e,i){const r=new Set;let o=t;for(;o;){const s=o[n];if(null!=s&&o.hasOwnProperty(n))for(const a of s){if(r.has(a))continue;r.add(a);const l=t[a];Object.defineProperty(t,a,{get:e(a),set:i(a),enumerable:!0,configurable:!0}),void 0!==l&&(t[a]=l)}o=Object.getPrototypeOf(o)}}var Ts;!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function u(g){return e[g]}function h(g){return r[g]}t.xml2element=function s(g){let E=new DOMParser,L=null;try{g=function c(g){return g.replace(o,"").trim()}(g),L=E.parseFromString(g,"application/xml"),L.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",L.documentElement),L=null)}catch(Z){console.error(Z)}return L?L.documentElement:null},t.encodeEntityReference=function a(g){return g.replace(n,u)},t.decodeEntityReference=function l(g){return g.replace(i,h)}}(Ts||(Ts={}));const ZV=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class xn{static get instance(){return xn._instance||(xn._instance=new xn),xn._instance}constructor(){console.log("ObjectSerializer ready...")}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():xn.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i)void 0!==i[s]&&(o+=" "+s+'="'+Ts.encodeEntityReference(i[s]+"")+'"');return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=xn.make2Attributes(n[i],i);for(let a in s)void 0!==s[a]&&(e[a]=s[a])}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=xn.array2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else if("object"==typeof n){let r=xn.object2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else void 0!==n&&(i[e]=n);return i}static object2attributes(n,e){let i={};for(let r in n){let a=xn.make2Attributes(n[r],e+"."+r);for(let l in a)void 0!==a[l]&&(i[l]=a[l])}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let l=xn.make2Attributes(n[o],e+"."+o);for(let c in l)void 0!==l[c]&&(i[c]=l[c])}return i}parseXml(n){let e=null;if(e="string"==typeof n?Ts.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Vo.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();xn.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Ts.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],l=n,c=s.find(h=>ZV.includes(h));null==c?1<s.length&&(({obj:l,key:a}=xn.attributes2object(s,l,a)),null==a)||("string"!=typeof l[a]&&null!=l[a]&&(o=JSON.parse(o)),l[a]=o):console.log(`skip invalid key (${c})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class Be{static get instance(){return Be._instance||(Be._instance=new Be),Be._instance}constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&pe.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}pe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Ri(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;o.value[1]+n<e||this.garbageMap.delete(o.value[0])}}}class ta{static get aliasName(){return Vo.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}constructor(n=td.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}initialize(){Be.instance.add(this)}destroy(){Be.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Be.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return xn.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:uM(this.context.syncData)}}toXml(){return xn.instance.toXml(this)}}function uM(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=uM(t[i]):"function"!==r&&(n[i]=t[i])}return n}const J0=new Map,ev=new Set;let tv=!1;function dM(t,n=We.peerId){J0.set(t.identifier,{object:t,originFrom:n}),t instanceof Ti&&nv(t.parent),hM()}function nv(t){let n=t;for(;n&&(ev.add(n.identifier),n=n.parent,n!==t););hM()}function hM(){tv||(queueMicrotask(YV),tv=!0)}const YV=()=>{tv=!1;let t=Array.from(J0.values()),n=Array.from(ev.values());J0.clear(),ev.clear();for(let e of t){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};pe.trigger(new sc(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),pe.trigger(new sc(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of n)pe.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};var iv;const Va={};let Ti=iv=class extends ta{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Be.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Be.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Be.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){nv(this);let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){nv(this);let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==Va[this.identifier])return;let n=Va[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Va[this.identifier]&&delete Va[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return xn.toAttributes(this.attributes)}parseAttributes(n){xn.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=Ts.encodeEntityReference(this.value+"");for(let e of this.children)n+=xn.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=xn.instance.parseXml(e[r]);o instanceof iv&&this.appendChild(o)}else this.value=Ts.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Va||(Va[this.parentIdentifier]=[]),Va[this.parentIdentifier].push(this))}};function Zn(t){return n=>aM(t)(n)}function st(){return(t,n)=>{t instanceof Ti?function $V(){return(t,n)=>{lM(t,sM,n)}}()(t,n):hc()(t,n)}}X([hc()],Ti.prototype,"value",void 0),X([hc()],Ti.prototype,"attributes",void 0),X([hc()],Ti.prototype,"parentIdentifier",void 0),X([hc()],Ti.prototype,"majorIndex",void 0),X([hc()],Ti.prototype,"minorIndex",void 0),Ti=iv=X([aM("node")],Ti);let dr=class extends Ti{constructor(){super(...arguments),this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Et.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===We.peer.userId||this.originFrom===We.peer.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(We.peer.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}};X([st()],dr.prototype,"originFrom",void 0),X([st()],dr.prototype,"from",void 0),X([st()],dr.prototype,"to",void 0),X([st()],dr.prototype,"name",void 0),X([st()],dr.prototype,"tag",void 0),X([st()],dr.prototype,"dicebot",void 0),X([st()],dr.prototype,"imageIdentifier",void 0),dr=X([Zn("chat")],dr);let fc=class extends Ti{constructor(){super(...arguments),this.name="\u30bf\u30d6",this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof dr&&n.isDisplayable&&(this._unreadLength++,pe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new dr;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),pe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof dr&&!e.isDisplayable||(n+=xn.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}};var Zr;X([st()],fc.prototype,"name",void 0),fc=X([Zn("chat-tab")],fc);let jo=Zr=class extends Ti{static get instance(){return Zr._instance||(Zr._instance=new Zr("ChatTabList"),Zr._instance.initialize()),Zr._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof fc)e=n[0];else{let i=n[0];e=new fc(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Zr.instance.children)i.destroy();let e=Zr.instance.toContext();e.syncData=this.toContext().syncData,Zr.instance.apply(e),Zr.instance.update(),super.parseInnerXml.apply(Zr.instance,[n]),this.destroy()}};jo=Zr=X([Zn("chat-tab-list")],jo);var xs,_o=(()=>(function(t){t[t.None=0]="None",t[t.IgnoreCase=1]="IgnoreCase",t[t.IgnoreWidth=2]="IgnoreWidth"}(_o||(_o={})),_o))();!function(t){function n(r){return r.replace(/[\uff01-\uff5e]/g,o=>String.fromCharCode(o.charCodeAt(0)-65248))}function i(r,o){if(o===_o.None)return r;let s=r;return o&_o.IgnoreCase&&(s=s.toLocaleLowerCase()),o&_o.IgnoreWidth&&(s=n(s)),s}t.toHalfWidth=n,t.equals=function e(r,o,s=_o.None){return r.length===o.length&&(r===o||i(r,s)===i(o,s))},t.normalize=i}(xs||(xs={}));let ad=class extends Ti{constructor(){super(...arguments),this.dicebot="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let o=0,s=!0;for(;s;)o++,s=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,l)=>{l=xs.toHalfWidth(l),console.log(l),s=!0;for(let c of this.paletteVariables)if(c.name==l)return c.value;if(e){let c=e.getFirstElementByName(l,_o.IgnoreWidth);if(c)return c.isNumberResource?c.currentValue+"":c.value+""}return""}),128<o&&(s=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:xs.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var ja;X([st()],ad.prototype,"dicebot",void 0),ad=X([Zn("chat-palette")],ad);let rt=ja=class extends Ti{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new ja(r):new ja,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}getElementsByName(n,e=_o.None){let i=[];for(let r of this.children)r instanceof ja&&(xs.equals(r.getAttribute("name"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByName(n,e)));return i}getElementsByType(n,e=_o.None){let i=[];for(let r of this.children)r instanceof ja&&(xs.equals(r.getAttribute("type"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByType(n,e)));return i}getFirstElementByName(n,e=_o.None){for(let i of this.children)if(i instanceof ja){if(xs.equals(i.getAttribute("name"),n,e))return i;let r=i.getFirstElementByName(n,e);if(r)return r}return null}};var on;X([st()],rt.prototype,"name",void 0),X([st()],rt.prototype,"type",void 0),X([st()],rt.prototype,"currentValue",void 0),rt=ja=X([Zn("data")],rt),function(t){t.sqrMagnitude=function n(s,a={x:0,y:0,z:0}){return(s.x-a.x)**2+(s.y-a.y)**2+((s.z??0)-(a.z??0))**2},t.clampMin=function e(s,a=0){return s<a?a:s},t.clampMax=function i(s,a=100){return s<a?s:a},t.radians=function r(s){return s*Math.PI/180},t.degrees=function o(s){return 180*s/Math.PI}}(on||(on={}));let hr=class extends Ti{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=en.Empty,this._dataElements={}}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageDataElement.getFirstElementByName("imageIdentifier");if(n&&this._imageFile.identifier!==n.value){let e=Et.instance.get(n.value);this._imageFile=e||en.Empty}return this._imageFile}calcSqrDistance(n){return on.sqrMagnitude({x:this.location.x,y:this.location.y,z:this.posZ},{x:n.location.x,y:n.location.y,z:n.posZ})}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=rt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(rt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(rt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(rt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(rt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?Be.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);i&&(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Et.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;i&&(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};var rv;X([st()],hr.prototype,"location",void 0),X([st()],hr.prototype,"posZ",void 0),hr=X([Zn("TabletopObject")],hr);let Dn=rv=class extends hr{constructor(){super(...arguments),this.rotate=0,this.roll=0}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let n of this.children)if(n instanceof ad)return n;return null}static create(n,e,i){let r=new rv;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}createTestGameDataElement(n,e,i){this.createDataElements();let r=rt.create("name",n,{},"name_"+this.identifier),o=rt.create("size",e,{},"size_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let s=rt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),a=rt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=rt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.detailDataElement.appendChild(s),s.appendChild(a),s.appendChild(l);let c=rt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(rt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(rt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c=rt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(rt.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(rt.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(rt.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),c.appendChild(rt.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(rt.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),c.appendChild(rt.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),c=rt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(rt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(rt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(rt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(rt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(rt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(rt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let g=new ad("ChatPalette_"+this.identifier);g.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),g.initialize(),this.appendChild(g)}};var ld,jn;X([st()],Dn.prototype,"rotate",void 0),X([st()],Dn.prototype,"roll",void 0),Dn=rv=X([Zn("character")],Dn);let Rt=((ld=class extends ta{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier=""}get isMine(){return jn.myCursor&&jn.myCursor===this}get image(){return Et.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||pe.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{We.peerIds.includes(this.peerId)||(jn.userIdMap.delete(this.userId),jn.peerIdMap.delete(this.peerId),Be.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),pe.unregister(this),jn.userIdMap.delete(this.userId),jn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(jn.userIdMap,n,!0)}static findByPeerId(n){return this.find(jn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&Be.instance.get(r))return Be.instance.get(r);let o=Be.instance.getObjects(jn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return jn.myCursor?(console.warn("It is already created."),jn.myCursor):(jn.myCursor=new jn,jn.myCursor.peerId=We.peerId,jn.myCursor.initialize(),jn.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(jn.userIdMap.set(e,this.identifier),jn.userIdMap.delete(this.userId)),i!==this.peerId&&(jn.peerIdMap.set(i,this.identifier),jn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}}).myCursor=null,ld.userIdMap=new Map,ld.peerIdMap=new Map,jn=ld);X([st()],Rt.prototype,"userId",void 0),X([st()],Rt.prototype,"peerId",void 0),X([st()],Rt.prototype,"name",void 0),X([st()],Rt.prototype,"imageIdentifier",void 0),Rt=jn=X([Zn("PeerCursor")],Rt);let Ha=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return jo.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,c=new Date(o.utc_datetime).getTime();this.timeOffset=c+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+c),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s){let a={from:We.peer.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o),timestamp:this.calcTimeStamp(e),tag:r,text:i};return e.addMessage(a)}findId(e){let i=Be.instance.get(e);return i instanceof Dn?i.identifier:i instanceof Rt?i.userId:null}findObjectName(e){let i=Be.instance.get(e);return i instanceof Dn||i instanceof Rt?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}findImageIdentifier(e){let i=Be.instance.get(e);return i instanceof Dn?i.imageFile?i.imageFile.identifier:"":i instanceof Rt?i.imageIdentifier:e}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();var Xf=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(Xf||(Xf={})),Xf))();const gn={name:"",enabled:!0,type:Xf.SEPARATOR};let fr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0}}get isShow(){return!!this.panelComponentRef}open(e,i,r,o){this.close(),o||(o=t.defaultParentViewContainerRef);let a=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const l=a.injector.get(t);l.panelComponentRef=a,i&&(l.actions=i),e&&(l.position.x=e.x,l.position.y=e.y),l.title=r??"",a.onDestroy(()=>{l.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();var Ho,cd=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(cd||(cd={})),cd))();let Go=Ho=class extends ta{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=cd.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return Ho._instance||(Ho._instance=new Ho("DataSummarySetting"),Ho._instance.initialize()),Ho._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=Ho.instance.toContext();e.syncData=this.toContext().syncData,Ho.instance.apply(e),Ho.instance.update(),this.destroy()}};X([st()],Go.prototype,"sortTag",void 0),X([st()],Go.prototype,"sortOrder",void 0),X([st()],Go.prototype,"dataTag",void 0),Go=Ho=X([Zn("summary-setting")],Go);let ov=(()=>{class t{get summarySetting(){return Go.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}constructor(){this.tableInventory=new Qf(e=>"table"===e.location.name),this.commonInventory=new Qf(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new Qf(e=>e.location.name===We.peerId),this.graveyardInventory=new Qf(e=>"graveyard"===e.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=rt.create(this.newLineString),this.initialize()}initialize(){pe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Be.instance.get(e.data.identifier);if(i)if(i instanceof Dn){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof rt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof Go&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Dn.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){pe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===We.peerId||"graveyard"===e)return!0;for(let i of We.peers)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Qf{get summarySetting(){return Go.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=rt.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=Be.instance.getObjects(Dn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByName(e),a=o.rootDataElement?.getFirstElementByName(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let l=this.convertToSortableValue(s),c=this.convertToSortableValue(a);return l<c?i:l>c?-1*i:0}),n}convertToSortableValue(n){let i=xs.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}class KV{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Bi=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){return r||(r=t.defaultParentViewContainerRef),new Promise((o,s)=>{const c=new t;c.modalContext=new KV(re=>{g&&(g.destroy(),o(re),this.count--)},re=>{g&&(g.destroy(),s(re),this.count--)},i);const h=So.create({providers:[{provide:t,useValue:c}],parent:r.injector});let g=r.createComponent(t.ModalComponentClass,{index:r.length,injector:h}),E=g.instance.content.createComponent(e);g.onDestroy(()=>{g=null,this.count--}),E.onDestroy(()=>{E=null,this.count--}),this.count++;let L=g.instance,Z=E.instance;(null!=L?.ngOnChanges||null!=Z?.ngOnChanges)&&queueMicrotask(()=>{E&&Z?.ngOnChanges({}),g&&L?.ngOnChanges({})})})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})(),hn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){r||(r=t.defaultParentViewContainerRef);let s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector}),a=s.instance.content.createComponent(e);const l=s.injector.get(t);l.panelComponentRef=s,i&&(i.title&&(l.title=i.title),i.top&&(l.top=i.top),i.left&&(l.left=i.left),i.width&&(l.width=i.width),i.height&&(l.height=i.height)),s.onDestroy(()=>{l.panelComponentRef=null,s=null}),a.onDestroy(()=>{a=null});let c=s.instance,u=a.instance;return(null!=c?.ngOnChanges||null!=u?.ngOnChanges)&&queueMicrotask(()=>{a&&null!=u?.ngOnChanges&&u?.ngOnChanges({}),s&&null!=c?.ngOnChanges&&c?.ngOnChanges({})}),a.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})(),ti=(()=>{class t{get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>{this._isDragging=e,document.body.dispatchEvent(new CustomEvent("draggingstate",{detail:e,bubbles:!0}))})}constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1,this.isTablePickGesture=!1}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i,3),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s,12),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<on.sqrMagnitude(e,this.startPostion)&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&on.sqrMagnitude(e,r)<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function sv(t,n=[]){let e=pM(t.aliasName,n),i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function fM(t,n=[]){let e=pM(t.aliasName,n),i=Number.MAX_SAFE_INTEGER,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:e[o].zindex<i&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i-1,!(0<=t.zindex))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function pM(t,n){let e=Be.instance.getObjects(t);return n.forEach(i=>e=e.concat(Be.instance.getObjects(i))),e=e.filter(i=>i.isVisibleOnTable),e}var Jf,Ds=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(Ds||(Ds={})),Ds))();let pr=Jf=class extends hr{constructor(){super(...arguments),this.state=Ds.FRONT,this.rotate=0,this.owner="",this.zindex=0}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isHand||We.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isHand(){return We.peer.userId===this.owner}get isFront(){return this.state===Ds.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=Ds.FRONT,this.owner=""}faceDown(){this.state=Ds.BACK,this.owner=""}toTopmost(){sv(this,["card-stack"])}toBackmost(){fM(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new Jf(o):new Jf,s.createDataElements(),s.commonDataElement.appendChild(rt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(rt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(rt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(rt.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var ep;X([st()],pr.prototype,"state",void 0),X([st()],pr.prototype,"rotate",void 0),X([st()],pr.prototype,"owner",void 0),X([st()],pr.prototype,"zindex",void 0),pr=Jf=X([Zn("card")],pr);let pi=ep=class extends hr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){sv(this,["card"])}toBackmost(){fM(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new ep(e):new ep,i.createDataElements(),i.commonDataElement.appendChild(rt.create("name",n,{},"name_"+i.identifier));let r=new Ti("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};X([st()],pi.prototype,"rotate",void 0),X([st()],pi.prototype,"zindex",void 0),X([st()],pi.prototype,"owner",void 0),X([st()],pi.prototype,"isShowTotal",void 0),pi=ep=X([Zn("card-stack")],pi);var tp,gi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(gi||(gi={})),gi))();let $o=tp=class extends hr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement.children.map(n=>n.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isMine||We.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isMine(){return We.peer.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case gi.D2:i=2;break;case gi.D4:i=4;break;case gi.D6:i=6;break;case gi.D8:i=8;break;case gi.D10_10TIMES:o=s=>s+1+"0";case gi.D10:i=10;break;case gi.D12:i=12;break;case gi.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(rt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(n,e,i,r){let o=r?new tp(r):new tp;return o.createDataElements(),o.commonDataElement.appendChild(rt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(rt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var np;X([st()],$o.prototype,"face",void 0),X([st()],$o.prototype,"owner",void 0),X([st()],$o.prototype,"rotate",void 0),$o=tp=X([Zn("dice-symbol")],$o);let Wo=np=class extends hr{constructor(){super(...arguments),this.isLock=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}static create(n,e,i,r,o){let s=null;return s=o?new np(o):new np,s.createDataElements(),s.commonDataElement.appendChild(rt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(rt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(rt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(rt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};X([st()],Wo.prototype,"isLock",void 0),Wo=np=X([Zn("table-mask")],Wo);var ip,na=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(na||(na={})),na))();let Yr=ip=class extends hr{constructor(){super(...arguments),this.isLocked=!1,this.mode=na.ALL,this.rotate=0}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&na.WALL)}get hasFloor(){return!!(this.mode&na.FLOOR)}static create(n,e,i,r,o,s,a){let l=null;return l=a?new ip(a):new ip,l.createDataElements(),l.commonDataElement.appendChild(rt.create("name",n,{},"name_"+l.identifier)),l.commonDataElement.appendChild(rt.create("width",e,{},"width_"+l.identifier)),l.commonDataElement.appendChild(rt.create("height",r,{},"height_"+l.identifier)),l.commonDataElement.appendChild(rt.create("depth",i,{},"depth_"+l.identifier)),l.imageDataElement.appendChild(rt.create("wall",o,{type:"image"},"wall_"+l.identifier)),l.imageDataElement.appendChild(rt.create("floor",s,{type:"image"},"floor_"+l.identifier)),l.initialize(),l}};X([st()],Yr.prototype,"isLocked",void 0),X([st()],Yr.prototype,"mode",void 0),X([st()],Yr.prototype,"rotate",void 0),Yr=ip=X([Zn("terrain")],Yr);var Ss=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(Ss||(Ss={})),Ss))(),rp=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(rp||(rp={})),rp))();let ui=class extends Ti{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=rp.NONE,this.selected=!1,this.gridType=Ss.SQUARE,this.gridColor="#000000e6"}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof Yr&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Wo&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&pe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};X([st()],ui.prototype,"name",void 0),X([st()],ui.prototype,"width",void 0),X([st()],ui.prototype,"height",void 0),X([st()],ui.prototype,"gridSize",void 0),X([st()],ui.prototype,"imageIdentifier",void 0),X([st()],ui.prototype,"backgroundImageIdentifier",void 0),X([st()],ui.prototype,"backgroundFilterType",void 0),X([st()],ui.prototype,"selected",void 0),X([st()],ui.prototype,"gridType",void 0),X([st()],ui.prototype,"gridColor",void 0),ui=X([Zn("game-table")],ui);var zi=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(zi||(zi={})),zi))();class Mr{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return zi.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?zi.URL:zi.COMPLETE:zi.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}static createEmpty(n){let e=new Mr;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Mr;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Mr;return e.apply(n),e}}static createAsync(n){return(0,Mt.Z)(function*(){return n instanceof File?yield Mr._createAsync(n,n.name):n instanceof Blob?yield Mr._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Mt.Z)(function*(){let i=yield mo.readAsArrayBufferAsync(n),r=new Mr;return r.context.identifier=yield mo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),this.createURLs()}createURLs(){this.state!==zi.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==zi.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Ga,pc=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION"}(pc||(pc={})),pc))();class it{static get audioContext(){return it._audioContext||(it._audioContext=new(window.AudioContext||window.webkitAudioContext)),it._audioContext}static get volume(){return it._volume}static set volume(n){it._volume=n,it.masterGainNode.gain.setTargetAtTime(it._volume,it.audioContext.currentTime,.01)}static get auditionVolume(){return it._auditionVolume}static set auditionVolume(n){it._auditionVolume=n,it.auditionGainNode.gain.setTargetAtTime(it._auditionVolume,it.audioContext.currentTime,.01)}static get masterGainNode(){if(!it._masterGainNode){let n=it.audioContext.createGain();n.gain.setValueAtTime(it._volume,it.audioContext.currentTime),n.connect(it.audioContext.destination),it._masterGainNode=n}return it._masterGainNode}static get auditionGainNode(){if(!it._auditionGainNode){let n=it.audioContext.createGain();n.gain.setValueAtTime(it._auditionVolume,it.audioContext.currentTime),n.connect(it.audioContext.destination),it._auditionGainNode=n}return it._auditionGainNode}static get rootNode(){return it.masterGainNode}static get auditionNode(){return it.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=it.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}constructor(n){this.volumeType=pc.MASTER,this.audio=n}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===zi.URL&&(it.cacheMap.has(n.identifier)?e=it.cacheMap.get(n.identifier).url:it.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===pc.AUDITION?it.auditionNode:it.rootNode}static playBufferAsync(n,e=1){return(0,Mt.Z)(function*(){let i=yield it.createBufferSourceAsync(n);if(!i)return;let r=it.audioContext.createGain();r.gain.setValueAtTime(e,it.audioContext.currentTime),r.connect(it.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,Mt.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===zi.URL)if(it.cacheMap.has(n.identifier))i=it.cacheMap.get(n.identifier).blob;else{let s=yield it.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=it.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,Mt.Z)(function*(i,r){it.audioContext.decodeAudioData(yield mo.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,Mt.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,Mt.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield it.getBlobAsync(n)}catch(i){return console.error(i),e}return it.cacheMap.has(n.identifier)?it.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),it.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){it.audioContext.resume();let n=()=>{it.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}it._volume=.5,it._auditionVolume=.5,it.cacheMap=new Map;class at{static get instance(){return at._instance||(at._instance=new at),at._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}constructor(){this.hash={},console.log("AudioStorage ready...")}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,Mt.Z)(function*(){let i=yield Mr.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Mr.create(n);else if(n instanceof Mr)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Mr.create(n)}return this._add(e)}_add(n){return zi.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Mr?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),pe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Bo(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of at.instance.audios)zi.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let Ee=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.selectionStart="",t})(),Re=Ga=class extends ta{onStoreAdded(){super.onStoreAdded(),pe.register(this).on("SOUND_EFFECT",n=>{it.play(at.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=Be.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?Ga.play(Ee.diceRoll1):Ga.play(Ee.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),pe.unregister(this)}play(n){Ga.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,Ga._play(e)}static _play(n){pe.call("SOUND_EFFECT",n)}static playLocal(n){let e="";e="string"==typeof n?n:n.identifier,Ga._playLocal(e)}static _playLocal(n){pe.trigger("SOUND_EFFECT",n)}};var $a;Re=Ga=X([Zn("sound-effect")],Re);let Ms=$a=class extends ta{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return $a._instance||($a._instance=new $a("TableSelecter"),$a._instance.initialize()),$a._instance}onStoreAdded(){super.onStoreAdded(),pe.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),pe.unregister(this)}get viewTable(){let n=Be.instance.get(this.viewTableIdentifier);return n||(n=Be.instance.getObjects(ui)[0],n&&(this.viewTableIdentifier.length<1||Be.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,pe.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};var op;X([st()],Ms.prototype,"viewTableIdentifier",void 0),Ms=$a=X([Zn("TableSelecter")],Ms);let Zo=op=class extends hr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password=""}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}toTopmost(){sv(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new op(s):new op;return a.createDataElements(),a.commonDataElement.appendChild(rt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(rt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(rt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(rt.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(rt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};var Yn;X([st()],Zo.prototype,"rotate",void 0),X([st()],Zo.prototype,"zindex",void 0),X([st()],Zo.prototype,"password",void 0),Zo=op=X([Zn("text-note")],Zo),function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Yn||(Yn={}));class di{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new di){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,l=r+this.m32,c=o+this.m33,u=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==u&&(u=1e-4),a/=u,l/=u,c/=u;let h=c-o;if(0==h)return e.x=i,e.y=r,e.z=o,e.w=o,e;let g=-o/h;return i+=g*(a-i),r+=g*(l-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return di.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new di){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(di.makePosition(e,di.MATRIX3D))}static makePerspective(n,e=new di){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(di.makePerspective(n,di.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,l=this.m22,c=this.m23,u=this.m24,h=this.m31,g=this.m32,E=this.m33,L=this.m34,Z=this.m41,re=this.m42,oe=this.m43,ce=this.m44;e[0]=c*L*re-u*E*re+u*g*oe-l*L*oe-c*g*ce+l*E*ce,e[1]=s*E*re-o*L*re-s*g*oe+r*L*oe+o*g*ce-r*E*ce,e[2]=o*u*re-s*c*re+s*l*oe-r*u*oe-o*l*ce+r*c*ce,e[3]=s*c*g-o*u*g-s*l*E+r*u*E+o*l*L-r*c*L;let ue=i*e[0]+a*e[1]+h*e[2]+Z*e[3];return 0==ue?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=u*E*Z-c*L*Z-u*h*oe+a*L*oe+c*h*ce-a*E*ce,e[5]=o*L*Z-s*E*Z+s*h*oe-i*L*oe-o*h*ce+i*E*ce,e[6]=s*c*Z-o*u*Z-s*a*oe+i*u*oe+o*a*ce-i*c*ce,e[7]=o*u*h-s*c*h+s*a*E-i*u*E-o*a*L+i*c*L,e[8]=l*L*Z-u*g*Z+u*h*re-a*L*re-l*h*ce+a*g*ce,e[9]=s*g*Z-r*L*Z-s*h*re+i*L*re+r*h*ce-i*g*ce,e[10]=r*u*Z-s*l*Z+s*a*re-i*u*re-r*a*ce+i*l*ce,e[11]=s*l*h-r*u*h-s*a*g+i*u*g+r*a*L-i*l*L,e[12]=c*g*Z-l*E*Z-c*h*re+a*E*re+l*h*oe-a*g*oe,e[13]=r*E*Z-o*g*Z+o*h*re-i*E*re-r*h*oe+i*g*oe,e[14]=o*l*Z-r*c*Z-o*a*re+i*c*re+r*a*oe-i*l*oe,e[15]=r*c*h-o*l*h+o*a*g-i*c*g-r*a*E+i*l*E,n.setData(e),n.scalar(1/ue),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Yn.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(di.MATRIX3D.setCSS(n).flatten()):this.append(di.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new di){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,l=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,c=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,u=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,h=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,g=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,E=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,L=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Z=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,re=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,oe=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,ce=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,ue=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=l,i.m22=c,i.m23=u,i.m24=h,i.m31=g,i.m32=E,i.m33=L,i.m34=Z,i.m41=re,i.m42=oe,i.m43=ce,i.m44=ue,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}di.MATRIX3D=new di;class ud{constructor(n){this.matrix=new di,this.sceneTransform=new di,this.inverseSceneTransform=new di,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Yn.relation(e.paddingTop,i),this.paddingTop=Yn.relation(e.paddingTop,r),this.marginLeft=Yn.relation(e.marginLeft,i),this.marginTop=Yn.relation(e.marginTop,r),this.borderLeft=Yn.relation(e.borderLeft,i),this.borderTop=Yn.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new ud(r),a=di.multiply(this.sceneTransform,s.inverseSceneTransform),l={x:0,y:0,z:0,w:1};return l.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,l.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,l.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,l.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(l),l}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new di),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],l=Yn.relation(a[0],i.offsetWidth,.5*i.offsetWidth),c=Yn.relation(a[1],i.offsetHeight,.5*i.offsetHeight),u=Yn.relation(a[2],0,0);e.appendPosition(-l,-c,-u),e.appendCSS(r.transform),e.appendPosition(l,c,u)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Yn.parse(a.perspective)}if(n.parentElement&&s){let l=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),c=Yn.relation(l[0],i.parentElement.offsetWidth),u=Yn.relation(l[1],i.parentElement.offsetHeight);e.appendPosition(-c,-u,0),e.appendPerspective(s),e.appendPosition(c,u,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let Wa=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new ud(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new ud(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new ud(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(bt(ti))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),av=(()=>{class t{get tableSelecter(){return Ms.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Be.instance.getObjects(Rt)}constructor(e){this.coordinateService=e,this._emptyTable=new ui(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Za(()=>Be.instance.getObjects(Dn).filter(i=>i.isVisibleOnTable)),this.cardCache=new Za(()=>Be.instance.getObjects(pr).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Za(()=>Be.instance.getObjects(pi).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Za(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.terrainCache=new Za(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Za(()=>Be.instance.getObjects(Zo)),this.diceSymbolCache=new Za(()=>Be.instance.getObjects($o)),this.initialize()}initialize(){this.refreshCacheAll(),pe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Wo.aliasName),void this.refreshCache(Yr.aliasName);let i=Be.instance.get(e.data.identifier);i&&i instanceof hr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=xn.instance.parseXml(e.data.xmlElement);if(r instanceof hr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),Re.play(Ee.piecePut)}else r instanceof fc&&jo.instance.addChatTab(r)})}findCache(e){switch(e){case Dn.aliasName:return this.characterCache;case pr.aliasName:return this.cardCache;case pi.aliasName:return this.cardStackCache;case Wo.aliasName:return this.tableMaskCache;case Yr.aliasName:return this.terrainCache;case Zo.aliasName:return this.textNoteCache;case $o.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case Wo.aliasName:e instanceof Wo&&(e.isLock=!1);case Yr.aliasName:if(e instanceof Yr&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(bt(Wa))},t.\u0275prov=kt({token:t,factory:t.\u0275fac}),t})();class Za{get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}refresh(){this.needsRefresh=!0}}class Ya{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Ya(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Ya(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&pe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){pe.unregister(this),this.sendChankTimer&&function CB(t){Ru.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Sr.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),pe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Ri(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);pe.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Ri(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Ri(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,pe.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),pe.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=Sr.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Bo(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class gc{static get instance(){return gc._instance||(gc._instance=new gc),gc._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),pe.register(this).on("CONNECT_PEER",-1,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),at.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=at.instance.get(o.identifier);null===s&&(s=Mr.createEmpty(o.identifier),at.instance.add(s)),s.state<zi.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<at.instance.getCatalog().length&&at.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=at.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=at.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(We.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void pe.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),at.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=at.instance.get(e);this.receiveTaskMap.has(e)||i&&zi.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),pe.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){pe.unregister(this)}startSendTask(n,e){var i=this;return(0,Mt.Z)(function*(){let r=Ya.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),pe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===zi.URL?o.url=n.url:(o.blob=yield mo.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),at.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=at.instance.get(n),i=Ya.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&pe.trigger("UPDATE_AUDIO_RESOURE",[o]),at.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),pe.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:We.peerId,candidatePeers:We.peerIds},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}var mc,lv,dd,QV=Y(4327),gM=Y(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(mc||(mc={}));class Yo{static get instance(){return Yo._instance||(Yo._instance=new Yo),Yo._instance}constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,Mt.Z)(function*(){if(!n)return;let i=n instanceof FileList?_M(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),pe.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,Mt.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Et.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,Mt.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield at.instance.addAsync(n)}})()}handleText(n){return(0,Mt.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=Ts.xml2element(yield mo.readAsTextAsync(n));e&&pe.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,Mt.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new gM;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:mc.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,Mt.Z)(function*(){if(!n)return;let r=n instanceof FileList?_M(n):n,o=new gM;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,QV.saveAs)(s,e+".zip")})()}}function _M(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}class _c{static get instance(){return _c._instance||(_c._instance=new _c),_c._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}initialize(){var n=this;pe.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Et.instance.synchronize())}).on("XML_LOADED",e=>{!function JV(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Et.instance.get(r)&&0<mc.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Et.instance.get(r)&&0<mc.type(r).length&&n.push(r)}for(let i of n)Et.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=Et.instance.get(o.identifier);null===s&&(s=en.createEmpty(o.identifier),Et.instance.add(s)),s.state<Ei.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<Et.instance.getCatalog().length&&Et.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,Mt.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=Et.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(We.peerId);-1<a&&s.splice(a,1);for(let l of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+l+" -> "+i.data.identifiers),void pe.call(i,l);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Et.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Et.instance.get(i);this.receiveTaskMap.has(i)||r&&Ei.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),pe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){pe.unregister(this)}startSendTask(n,e){var i=this;return(0,Mt.Z)(function*(){let r=1===n.length?n[0].identifier:td.generateUuid(),o=Ya.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),pe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield mo.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield mo.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),Et.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Ya.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&pe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Et.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),pe.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:We.peerId,candidatePeers:We.peerIds},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=Et.instance.get(s.identifier),l={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Ei.URL?l.url=a.url:s.state===Ei.NULL?(l.thumbnail.blob=a.thumbnail.blob,l.thumbnail.type=a.thumbnail.type):(l.blob=a.blob,l.type=a.blob.type);let c=l.blob?l.blob.size:l.thumbnail.blob?l.thumbnail.blob.size:100;if(i.push(l),r+=c,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class qn{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){qn.tasksMap.size<1&&pe.register(qn.key).on("DISCONNECT_PEER",r=>{qn.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||qn.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||qn.onUpdate(r.data.identifier)});let i=new qn(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=qn.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),qn.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;pe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of qn.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();qn.tasksMap.size<1&&pe.unregister(qn.key)}static onUpdate(n){if(!qn.tasksMap.has(n))return;let e=qn.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);qn.tasksMap.size<1&&pe.unregister(qn.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=qn.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&qn.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Bo(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}qn.key={},qn.tasksMap=new Map;class vc{static get instance(){return vc._instance||(vc._instance=new vc),vc._instance}constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),pe.register(this).on("CONNECT_PEER",2,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)Be.instance.isDeleted(i.identifier)?pe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(Be.instance.isDeleted(n.data))pe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=Be.instance.get(n.data);e&&pe.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=Be.instance.get(e.identifier);i?(n.isSendFromSelf||(i=this.updateObject(i,e)),dM(i,n.sendFrom)):Be.instance.isDeleted(e.identifier)?pe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):(i=this.createObject(e),dM(i,n.sendFrom))}).on("DELETE_GAME_OBJECT",1e3,n=>{Be.instance.delete(n.data.identifier,!1)})}destroy(){pe.unregister(this)}updateObject(n,e){return e.majorVersion+e.minorVersion>n.version&&n.apply(e),n}createObject(n){let e=Vo.instance.create(n.aliasName,n.identifier);if(e)return Be.instance.add(e,!1),e.apply(n),e;console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=Be.instance.getCatalog(),i=setInterval(()=>{pe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=qn.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=Be.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=We.peers;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}class vM{get length(){return this._length}constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}let sp,ej=function tj(){let t=new vM("DiceBotQueue");return t.add((0,Mt.Z)(function*(){sp=new((yield Y.e(2460).then(Y.bind(Y,383))).default),qo.diceBotInfos=sp.listAvailableGameSystems().sort((n,e)=>n.sortKey<e.sortKey?-1:n.sortKey>e.sortKey?1:0)})),t}(),qo=((lv=class extends ta{onStoreAdded(){var n=this;super.onStoreAdded(),pe.register(this).on("SEND_MESSAGE",function(){var e=(0,Mt.Z)(function*(i){let r=Be.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o=xs.toHalfWidth(r.text).trim(),s=r.tag;try{let a=/^((\d+)?\s+)?(.*)?/gi.exec(o),l=null!=a[2]?Number(a[2]):1,c=null!=a[3]?a[3]:o;if(!c||l<1)return;l>1&&(c=`x${l} ${c}`);let u=yield dd.diceRollAsync(c,s);if(!u.result)return;n.sendResultMessage(u,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),pe.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result,o=n.isSecret;if(r.length<1)return;let s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:"system dicebot"+(o?" secret":""),name:`${i} : ${e.name}${o?" (Secret)":""}`,text:r};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));let a=Be.instance.get(e.tabIdentifier);a&&a.addMessage(s)}static diceRollAsync(n,e){return(0,Mt.Z)(function*(){const i={id:e,result:"",isSecret:!1};try{const r=yield dd.loadGameSystemAsync(e);if(!r?.COMMAND_PATTERN.test(n))return i;const o=r.eval(n);if(o)return console.log("diceRoll!!!",o.text),console.log("isSecret!!!",o.secret),{id:r.ID,result:o.text.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:o.secret}}catch(r){console.error(r)}return i})()}static getHelpMessage(n){return(0,Mt.Z)(function*(){try{return(yield dd.loadGameSystemAsync(n)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadGameSystemAsync(n){var e=this;return(0,Mt.Z)(function*(){return yield ej.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return sp.getGameSystemClass(i)}catch{return sp.dynamicLoad(i)}})})()}}).diceBotInfos=[],dd=lv);qo=dd=X([Zn("dice-bot")],qo);let qa=class extends ta{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new it}get audio(){return at.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=at.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){pe.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){pe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};X([st()],qa.prototype,"audioIdentifier",void 0),X([st()],qa.prototype,"startTime",void 0),X([st()],qa.prototype,"isLoop",void 0),X([st()],qa.prototype,"isPlaying",void 0),qa=X([Zn("jukebox")],qa);let cv=class extends ta{onStoreAdded(){super.onStoreAdded(),Be.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(Be.instance.getObjects(ui)),e=e.concat(Be.instance.getObjects(Dn)),e=e.concat(Be.instance.getObjects(Zo)),e=e.concat(Be.instance.getObjects(pi)),e=e.concat(Be.instance.getObjects(pr).filter(i=>null===i.parent)),e=e.concat(Be.instance.getObjects($o));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(Be.instance.getObjects(ui)),e=e.concat(Be.instance.getObjects(Wo)),e=e.concat(Be.instance.getObjects(Yr)),e=e.concat(Be.instance.getObjects(Dn)),e=e.concat(Be.instance.getObjects(Zo)),e=e.concat(Be.instance.getObjects(pi)),e=e.concat(Be.instance.getObjects(pr)),e=e.concat(Be.instance.getObjects($o));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)xn.instance.parseXml(n.children[i])}};cv=X([Zn("room")],cv);var nj=Y(1203);class kr{constructor(n){this.ngZone=n}saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return kr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new cv),o=this.convertToXml(jo.instance),s=this.convertToXml(Go.instance);return i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"summary.xml",{type:"text/plain"})),i=i.concat(this.searchImageFiles(r)),i=i.concat(this.searchImageFiles(o)),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="xml_data",i){return kr.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="xml_data",i){let r=[],o=this.convertToXml(n);return r.push(new File([o],"data.xml",{type:"text/plain"})),r=r.concat(this.searchImageFiles(o)),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return Yo.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+nj.xml(n.toXml(),2)}searchImageFiles(n){let e=Ts.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=Et.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=Et.instance.get(a));let l=o[s].getAttribute("backgroundImageIdentifier");l&&(r[l]=Et.instance.get(l))}for(let s in r){let a=r[s];a&&a.state===Ei.COMPLETE&&i.push(new File([a.blob],a.identifier+"."+mc.extension(a.blob.type),{type:a.blob.type}))}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}}function ij(t,n){if(1&t&&(T(0,"option",8),q(1),P()),2&t){const e=n.$implicit;vn("value",e.identifier),I(1),gt(e.name)}}function rj(t,n){if(1&t&&(T(0,"div",15),q(1),P()),2&t){const e=H(3);I(1),Gn("",e.progresPercent,"%")}}kr.queue=new vM("SaveDataServiceQueue"),kr.\u0275fac=function(n){return new(n||kr)(bt(Gt))},kr.\u0275prov=kt({token:kr,factory:kr.\u0275fac,providedIn:"root"});const oj=function(t){return{"is-hidden":t}};function sj(t,n){if(1&t){const e=et();je(0),T(1,"button",2),de("click",function(){return Me(e),ke(H(2).upTabIndex())}),q(2,"\u2191"),P(),T(3,"button",2),de("click",function(){return Me(e),ke(H(2).downTabIndex())}),q(4,"\u2193"),P(),T(5,"button",10),de("click",function(){return Me(e),ke(H(2).save())}),T(6,"div",11)(7,"div",12),q(8,"\u4fdd\u5b58"),P(),Q(9,rj,2,1,"div",13),P()(),T(10,"button",14),de("click",function(){return Me(e),ke(H(2).delete())}),q(11,"\u524a\u9664"),P(),He()}if(2&t){const e=H(2);I(5),S("disabled",e.isSaveing),I(2),S("ngClass",dt(4,oj,e.isSaveing)),I(2),S("ngIf",e.isSaveing),I(1),zr("disabled",e.chatTabs.length<=1?"":null)}}function aj(t,n){if(1&t){const e=et();je(0),T(1,"button",2),de("click",function(){return Me(e),ke(H(2).restore())}),q(2,"\u5143\u306b\u623b\u3059"),P(),He()}}function lj(t,n){if(1&t){const e=et();je(0),T(1,"div"),q(2,"\u30bf\u30d6\u540d : "),T(3,"input",9),de("ngModelChange",function(r){return Me(e),ke(H().tabName=r)}),P()(),Le(4,"hr"),T(5,"div"),Q(6,sj,12,6,"ng-container",7),Q(7,aj,3,0,"ng-container",7),P(),He()}if(2&t){const e=H();I(3),S("ngModel",e.tabName),zr("disabled",e.isEditable?null:""),I(3),S("ngIf",!e.isDeleted),I(1),S("ngIf",e.isDeleted)}}function cj(t,n){1&t&&(je(0),T(1,"div",16),q(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),P(),He())}let uj=(()=>{class t{get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Be.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),pe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Be.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){pe.unregister(this)}onChangeSelectTab(e){this.selectedTab=Be.instance.get(e),this.selectedTabXml=""}create(){jo.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,Mt.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=xn.instance.parseXml(this.selectedTabXml);jo.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}}return t.\u0275fac=function(e){return new(e||t)(J(Bi),J(hn),J(Ha),J(kr))},t.\u0275cmp=Wt({type:t,selectors:[["app-chat-tab-setting"]],decls:11,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],["select",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();T(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),de("click",function(){return i.create()}),q(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),P()(),T(5,"select",3,4),de("change",function(){Me(r);const s=Pt(6);return ke(i.onChangeSelectTab(s.value))}),Q(7,ij,2,2,"option",5),P()(),T(8,"div",6),Q(9,lj,8,4,"ng-container",7),P()(),Q(10,cj,3,0,"ng-container",7)}2&e&&(I(5),S("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),I(2),S("ngForOf",i.chatTabs),I(2),S("ngIf",!i.isEmpty&&i.selectedTab),I(1),S("ngIf",i.isEmpty))},dependencies:[li,Vn,pn,Hs,Gs,Pi,_s,qi,Ni],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})(),yM=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Wt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[kn],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(T(0,"div",0),q(1),P()),2&e&&(S("@bounce",i.animeState),I(1),gt(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Ao("bounce",[RT("active",wt({transform:""})),bi("* => active",[yi("600ms ease",go([wt({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),wt({transform:"scale3d(2, 2, 2)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})(),ni=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(J(LE,16))},t.\u0275pipe=ji({name:"safe",type:t,pure:!0}),t})();function dj(t,n){if(1&t&&(Le(0,"img",13),Zt(1,"safe")),2&t){const e=H();S("src",Yt(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Xn)}}function hj(t,n){1&t&&wn(0)}function fj(t,n){if(1&t){const e=et();T(0,"button",15),de("click",function(){return Me(e),ke(H(2).discloseMessage())}),q(1,"\u7d50\u679c\u3092\u516c\u958b"),P()}}function pj(t,n){if(1&t&&(T(0,"span"),q(1),P(),Q(2,fj,2,0,"button",14)),2&t){const e=H();I(1),gt(e.chatMessage.text),I(1),S("ngIf",e.chatMessage.isSecret)}}function gj(t,n){1&t&&(T(0,"span"),q(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),P())}const mj=function(t,n,e){return{"direct-message":t,"system-message":n,"dicebot-message":e}};let _j=(()=>{class t{constructor(e){this.chatMessageService=e,this.imageFile=en.Empty,this.animeState="inactive"}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}}return t.\u0275fac=function(e){return new(e||t)(J(Ha))},t.\u0275cmp=Wt({type:t,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage"},decls:19,vars:16,consts:[[1,"container"],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],["visible",""],["secret",""],[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,i){if(1&e&&(T(0,"div",0)(1,"div",1)(2,"div",2),Q(3,dj,2,4,"img",3),P(),T(4,"div",4)(5,"div",5)(6,"span",6),q(7),P(),T(8,"span",7),q(9),P(),T(10,"span",8),q(11),Zt(12,"date"),P()(),T(13,"div",9),Q(14,hj,1,0,"ng-container",10),P()()()(),Q(15,pj,3,2,"ng-template",null,11,Un),Q(17,gj,2,0,"ng-template",null,12,Un)),2&e){const r=Pt(16),o=Pt(18);I(1),S("ngClass",Ih(12,mj,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot))("@flyInOut",i.animeState),I(2),S("ngIf",0<(null==i.imageFile||null==i.imageFile.url?null:i.imageFile.url.length)),I(4),gt(i.chatMessage.name),I(2),gt(i.chatMessage.from),I(2),gt(Yt(12,9,i.chatMessage.timestamp,"y/M/d H:mm")),I(3),S("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)("ngIfThen",r)("ngIfElse",o)}},dependencies:[li,pn,lE,ni],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}"],data:{animation:[Ao("flyInOut",[bi("* => active",[yi("200ms ease-out",go([wt({transform:"translateX(100px)",opacity:"0",offset:0}),wt({transform:"translateX(0)",opacity:"1",offset:1})]))]),bi("void => *",[yi("200ms ease-out",go([wt({opacity:"0",offset:0}),wt({opacity:"1",offset:1})]))])])]}}),t})();const vj=["logContainer"],yj=["messageContainer"];function bj(t,n){1&t&&Le(0,"chat-message",7),2&t&&S("chatMessage",H().$implicit)}function Cj(t,n){if(1&t&&(je(0),Q(1,bj,1,1,"chat-message",6),He()),2&t){const e=n.$implicit;I(1),S("ngIf",e.isDisplayable)}}function wj(t,n){if(1&t&&(je(0),Q(1,Cj,2,1,"ng-container",5),He()),2&t){const e=H();I(1),S("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function Ej(t,n){1&t&&Le(0,"chat-message",7),2&t&&S("chatMessage",n.$implicit)}function Tj(t,n){if(1&t&&(je(0),Q(1,Ej,1,1,"chat-message",8),He()),2&t){const e=H();I(1),S("ngForOf",e.sampleMessages)}}const uv=window.navigator.userAgent.toLowerCase(),bM=uv.indexOf("iphone")>-1||uv.indexOf("ipad")>-1||uv.indexOf("macintosh")>-1&&"ontouchend"in document;let xj=(()=>{class t{get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){let e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"),this.makeSampleMessage("System","???","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System","???","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc","\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002")],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Ht}ngOnInit(){pe.register(this).on("MESSAGE_ADDED",e=>{let i=Be.instance.get(e.data.messageIdentifier);!i||!this.chatTab.contains(i)||this.topTimestamp<=i.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on(`UPDATE_GAME_OBJECT/aliasName/${dr.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);i&&this.topTimestamp<=i.timestamp&&i.timestamp<=this.botomTimestamp&&this.chatTab.contains(i)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new Bo(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new Bo(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){pe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Ri(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,l=null,c=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),l=s.getBoundingClientRect(),c=a.top-l.top-this.scrollSpeed,(!r||!o)&&.25<c**2&&(this.panelService.scrollablePanel.scrollTop-=c);let u=this.logContainerRef.nativeElement.getBoundingClientRect(),h=this.messageContainerRef.nativeElement.getBoundingClientRect(),g=h.top-u.top,E=g+h.height,L=this.getScrollPosition();return r=L.top<g,o=E<L.bottom&&L.bottom<L.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Ri(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,l=this.getScrollPosition();this.scrollSpeed=l.top-this.preScrollTop,this.preScrollTop=l.top;let c=l.top<r,u=o<l.bottom&&l.bottom<l.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!c&&!u)return;let h=l.top-(!e&&c?100:1200),g=l.bottom+(!e&&u?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,h,g,l,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Ri(()=>{let L=this.getScrollPosition();this.scrollSpeed=L.top-this.preScrollTop,this.preScrollTop=L.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let l=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/l)+1:r>e&&(bM||(this.topIndex+=Math.floor((r-e)/l))),i>o?bM||(this.bottomIndex-=Math.floor((i-o)/l)):i<o&&(this.bottomIndex+=Math.floor((o-i)/l)+1)}this.adjustIndex()}makeSampleMessage(e,i,r,o){let s=new dr;return s.from=e,s.to=i,s.name=r,s.value=o,s}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Ai),J(hn))},t.\u0275cmp=Wt({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(An(vj,7),An(yj,7)),2&e){let r;On(r=Pn())&&(i.logContainerRef=r.first),On(r=Pn())&&(i.messageContainerRef=r.first)}},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[kn],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(T(0,"div",0,1)(2,"div",2,3),Q(4,wj,2,2,"ng-container",4),Q(5,Tj,2,1,"ng-container",4),P()()),2&e&&(dn("min-height",i.minScrollHeight,"px"),I(2),dn("margin-bottom",i.bottomSpace,"px"),I(2),S("ngIf",0<i.chatMessages.length),I(1),S("ngIf",i.chatMessages.length<=0))},dependencies:[Vn,pn,_j],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})(),dv=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(e,i){1&e&&(T(0,"span")(1,"pre",0),q(2),P()()),2&e&&(I(2),gt(i.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})(),ap=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Ri(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt))},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Dj=["textArea"];function Sj(t,n){1&t&&(Le(0,"img",15),Zt(1,"safe")),2&t&&S("src",Yt(1,1,H().imageFile.url,"resourceUrl"),Xn)}function Mj(t,n){if(1&t&&(T(0,"option",16),q(1),P()),2&t){const e=H();vn("value",null==e.myPeer?null:e.myPeer.identifier),I(1),Gn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function kj(t,n){if(1&t&&(T(0,"option",16),q(1),P()),2&t){const e=n.$implicit;vn("value",e.identifier),I(1),Gn("",e.name," ")}}function Ij(t,n){1&t&&(je(0),q(1,"\uff08\u3042\u306a\u305f\uff09"),He())}function Oj(t,n){if(1&t&&(T(0,"option",16),q(1),Q(2,Ij,2,0,"ng-container",9),P()),2&t){const e=n.$implicit,i=H();vn("value",e.identifier),I(1),Gn("",e.name," "),I(1),S("ngIf",e===i.myPeer)}}function Aj(t,n){if(1&t&&(T(0,"option",16),q(1),P()),2&t){const e=n.$implicit;vn("value",e.id),I(1),gt("DiceBot"===e.name?"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057":e.name)}}const CM=function(){return{standalone:!0}};function Pj(t,n){if(1&t){const e=et();je(0),T(1,"select",17,18),de("change",function(){Me(e);const r=Pt(2);return ke(H().loadDiceBot(r.value))})("ngModelChange",function(r){return Me(e),ke(H().gameType=r)}),Q(3,Aj,2,2,"option",6),P(),He()}if(2&t){const e=H();I(1),S("ngModel",e.gameType)("ngModelOptions",Ca(3,CM)),I(2),S("ngForOf",e.diceBotInfos)}}function Fj(t,n){1&t&&(je(0),T(1,"select",19)(2,"option",8),q(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d..."),P()(),He())}function Nj(t,n){1&t&&(T(0,"span"),q(1,", "),P())}function Rj(t,n){if(1&t&&(T(0,"span",21),q(1),Q(2,Nj,2,0,"span",9),P()),2&t){const e=n.$implicit,i=n.index,r=H(2);I(1),gt(e),I(1),S("ngIf",r.writingPeerNames.length!==i+1)}}function Lj(t,n){if(1&t&&(je(0),Q(1,Rj,3,2,"span",20),T(2,"span"),q(3," \u304c\u5165\u529b\u4e2d..."),P(),He()),2&t){const e=H();I(1),S("ngForOf",e.writingPeerNames)}}const Bj=function(t){return{"direct-message":t}};let wM=(()=>{class t{get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get imageFile(){let e=Be.instance.get(this.sendFrom),i=null;return e instanceof Dn?i=e.imageFile:e instanceof Rt&&(i=e.image),i||en.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Be.instance.getObjects(Dn).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return qo.diceBotInfos}get myPeer(){return Rt.myCursor}get otherPeers(){return Be.instance.getObjects(Rt)}constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Ht,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Ht,this._sendTo="",this.sendToChange=new Ht,this._text="",this.textChange=new Ht,this.chat=new Ht,this.gameHelp="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[]}ngOnInit(){pe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Be.instance.get(e.data.messageIdentifier),r=Be.instance.getObjects(Rt).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on(`UPDATE_GAME_OBJECT/aliasName/${Dn.aliasName}`,e=>{if(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom)return;let i=Be.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=Be.instance.get(this.sendTo);i instanceof Rt&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new Bo(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){pe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=Rt.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=Be.instance.get(this.sendTo);if(i instanceof Rt){let r=Tn.parse(i.peerId);r&&(e=r.peerId)}}pe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode||(this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.chat.emit({text:this.text,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight())}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),qo.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}showDicebotHelp(){qo.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of qo.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(dv,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of We.peers)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Ha),J(ap),J(hn),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&An(Dj,7),2&e){let r;On(r=Pn())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:25,vars:16,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[2,"width","12em",3,"ngModel","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[2,"width","10em",3,"ngModel","ngModelChange"],["value",""],[4,"ngIf"],[3,"disabled","click"],["placeholder","Enter\u3067\u9001\u4fe1  Shift+Enter\u3067\u6539\u884c",1,"chat-input",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],[3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","change","ngModelChange"],["select",""],["disabled","",2,"width","12em"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(T(0,"div",0)(1,"div",1),Q(2,Sj,2,4,"img",2),P(),T(3,"div",3)(4,"div")(5,"select",4),de("ngModelChange",function(o){return i.sendFrom=o}),Q(6,Mj,2,2,"option",5),Q(7,kj,2,2,"option",6),P(),q(8," \uff1e "),T(9,"select",7),de("ngModelChange",function(o){return i.sendTo=o}),T(10,"option",8),q(11,"\u5168\u54e1"),P(),Q(12,Oj,3,3,"option",6),P(),Q(13,Pj,4,4,"ng-container",9),Q(14,Fj,4,0,"ng-container",9),T(15,"button",10),de("click",function(){return i.showDicebotHelp()}),q(16,"?"),P()(),T(17,"div")(18,"form")(19,"textarea",11,12),de("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)}),P(),T(21,"button",13),de("click",function(){return i.sendChat(null)}),q(22,"SEND"),P()()(),T(23,"div",14),Q(24,Lj,4,1,"ng-container",9),P()()()),2&e&&(S("ngClass",dt(13,Bj,i.isDirect)),I(2),S("ngIf",0<i.imageFile.url.length),I(3),S("ngModel",i.sendFrom),I(1),S("ngIf",!i.onlyCharacters),I(1),S("ngForOf",i.gameCharacters),I(2),S("ngModel",i.sendTo),I(3),S("ngForOf",i.otherPeers),I(1),S("ngIf",0<i.diceBotInfos.length),I(1),S("ngIf",i.diceBotInfos.length<1),I(1),S("disabled",i.diceBotInfos.length<1),I(4),S("ngModel",i.text)("ngModelOptions",Ca(15,CM)),I(5),S("ngIf",0<i.writingPeerNames.length))},dependencies:[li,Vn,pn,Yl,Hs,Gs,Pi,_s,qi,$l,Ni,js,ni],styles:["[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}"]}),t})();function zj(t,n){if(1&t){const e=et();T(0,"chat-tab",10),de("onAddMessage",function(){return Me(e),ke(H().scrollToBottom())}),P()}2&t&&S("chatTab",H().chatTab)}function Uj(t,n){1&t&&(T(0,"div"),q(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P())}function Vj(t,n){1&t&&Le(0,"badge",13),2&t&&S("count",H().$implicit.unreadLength)}function jj(t,n){if(1&t){const e=et();T(0,"label")(1,"input",11),de("ngModelChange",function(r){return Me(e),ke(H().chatTabidentifier=r)}),P(),T(2,"div"),q(3),Q(4,Vj,1,1,"badge",12),P()()}if(2&t){const e=n.$implicit,i=H();I(1),vn("value",e.identifier),S("ngModel",i.chatTabidentifier),I(2),gt(e.name),I(1),S("ngIf",e.hasUnread)}}let EM=(()=>{class t{get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return Be.instance.get(this.chatTabidentifier)}constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}ngOnInit(){this.sendFrom=Rt.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",pe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Be.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){pe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(uj,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo)}trackByChatTab(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(Ha),J(hn),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","onAddMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(T(0,"div",0)(1,"div",1),Q(2,zj,1,1,"chat-tab",2),Q(3,Uj,2,0,"div",3),P(),T(4,"div",4)(5,"form")(6,"div",5),Q(7,jj,5,4,"label",6),T(8,"button",7),de("click",function(){return i.showTabSetting()}),T(9,"i",8),q(10,"settings"),P(),q(11,"\u30bf\u30d6\u8a2d\u5b9a"),P()()(),T(12,"chat-input",9),de("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)}),P()()()),2&e&&(I(2),S("ngIf",i.chatTab),I(1),S("ngIf",!i.chatTab),I(4),S("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),I(5),S("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},dependencies:[Vn,pn,Yl,Pi,Iu,qi,$l,Ni,js,yM,xj,wM],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),t})();const Hj=["root"];function Gj(t,n){if(1&t&&(T(0,"div",6),q(1),P()),2&t){const e=H();I(1),gt(e.title)}}function $j(t,n){1&t&&wn(0)}const Wj=function(t){return{action:t}};function Zj(t,n){if(1&t&&(je(0),Q(1,$j,1,0,"ng-container",7),He()),2&t){const e=n.$implicit;H();const i=Pt(8),r=Pt(6);I(1),S("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",dt(2,Wj,e))}}function Yj(t,n){1&t&&(T(0,"div",12)(1,"i",13),q(2,"arrow_forward_ios"),P()())}function qj(t,n){if(1&t&&Le(0,"context-menu",14),2&t){const e=H().action,i=H();S("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function Kj(t,n){if(1&t){const e=et();T(0,"li",8),de("click",function(){const o=Me(e).action;return ke(H().doAction(o))})("mouseenter",function(){const o=Me(e).action;return ke(H().showSubMenu(o))}),T(1,"div",9),q(2),P(),Q(3,Yj,3,0,"div",10),Q(4,qj,1,3,"context-menu",11),P()}if(2&t){const e=n.action,i=H();I(2),gt(e.name),I(1),S("ngIf",e.subActions),I(1),S("ngIf",i.subMenu&&i.parentMenu===e)}}function Xj(t,n){1&t&&(T(0,"li"),Le(1,"hr",15),P())}const Qj=function(t,n,e){return{"submenu-panel":t,"is-max-limit":n,"pointer-events-none":e}};let Jj=(()=>{class t{get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(J(Bn),J(fr),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&An(Hj,7),2&e){let r;On(r=Pn())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&de("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:9,vars:7,consts:[[1,"component",3,"ngClass","mouseleave"],["root",""],["class","title",4,"ngIf"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click","mouseenter"],[1,"menu-title"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(T(0,"div",0,1),de("mouseleave",function(){return i.hideSubMenu()}),Q(2,Gj,2,1,"div",2),T(3,"ul"),Q(4,Zj,2,4,"ng-container",3),P()(),Q(5,Kj,5,3,"ng-template",null,4,Un),Q(7,Xj,2,0,"ng-template",null,5,Un)),2&e&&(S("ngClass",Ih(3,Qj,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),I(2),S("ngIf",0<i.title.length),I(2),S("ngForOf",i.actions))},dependencies:[li,Vn,pn,wu,t],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]}),t})();function eH(t,n){if(1&t){const e=et();T(0,"img",9),de("click",function(){Me(e);const r=H().$implicit;return ke(H().onSelectedFile(r))}),Zt(1,"safe"),P()}if(2&t){const e=H().$implicit;S("src",Yt(1,2,e.url,"resourceUrl"),Xn)("alt",e.name)}}function tH(t,n){1&t&&Le(0,"img",10),2&t&&vn("alt",H().$implicit.name)}function nH(t,n){if(1&t&&(T(0,"span",6),Q(1,eH,2,5,"img",7),Q(2,tH,1,1,"img",8),P()),2&t){const e=n.$implicit;I(1),S("ngIf",0<e.url.length),I(1),S("ngIf",e.url.length<=0)}}let iH=(()=>{class t{constructor(e,i){this.changeDetector=e,this.panelService=i,this.fileStorageService=Et.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){pe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){pe.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Yo.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),pe.call("SELECT_FILE",{fileIdentifier:e.identifier},We.peerId)}}return t.\u0275fac=function(e){return new(e||t)(J(Ai),J(hn))},t.\u0275cmp=Wt({type:t,selectors:[["file-storage"]],decls:15,vars:1,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],["id","file-list"],["class","image",4,"ngFor","ngForOf"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(T(0,"label")(1,"div",0)(2,"div")(3,"i",1),q(4,"add_photo_alternate"),P()(),T(5,"div"),q(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),P(),T(7,"div",2),q(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),P(),T(9,"input",3),de("change",function(o){return i.handleFileSelect(o)}),P(),T(10,"div",2),Le(11,"br"),q(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),P()()(),T(13,"div",4),Q(14,nH,3,2,"span",5),P()),2&e&&(I(14),S("ngForOf",i.fileStorageService.images))},dependencies:[Vn,pn,ni],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}'],changeDetection:0}),t})();function rH(t,n){if(1&t){const e=et();T(0,"span",3)(1,"button",4),de("click",function(){Me(e);const r=H();return ke(r.onSelectedFile(r.empty))}),q(2,"\u753b\u50cf\u306a\u3057"),P()()}}function oH(t,n){if(1&t){const e=et();T(0,"img",8),de("click",function(){Me(e);const r=H().$implicit;return ke(H().onSelectedFile(r))}),Zt(1,"safe"),P()}if(2&t){const e=H().$implicit;S("src",Yt(1,2,e.url,"resourceUrl"),Xn)("alt",e.name)}}function sH(t,n){1&t&&Le(0,"img",9),2&t&&vn("alt",H().$implicit.name)}function aH(t,n){if(1&t&&(T(0,"span",5),Q(1,oH,2,5,"img",6),Q(2,sH,1,1,"img",7),P()),2&t){const e=n.$implicit;I(1),S("ngIf",0<e.url.length),I(1),S("ngIf",e.url.length<=0)}}let lp=(()=>{class t{get images(){return Et.instance.images}get empty(){return en.Empty}constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){pe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){pe.unregister(this)}onSelectedFile(e){pe.call("SELECT_FILE",{fileIdentifier:e.identifier},We.peerId),this.modalService.resolve(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(J(Ai),J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:3,vars:2,consts:[["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],[1,"empty"],[3,"click"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","./assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","./assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(T(0,"div",0),Q(1,rH,3,0,"span",1),Q(2,aH,3,2,"span",2),P()),2&e&&(I(1),S("ngIf",i.isAllowedEmpty),I(1),S("ngForOf",i.images))},dependencies:[Vn,pn,ni],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}"],changeDetection:0}),t})();function lH(t,n){1&t&&wn(0)}function cH(t,n){if(1&t){const e=et();T(0,"div",3),Q(1,lH,1,0,"ng-container",8),T(2,"select",9,10),de("change",function(){Me(e);const r=Pt(3);return ke(H(3).setElementType(r.value))}),T(4,"option",11),q(5,"\u901a\u5e38"),P(),T(6,"option",12),q(7,"\u30ea\u30bd\u30fc\u30b9"),P(),T(8,"option",13),q(9,"\u30ce\u30fc\u30c8"),P()()()}if(2&t){const e=H(3),i=Pt(2);let r;I(1),S("ngTemplateOutlet",i),I(1),S("ngModel",null!==(r=e.gameDataElement.type)&&void 0!==r?r:"")}}function uH(t,n){if(1&t&&(je(0),T(1,"div",14),q(2),P(),He()),2&t){const e=H(3);I(2),gt(e.name)}}function dH(t,n){if(1&t){const e=et();je(0),T(1,"div",15),q(2),P(),T(3,"input",16),de("ngModelChange",function(r){return Me(e),ke(H(3).name=r)}),P(),He()}if(2&t){const e=H(3);I(2),gt(e.name),I(1),S("ngModel",e.name)}}function hH(t,n){if(1&t){const e=et();je(0),T(1,"input",17),de("ngModelChange",function(r){return Me(e),ke(H(3).currentValue=r)}),Zt(2,"safe"),P(),Le(3,"br"),T(4,"input",18),de("ngModelChange",function(r){return Me(e),ke(H(3).currentValue=r)}),P(),q(5," / "),T(6,"input",19),de("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),P(),He()}if(2&t){const e=H(3);I(1),Cr(Yt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),S("ngModel",e.currentValue),I(3),S("ngModel",e.currentValue),I(2),S("ngModel",e.value)}}function fH(t,n){if(1&t){const e=et();je(0),T(1,"textarea",20),de("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),P(),He()}if(2&t){const e=H(3);I(1),S("ngModel",e.value)}}function pH(t,n){if(1&t){const e=et();je(0),T(1,"div",21),q(2),P(),T(3,"input",22),de("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),P(),He()}if(2&t){const e=H(3);I(2),gt(e.value),I(1),S("ngModel",e.value)}}function gH(t,n){if(1&t&&(je(0),Q(1,cH,10,2,"div",2),T(2,"div",3),Q(3,uH,3,1,"ng-container",0),Q(4,dH,4,2,"ng-container",0),P(),T(5,"div",4),je(6,5),Q(7,hH,7,9,"ng-container",6),Q(8,fH,2,1,"ng-container",6),Q(9,pH,4,2,"ng-container",7),He(),P(),He()),2&t){const e=H(2);I(1),S("ngIf",e.isEdit),I(2),S("ngIf",e.isTagLocked),I(1),S("ngIf",!e.isTagLocked),I(2),S("ngSwitch",e.gameDataElement.type),I(1),S("ngSwitchCase","numberResource"),I(1),S("ngSwitchCase","note")}}function mH(t,n){1&t&&wn(0)}function _H(t,n){if(1&t&&(T(0,"div",28),Q(1,mH,1,0,"ng-container",8),P()),2&t){H(3);const e=Pt(2);I(1),S("ngTemplateOutlet",e)}}function vH(t,n){if(1&t&&(je(0),T(1,"div",29),q(2),P(),He()),2&t){const e=H(3);I(2),gt(e.name)}}function yH(t,n){if(1&t){const e=et();je(0),T(1,"input",30),de("ngModelChange",function(r){return Me(e),ke(H(3).name=r)}),P(),He()}if(2&t){const e=H(3);I(1),S("ngModel",e.name)}}function bH(t,n){if(1&t&&Le(0,"div",33),2&t){const e=n.$implicit,i=H(4);S("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function CH(t,n){if(1&t&&(T(0,"div",31),Q(1,bH,1,3,"div",32),P()),2&t){const e=H(3);I(1),S("ngForOf",e.gameDataElement.children)}}function wH(t,n){if(1&t&&(je(0),Q(1,_H,2,1,"div",23),Le(2,"div",24),T(3,"div",25)(4,"div",26),Q(5,vH,3,1,"ng-container",0),Q(6,yH,2,1,"ng-container",0),P(),Q(7,CH,2,1,"div",27),P(),He()),2&t){const e=H(2);I(1),S("ngIf",e.isEdit),I(4),S("ngIf",e.isTagLocked),I(1),S("ngIf",!e.isTagLocked),I(1),S("ngIf",0<e.gameDataElement.children.length)}}function EH(t,n){if(1&t&&(je(0),Q(1,gH,10,6,"ng-container",0),Q(2,wH,8,4,"ng-container",0),He()),2&t){const e=H();I(1),S("ngIf",e.gameDataElement.children.length<1),I(1),S("ngIf",0<e.gameDataElement.children.length)}}function TH(t,n){if(1&t){const e=et();T(0,"button",34),de("click",function(){return Me(e),ke(H().addElement())}),T(1,"i",35),q(2,"add_circle"),P()(),T(3,"button",34),de("click",function(){return Me(e),ke(H().upElement())}),T(4,"i",35),q(5,"arrow_upward"),P()(),Le(6,"br"),T(7,"button",34),de("click",function(){return Me(e),ke(H().deleteElement())}),T(8,"i",35),q(9,"remove_circle_outline"),P()(),T(10,"button",34),de("click",function(){return Me(e),ke(H().downElement())}),T(11,"i",35),q(12,"arrow_downward"),P()()}}let xH=(()=>{class t{get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement)}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameDataElement?.identifier}`,e=>{this.setValues(this.gameDataElement),this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){pe.unregister(this)}addElement(){this.gameDataElement.appendChild(rt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(J(Ai))},t.\u0275cmp=Wt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},features:[kn],decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["select",""],["value",""],["value","numberResource"],["value","note"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","max","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModel","ngModelChange"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","ngModelChange"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Q(0,EH,3,2,"ng-container",0),Q(1,TH,13,0,"ng-template",null,1,Un)),2&e&&S("ngIf",i.gameDataElement)},dependencies:[Vn,pn,wu,Ea,bu,Cu,Hs,Gs,Pi,ql,Da,_s,qi,Ni,t,ni],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],changeDetection:0}),t})();function DH(t,n){1&t&&wn(0)}function SH(t,n){if(1&t){const e=et();je(0),T(1,"button",0),de("click",function(){return Me(e),ke(H().openModal("front"))}),q(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),T(3,"button",0),de("click",function(){return Me(e),ke(H().openModal("back"))}),q(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),He()}}function MH(t,n){1&t&&wn(0)}function kH(t,n){if(1&t){const e=et();je(0),T(1,"button",0),de("click",function(){return Me(e),ke(H().openModal("floor"))}),q(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),T(3,"button",0),de("click",function(){return Me(e),ke(H().openModal("wall"))}),q(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),He()}}function IH(t,n){if(1&t){const e=et();je(0),T(1,"button",4),de("click",function(){Me(e);const r=H();return ke(r.openModal(r.tabletopObject.face))}),q(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),P(),He()}if(2&t){const e=H();I(1),S("disabled",!e.tabletopObject.isVisible)}}function OH(t,n){if(1&t){const e=et();je(0),T(1,"button",0),de("click",function(){return Me(e),ke(H().openModal("imageIdentifier",!0))}),q(2,"\u753b\u50cf\u5909\u66f4"),P(),He()}}function AH(t,n){if(1&t&&(T(0,"div",10),q(1),P()),2&t){const e=H();I(1),Gn("",e.progresPercent,"%")}}function PH(t,n){if(1&t){const e=et();T(0,"select",12,13),de("change",function(){Me(e);const r=Pt(1);return ke(H(2).setLocation(r.value))}),T(2,"option",14),q(3,"\u30c6\u30fc\u30d6\u30eb"),P(),T(4,"option",15),q(5,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P(),T(6,"option",16),q(7,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P(),T(8,"option",17),q(9,"\u5893\u5730"),P()()}if(2&t){const e=H(2);S("ngModel",e.tabletopObject.location.name),I(6),vn("value",e.networkService.peerId)}}function FH(t,n){if(1&t&&(je(0),Q(1,PH,10,2,"select",11),He()),2&t){const e=H();I(1),S("ngIf",e.tabletopObject)}}function NH(t,n){if(1&t&&(T(0,"div",20),Le(1,"img",21),Zt(2,"safe"),P()),2&t){const e=H(2);I(1),S("src",Yt(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),Xn)("alt",e.tabletopObject.imageFile.name)}}function RH(t,n){if(1&t&&(je(0),T(1,"div",22)(2,"div",23),Le(3,"div",24),P()(),He()),2&t){const e=H(2);I(3),S("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function LH(t,n){if(1&t&&(T(0,"div",22)(1,"div",23),Le(2,"div",26),P()()),2&t){const e=n.$implicit,i=H(3);I(2),S("gameDataElement",e)("isEdit",i.isEdit)}}function BH(t,n){if(1&t&&(je(0),Q(1,LH,3,2,"div",25),He()),2&t){const e=H(2);I(1),S("ngForOf",e.tabletopObject.detailDataElement.children)}}function zH(t,n){if(1&t){const e=et();je(0),T(1,"div",22)(2,"button",27),de("click",function(){return Me(e),ke(H(2).addDataElement())}),q(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),P()(),He()}}function UH(t,n){if(1&t&&(T(0,"div",18),Q(1,NH,3,5,"div",19),Q(2,RH,4,2,"ng-container",8),Q(3,BH,2,1,"ng-container",8),Q(4,zH,4,0,"ng-container",8),P()),2&t){const e=H();I(1),S("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),I(1),S("ngIf",e.tabletopObject.commonDataElement),I(1),S("ngIf",e.tabletopObject.detailDataElement),I(1),S("ngIf",e.isEdit)}}const VH=function(t){return{"is-hidden":t}};let Ko=(()=>{class t{constructor(e,i,r){this.saveDataService=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.isEdit=!1,this.networkService=We,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){pe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){pe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=rt.create("\u898b\u51fa\u3057","",{}),i=rt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":Re.play(Ee.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,Re.play(Ee.cardPut);break;case"text-note":e.toTopmost(),Re.play(Ee.cardPut);break;case"dice-symbol":Re.play(Ee.dicePut);default:Re.play(Ee.piecePut)}}saveToXML(){var e=this;return(0,Mt.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(lp,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);o&&(o.value=r)})}}return t.\u0275fac=function(e){return new(e||t)(J(kr),J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:13,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["select",""],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(T(0,"button",0),de("click",function(){return i.toggleEditMode()}),q(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),P(),je(2,1),Q(3,DH,1,0,"ng-container",2),Q(4,SH,5,0,"ng-container",2),Q(5,MH,1,0,"ng-container",2),Q(6,kH,5,0,"ng-container",2),Q(7,IH,3,1,"ng-container",2),Q(8,OH,3,0,"ng-container",3),He(),T(9,"button",0),de("click",function(){return i.clone()}),q(10,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),P(),T(11,"button",4),de("click",function(){return i.saveToXML()}),T(12,"div",5)(13,"div",6),q(14,"\u4fdd\u5b58"),P(),Q(15,AH,2,1,"div",7),P()(),Q(16,FH,2,1,"ng-container",8),Q(17,UH,5,4,"div",9)),2&e&&(I(2),S("ngSwitch",i.tabletopObject.aliasName),I(1),S("ngSwitchCase","numberResource"),I(1),S("ngSwitchCase","card"),I(1),S("ngSwitchCase","card-stack"),I(1),S("ngSwitchCase","terrain"),I(1),S("ngSwitchCase","dice-symbol"),I(4),S("disabled",i.isSaveing),I(2),S("ngClass",dt(11,VH,i.isSaveing)),I(2),S("ngIf",i.isSaveing),I(1),S("ngIf","character"===i.tabletopObject.aliasName),I(1),S("ngIf",i.tabletopObject))},dependencies:[li,Vn,pn,Ea,bu,Cu,Hs,Gs,_s,qi,Ni,xH,ni],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();const jH=["chatInput"],HH=["chatPlette"];function GH(t,n){1&t&&Le(0,"badge",12),2&t&&S("count",H().$implicit.unreadLength)}function $H(t,n){if(1&t){const e=et();T(0,"label")(1,"input",10),de("ngModelChange",function(r){return Me(e),ke(H().chatTabidentifier=r)}),P(),T(2,"div"),q(3),Q(4,GH,1,1,"badge",11),P()()}if(2&t){const e=n.$implicit,i=H();I(1),vn("value",e.identifier),S("ngModel",i.chatTabidentifier),I(2),gt(e.name),I(1),S("ngIf",e.hasUnread)}}function WH(t,n){1&t&&(T(0,"div",13)(1,"i",14),q(2,"info_outline"),P(),q(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),P())}function ZH(t,n){if(1&t&&(T(0,"option",19),q(1),P()),2&t){const e=n.$implicit;vn("value",e),I(1),gt(e)}}function YH(t,n){if(1&t&&(je(0),Q(1,ZH,2,2,"option",18),He()),2&t){const e=H(2);I(1),S("ngForOf",e.palette.getPalette())}}function qH(t,n){if(1&t){const e=et();T(0,"div",15)(1,"select",16,17),de("input",function(){Me(e);const r=Pt(2);return ke(H().selectPalette(r.value))})("click",function(){Me(e);const r=Pt(2);return ke(H().clickPalette(r.value))}),Q(3,YH,2,1,"ng-container",9),P()()}if(2&t){const e=H();I(3),S("ngIf",e.palette)}}function KH(t,n){if(1&t){const e=et();T(0,"div",15)(1,"textarea",20),de("ngModelChange",function(r){return Me(e),ke(H().editPalette=r)}),P()()}if(2&t){const e=H();I(1),S("ngModel",e.editPalette)}}function XH(t,n){1&t&&(T(0,"span"),q(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),P())}function QH(t,n){1&t&&(T(0,"span"),q(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),P())}let TM=(()=>{class t{get palette(){return this.character.chatPalette}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return qo.diceBotInfos}get chatTab(){return Be.instance.get(this.chatTabidentifier)}get myPeer(){return Rt.myCursor}get otherPeers(){return Be.instance.getObjects(Rt)}constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",pe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){pe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Be.instance.get(e);if(i instanceof Dn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo)}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}}return t.\u0275fac=function(e){return new(e||t)(J(Ha),J(hn))},t.\u0275cmp=Wt({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(An(jH,7),An(HH,5)),2&e){let r;On(r=Pn())&&(i.chatInputComponent=r.first),On(r=Pn())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(T(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),Q(4,$H,5,4,"label",3),P()(),T(5,"chat-input",4,5),de("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)}),P(),Q(7,WH,4,0,"div",6),P(),Q(8,qH,4,1,"div",7),Q(9,KH,2,1,"div",7),T(10,"div",1)(11,"button",8),de("click",function(){return i.toggleEditMode()}),Q(12,XH,2,0,"span",9),Q(13,QH,2,0,"span",9),P()()()),2&e&&(I(4),S("ngForOf",i.chatMessageService.chatTabs),I(1),S("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),I(2),S("ngIf",i.isEdit),I(1),S("ngIf",!i.isEdit),I(1),S("ngIf",i.isEdit),I(3),S("ngIf",!i.isEdit),I(1),S("ngIf",i.isEdit))},dependencies:[Vn,pn,Yl,Hs,Gs,Pi,Iu,qi,$l,Ni,js,yM,wM],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]}),t})();function JH(t,n){1&t&&wn(0)}function e9(t,n){1&t&&wn(0)}function t9(t,n){if(1&t&&(T(0,"div"),q(1),P()),2&t){const e=H();I(1),Gn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function n9(t,n){1&t&&wn(0)}const i9=function(t){return{box:!0,selected:t}},r9=function(t){return{gameObject:t}};function o9(t,n){if(1&t){const e=et();T(0,"div",9),de("contextmenu",function(r){const s=Me(e).$implicit;return ke(H().onContextMenu(r,s))})("click",function(){const o=Me(e).$implicit;return ke(H().selectGameObject(o))}),Q(1,n9,1,0,"ng-container",10),P()}if(2&t){const e=n.$implicit,i=H(),r=Pt(11);S("ngClass",dt(3,i9,i.selectedIdentifier===e.identifier)),I(1),S("ngTemplateOutlet",r)("ngTemplateOutletContext",dt(5,r9,e))}}function s9(t,n){if(1&t){const e=et();T(0,"div",11)(1,"button",12),de("click",function(){return Me(e),ke(H().cleanInventory())}),q(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),P()()}if(2&t){const e=H();I(1),zr("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function a9(t,n){if(1&t){const e=et();T(0,"label")(1,"input",16),de("ngModelChange",function(r){return Me(e),ke(H(2).selectTab=r)}),P(),T(2,"div"),q(3),P()()}if(2&t){const e=n.$implicit,i=H(2);I(1),vn("value",e),S("ngModel",i.selectTab),I(2),Bl("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function l9(t,n){if(1&t&&(T(0,"form",13)(1,"div",14),Q(2,a9,4,4,"label",15),P()()),2&t){const e=H();I(2),S("ngForOf",e.inventoryTypes)}}function c9(t,n){if(1&t){const e=et();je(0),T(1,"div")(2,"div",17),q(3,"\u4e26\u3073\u9806"),P(),T(4,"input",18),de("ngModelChange",function(r){return Me(e),ke(H(2).sortTag=r)}),P(),T(5,"select",19),de("ngModelChange",function(r){return Me(e),ke(H(2).sortOrder=r)}),T(6,"option",20),q(7,"\u6607\u9806"),P(),T(8,"option",21),q(9,"\u964d\u9806"),P()()(),T(10,"div",22),q(11,"\u8868\u793a\u9805\u76ee"),P(),T(12,"input",23),de("ngModelChange",function(r){return Me(e),ke(H(2).dataTag=r)}),P(),T(13,"div",11)(14,"button",24),de("click",function(){return Me(e),ke(H(2).toggleEdit())}),T(15,"i",25),q(16,"settings"),P(),q(17,"\u5b8c\u4e86"),P()(),He()}if(2&t){const e=H(2);I(4),S("ngModel",e.sortTag),I(1),S("ngModel",e.sortOrder),I(7),S("ngModel",e.dataTag)}}function u9(t,n){if(1&t&&(je(0),q(1),He()),2&t){const e=H(3);I(1),Bl("",e.sortTag," (",e.sortOrderName,")")}}function d9(t,n){1&t&&(je(0),q(1,"-"),He())}function h9(t,n){if(1&t){const e=et();je(0),T(1,"table",26)(2,"tr")(3,"th",27),q(4,"\u4e26\u3073\u9806:"),P(),T(5,"td",27),Q(6,u9,2,2,"ng-container",2),Q(7,d9,2,0,"ng-container",2),P(),T(8,"td")(9,"button",24),de("click",function(){return Me(e),ke(H(2).toggleEdit())}),T(10,"i",25),q(11,"settings"),P(),q(12,"\u8a2d\u5b9a"),P()()()(),He()}if(2&t){const e=H(2);I(6),S("ngIf",0<e.sortTag.length),I(1),S("ngIf",e.sortTag.length<1)}}function f9(t,n){if(1&t&&(Q(0,c9,18,3,"ng-container",2),Q(1,h9,13,2,"ng-container",2)),2&t){const e=H();S("ngIf",e.isEdit),I(1),S("ngIf",!e.isEdit)}}function p9(t,n){if(1&t){const e=et();T(0,"button",35),de("click",function(r){Me(e);const o=H().gameObject;return ke(H().onContextMenu(r,o))}),T(1,"i",36),q(2,"settings"),P()()}}function g9(t,n){1&t&&(Le(0,"img",37),Zt(1,"safe")),2&t&&S("src",Yt(1,1,H().gameObject.imageFile.url,"resourceUrl"),Xn)}function m9(t,n){1&t&&wn(0)}const _9=function(t){return{dataElm:t}};function v9(t,n){if(1&t&&(je(0),Q(1,m9,1,0,"ng-container",10),He()),2&t){const e=n.$implicit;H(3);const i=Pt(13);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,_9,e))}}function y9(t,n){if(1&t&&(T(0,"div"),Q(1,v9,2,4,"ng-container",38),P()),2&t){const e=H().gameObject,i=H();I(1),S("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function b9(t,n){if(1&t&&(T(0,"div",28)(1,"div",29),q(2),Q(3,p9,3,0,"button",30),P(),T(4,"div",31)(5,"div",32),Q(6,g9,2,4,"img",33),P(),T(7,"div",34),Q(8,y9,2,2,"div",2),P()()()),2&t){const e=n.gameObject,i=H();I(2),Gn("",e.name," "),I(1),S("ngIf",i.selectedIdentifier===e.identifier),I(3),S("ngIf",e.imageFile.url),I(2),S("ngIf",e.rootDataElement)}}function C9(t,n){1&t&&(je(0),Le(1,"br"),He())}function w9(t,n){if(1&t){const e=et();je(0),T(1,"div",44)(2,"div",45),q(3),P(),T(4,"input",46),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),P()(),T(5,"div",44)(6,"input",47),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),Zt(7,"safe"),P()(),He()}if(2&t){const e=H(2).dataElm;I(3),gt(e.name),I(1),S("ngModel",e.currentValue),I(2),Cr(Yt(7,6,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),S("ngModel",e.currentValue)}}function E9(t,n){if(1&t){const e=et();je(0),T(1,"div",48),q(2),P(),T(3,"div",49)(4,"div",50)(5,"div",51)(6,"div",52),q(7),P(),T(8,"input",53),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),P()()()(),He()}if(2&t){const e=H(2).dataElm;I(2),gt(e.name),I(5),gt(e.value),I(1),S("ngModel",e.value)}}function T9(t,n){if(1&t&&(T(0,"div",40),je(1,41),Q(2,w9,8,9,"ng-container",42),Q(3,E9,9,3,"ng-container",43),He(),P()),2&t){const e=H().dataElm;I(1),S("ngSwitch",e.attributes.type),I(1),S("ngSwitchCase","numberResource")}}function x9(t,n){if(1&t&&(Q(0,C9,2,0,"ng-container",2),Q(1,T9,4,2,"div",39)),2&t){const e=n.dataElm,i=H();S("ngIf",(null==e?null:e.name)===i.newLineString),I(1),S("ngIf",e&&e.name!==i.newLineString)}}let D9=(()=>{class t{get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===cd.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),pe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Be.instance.get(e.data.identifier)instanceof hr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",We.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=We.peerId)}),this.inventoryTypes=["table","common",We.peerId,"graveyard"]}ngOnDestroy(){pe.unregister(this)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case We.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case We.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push(gn);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:We.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),Re.play(Ee.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),Re.play(Ee.sweep)}}),o.push(gn),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),Re.play(Ee.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);Re.play(Ee.sweep)}}cloneGameObject(e){e.clone()}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(TM,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}selectGameObject(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}}return t.\u0275fac=function(e){return new(e||t)(J(Ai),J(hn),J(ov),J(fr),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[3,"src",4,"ngIf"],[1,"table-cell"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(T(0,"div",0),Q(1,JH,1,0,"ng-container",1),Q(2,e9,1,0,"ng-container",1),Q(3,t9,2,1,"div",2),Q(4,o9,2,7,"div",3),Q(5,s9,3,1,"div",4),P(),Q(6,l9,3,1,"ng-template",null,5,Un),Q(8,f9,2,2,"ng-template",null,6,Un),Q(10,b9,9,4,"ng-template",null,7,Un),Q(12,x9,2,2,"ng-template",null,8,Un)),2&e){const r=Pt(7),o=Pt(9);I(1),S("ngTemplateOutlet",r),I(1),S("ngTemplateOutlet",o),I(1),S("ngIf",i.getGameObjects(i.selectTab).length<1),I(1),S("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),I(1),S("ngIf","graveyard"===i.selectTab)}},dependencies:[li,Vn,pn,wu,Ea,bu,Cu,Yl,Hs,Gs,Pi,ql,Da,_s,Iu,qi,$l,Ni,js,ni],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}"],changeDetection:0}),t})();const S9=en.create("./assets/images/skeleton.png");let yc=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof en?e:Et.instance.get(e);return i&&!i.isEmpty?i:S9}getEmptyOr(e){let i=e instanceof en?e:Et.instance.get(e);return i&&!i.isEmpty?i:en.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function M9(t,n){if(1&t&&(T(0,"option",8),q(1),P()),2&t){const e=n.$implicit;vn("value",e.identifier),I(1),gt(e.name)}}function k9(t,n){if(1&t){const e=et();T(0,"div")(1,"button",29),de("click",function(){return Me(e),ke(H(2).openBgImageModal())}),q(2,"\u753b\u50cf\u3092\u8ffd\u52a0"),P()()}if(2&t){const e=H(2);I(1),S("disabled",!e.isEditable)}}function I9(t,n){if(1&t){const e=et();T(0,"div",2),de("click",function(){return Me(e),ke(H(2).openBgImageModal())}),Le(1,"img",30),Zt(2,"safe"),P()}if(2&t){const e=H(2);I(1),S("src",Yt(2,1,e.tableBackgroundImage.url,"resourceUrl"),Xn)}}function O9(t,n){if(1&t){const e=et();T(0,"div")(1,"button",29),de("click",function(){return Me(e),ke(H(2).openDistanceViewImageModal())}),q(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),P()()}if(2&t){const e=H(2);I(1),S("disabled",!e.isEditable)}}function A9(t,n){if(1&t){const e=et();T(0,"div",2),de("click",function(){return Me(e),ke(H(2).openDistanceViewImageModal())}),Le(1,"img",30),Zt(2,"safe"),P()}if(2&t){const e=H(2);I(1),S("src",Yt(2,1,e.tableDistanceviewImage.url,"resourceUrl"),Xn)}}function P9(t,n){if(1&t&&(T(0,"div",36),q(1),P()),2&t){const e=H(3);I(1),Gn("",e.progresPercent,"%")}}const F9=function(t){return{"is-hidden":t}};function N9(t,n){if(1&t){const e=et();je(0),T(1,"button",31),de("click",function(){return Me(e),ke(H(2).save())}),T(2,"div",32)(3,"div",33),q(4,"\u4fdd\u5b58"),P(),Q(5,P9,2,1,"div",34),P()(),T(6,"button",35),de("click",function(){return Me(e),ke(H(2).delete())}),q(7,"\u524a\u9664"),P(),He()}if(2&t){const e=H(2);I(1),S("disabled",e.isSaveing),I(2),S("ngClass",dt(4,F9,e.isSaveing)),I(2),S("ngIf",e.isSaveing),I(1),S("disabled",e.getGameTables().length<=1)}}function R9(t,n){if(1&t){const e=et();je(0),T(1,"button",2),de("click",function(){return Me(e),ke(H(2).restore())}),q(2,"\u5143\u306b\u623b\u3059"),P(),He()}}function L9(t,n){if(1&t){const e=et();je(0),T(1,"div",9)(2,"div"),q(3," \u753b\u50cf "),Q(4,k9,3,1,"div",7),Q(5,I9,3,4,"div",10),P(),T(6,"div"),q(7," \u80cc\u666f "),Q(8,O9,3,1,"div",7),Q(9,A9,3,4,"div",10),P()(),T(10,"div"),q(11,"Name : "),T(12,"input",11),de("ngModelChange",function(r){return Me(e),ke(H().tableName=r)}),P()(),T(13,"div")(14,"input",12),de("ngModelChange",function(r){return Me(e),ke(H().tableWidth=r)}),P(),q(15," Width : "),T(16,"input",13),de("ngModelChange",function(r){return Me(e),ke(H().tableWidth=r)}),P()(),T(17,"div")(18,"input",14),de("ngModelChange",function(r){return Me(e),ke(H().tableHeight=r)}),P(),q(19," Height : "),T(20,"input",13),de("ngModelChange",function(r){return Me(e),ke(H().tableHeight=r)}),P()(),T(21,"div"),q(22," \u30b0\u30ea\u30c3\u30c9: "),T(23,"select",15),de("ngModelChange",function(r){return Me(e),ke(H().tableGridType=r)}),T(24,"option",16),q(25,"\u306a\u3057"),P(),T(26,"option",17),q(27,"\u30b9\u30af\u30a8\u30a2"),P(),T(28,"option",18),q(29,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),P(),T(30,"option",19),q(31,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),P()(),q(32," \u8272: "),T(33,"select",20),de("ngModelChange",function(r){return Me(e),ke(H().tableGridColor=r)}),T(34,"option",21),q(35,"\u9ed2"),P(),T(36,"option",22),q(37,"\u767d"),P()()(),T(38,"div"),q(39," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),T(40,"select",23),de("ngModelChange",function(r){return Me(e),ke(H().tableDistanceviewFilter=r)}),T(41,"option",24),q(42,"\u306a\u3057"),P(),T(43,"option",25),q(44,"\u30db\u30ef\u30a4\u30c8"),P(),T(45,"option",26),q(46,"\u30d6\u30e9\u30c3\u30af"),P()()(),Le(47,"hr"),T(48,"div")(49,"label"),q(50,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),T(51,"input",27),de("ngModelChange",function(r){return Me(e),ke(H().tableGridShow=r)}),P()(),T(52,"label"),q(53,"\u30b9\u30ca\u30c3\u30d7: "),T(54,"input",28),de("ngModelChange",function(r){return Me(e),ke(H().tableGridSnap=r)}),P()(),Q(55,N9,8,6,"ng-container",7),Q(56,R9,3,0,"ng-container",7),P(),He()}if(2&t){const e=H();I(4),S("ngIf",!e.tableBackgroundImage.url),I(1),S("ngIf",e.tableBackgroundImage.url),I(3),S("ngIf",!e.tableDistanceviewImage.url),I(1),S("ngIf",e.tableDistanceviewImage.url),I(3),S("ngModel",e.tableName)("disabled",!e.isEditable),I(2),vn("min",e.minSize),vn("max",e.maxSize),S("ngModel",e.tableWidth)("disabled",!e.isEditable),I(2),vn("min",e.minSize),vn("max",e.maxSize),S("ngModel",e.tableWidth)("disabled",!e.isEditable),I(2),vn("min",e.minSize),vn("max",e.maxSize),S("ngModel",e.tableHeight)("disabled",!e.isEditable),I(2),vn("min",e.minSize),vn("max",e.maxSize),S("ngModel",e.tableHeight)("disabled",!e.isEditable),I(3),S("ngModel",e.tableGridType)("disabled",!e.isEditable),I(10),S("ngModel",e.tableGridColor)("disabled",!e.isEditable),I(7),S("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),I(11),S("ngModel",e.tableGridShow),I(3),S("ngModel",e.tableGridSnap),I(1),S("ngIf",!e.isDeleted),I(1),S("ngIf",e.isDeleted)}}function B9(t,n){1&t&&(je(0),T(1,"div",37),q(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),P(),He())}let xM=(()=>{class t{get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,pe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Ms.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Be.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,pe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Be.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngOnDestroy(){pe.unregister(this)}selectGameTable(e){pe.call("SELECT_GAME_TABLE",{identifier:e},We.peerId),this.selectedTable=Be.instance.get(e),this.selectedTableXml=""}getGameTables(){return Be.instance.getObjects(ui)}createGameTable(){let e=new ui;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,Mt.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=xn.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(lp).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(lp,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}}return t.\u0275fac=function(e){return new(e||t)(J(Bi),J(kr),J(yc),J(hn))},t.\u0275cmp=Wt({type:t,selectors:[["game-table-setting"]],decls:11,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],["select",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[1,"images-select"],[3,"click",4,"ngIf"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"height","120px",3,"disabled","click"],["height","120",3,"src"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();T(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),de("click",function(){return i.createGameTable()}),q(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),P()(),T(5,"select",3,4),de("change",function(){Me(r);const s=Pt(6);return ke(i.selectGameTable(s.value))}),Q(7,M9,2,2,"option",5),P()(),T(8,"div",6),Q(9,L9,57,32,"ng-container",7),P()(),Q(10,B9,3,0,"ng-container",7)}2&e&&(I(5),S("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),I(2),S("ngForOf",i.getGameTables()),I(2),S("ngIf",i.selectedTable),I(1),S("ngIf",i.isEmpty))},dependencies:[li,Vn,pn,Hs,Gs,Pi,ql,Da,s_,_s,qi,x_,T_,Ni,ni],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();function z9(t,n){if(1&t){const e=et();T(0,"button",10),de("click",function(){Me(e);const r=H().$implicit;return ke(H().play(r))}),q(1,"\u8a66\u8074/\u518d\u751f"),P()}2&t&&S("disabled",!H().$implicit.isReady)}function U9(t,n){if(1&t){const e=et();T(0,"button",10),de("click",function(){return Me(e),ke(H(2).stop())}),q(1,"\u8a66\u8074/\u505c\u6b62"),P()}2&t&&S("disabled",!H().$implicit.isReady)}function V9(t,n){if(1&t){const e=et();T(0,"button",10),de("click",function(){Me(e);const r=H().$implicit;return ke(H().playBGM(r))}),q(1,"BGM/\u518d\u751f"),P()}2&t&&S("disabled",!H().$implicit.isReady)}function j9(t,n){if(1&t){const e=et();T(0,"button",10),de("click",function(){Me(e);const r=H().$implicit;return ke(H().stopBGM(r))}),q(1,"BGM/\u505c\u6b62"),P()}2&t&&S("disabled",!H().$implicit.isReady)}function H9(t,n){1&t&&(T(0,"span"),q(1,"\u3010\u8a66\u8074\u4e2d\u3011"),P())}function G9(t,n){1&t&&(T(0,"span"),q(1,"\u3010BGM\u3011"),P())}function $9(t,n){if(1&t&&(T(0,"div",8),Q(1,z9,2,1,"button",9),Q(2,U9,2,1,"button",9),Q(3,V9,2,1,"button",9),Q(4,j9,2,1,"button",9),Q(5,H9,2,0,"span",2),Q(6,G9,2,0,"span",2),T(7,"span"),q(8),P()()),2&t){const e=n.$implicit,i=H();I(1),S("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),I(1),S("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),I(1),S("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),I(1),S("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),I(1),S("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),I(1),S("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),I(2),gt(e.name)}}function W9(t,n){1&t&&(T(0,"div"),q(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),P())}let Z9=(()=>{class t{get volume(){return it.volume}set volume(e){it.volume=e}get auditionVolume(){return it.auditionVolume}set auditionVolume(e){it.auditionVolume=e}get audios(){return at.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Be.instance.get("Jukebox")}constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new it,this.lazyUpdateTimer=null}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=pc.AUDITION,pe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){pe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Yo.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(J(Bi),J(hn),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["app-jukebox"]],decls:29,vars:4,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModel","ngModelChange"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,i){1&e&&(T(0,"div"),q(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),T(2,"input",0),de("ngModelChange",function(o){return i.auditionVolume=o}),P()(),T(3,"div"),q(4,"BGM\u97f3\u91cf\uff1a"),T(5,"input",0),de("ngModelChange",function(o){return i.volume=o}),P()(),Le(6,"hr"),T(7,"div"),Q(8,$9,9,7,"div",1),Q(9,W9,2,0,"div",2),P(),T(10,"label")(11,"div",3)(12,"div")(13,"i",4),q(14,"playlist_add"),P()(),T(15,"div"),q(16,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),P(),T(17,"div",5),q(18,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),P(),T(19,"input",6),de("change",function(o){return i.handleFileSelect(o)}),P(),T(20,"div",5),Le(21,"br"),q(22,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),P()()(),T(23,"div",7),q(24,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),P(),T(25,"div",7),q(26,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),P(),T(27,"div",7),q(28,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),P()),2&e&&(I(2),S("ngModel",i.auditionVolume),I(3),S("ngModel",i.volume),I(3),S("ngForOf",i.audios),I(1),S("ngIf",i.audios.length<1))},dependencies:[Vn,pn,Pi,Da,qi,Ni],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),t})();const Y9=["content"],q9=["*"];let K9=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&An(Y9,7,ar),2&e){let r;On(r=Pn())&&(i.content=r.first)}},ngContentSelectors:q9,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(Kg(),T(0,"div",0)(1,"div",1),de("click",function(o){return i.clickBackground(o)}),P(),T(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),de("click",function(){return i.resolve()}),T(6,"i",6),q(7,"close"),P()()(),q(8),P(),T(9,"div",7),Xg(10),Le(11,"div",null,8),P()()()),2&e&&(I(1),S("@bgInOut","in"),I(1),S("@flyInOut","in"),I(6),Gn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Ao("flyInOut",[bi("void => *",[yi("100ms ease-out",go([wt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),wt({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),bi("* => void",[yi(100,wt({transform:"scale(0, 0)"}))])]),Ao("bgInOut",[RT("in",wt({"background-color":"rgba(30, 30, 30, 0.4)"})),bi("void => *",[wt({"background-color":"rgba(30, 30, 30, 0.0)"}),yi(200)]),bi("* => void",[yi(200,wt({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();const X9=["passwordInput"],Q9=function(){return{standalone:!0}};let J9=(()=>{class t{get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeers=[],this.title="",this.targetPeers=i.option.peers??[],this.title=i.option.title?i.option.title:""}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),pe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){pe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeers.find(e=>e.verifyPassword(this.password))&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&An(X9,7),2&e){let r;On(r=Pn())&&(i.passwordInputElementRef=r.first)}},decls:12,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["input","","passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();T(0,"form",null,0)(2,"div"),q(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),T(4,"input",1,2),de("ngModelChange",function(s){return i.password=s})("input",function(){Me(r);const s=Pt(5);return ke(i.onInputChange(s.value))}),P()(),T(7,"button",3),de("click",function(){return i.submit()}),q(8,"\u5165\u5ba4"),P()(),T(9,"div")(10,"span",4),q(11),P()()}2&e&&(I(4),S("ngModel",i.password)("ngModelOptions",Ca(3,Q9)),I(7),gt(i.help))},dependencies:[Yl,Pi,qi,$l,Ni,js],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function e7(t,n){if(1&t&&(T(0,"div")(1,"div",9),q(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),P(),T(3,"div",9),q(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),P(),T(5,"div",9),q(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),P()()),2&t){H();const e=Pt(5);I(1),S("hidden",!e.errors.required),I(2),S("hidden",!e.errors.minlength),I(2),S("hidden",!e.errors.maxlength)}}function t7(t,n){if(1&t&&(T(0,"div")(1,"div",9),q(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),P()()),2&t){H();const e=Pt(10);I(1),S("hidden",!e.errors.maxlength)}}function n7(t,n){1&t&&(T(0,"div"),q(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),P())}function i7(t,n){if(1&t){const e=et();T(0,"div")(1,"div"),q(2,"\u30eb\u30fc\u30e0\u540d : "),T(3,"input",3,4),de("input",function(){Me(e);const r=Pt(4),o=H();return ke(o.calcPeerId(r.value,o.password))})("ngModelChange",function(r){return Me(e),ke(H().roomName=r)}),P()(),T(6,"div"),q(7,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),T(8,"input",5,6),de("input",function(){Me(e);const r=Pt(4),o=H();return ke(o.calcPeerId(o.roomName,r.value))})("ngModelChange",function(r){return Me(e),ke(H().password=r)}),P()(),Le(11,"hr"),Q(12,e7,7,3,"div",7),Q(13,t7,3,1,"div",7),Q(14,n7,2,0,"div",7),T(15,"div")(16,"button",8),de("click",function(){return Me(e),ke(H().createRoom())}),q(17,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),P()()()}if(2&t){const e=Pt(5),i=Pt(10),r=H();I(3),S("ngModel",r.roomName),I(5),S("ngModel",r.password),I(4),S("ngIf",e.errors&&(e.dirty||e.touched)),I(1),S("ngIf",i.errors&&(i.dirty||i.touched)),I(1),S("ngIf",!r.validateLength),I(2),S("disabled",!e.valid||!i.valid||!r.validateLength)}}function r7(t,n){1&t&&(T(0,"span",1),q(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Le(2,"br"),q(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Le(4,"br"),q(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),P())}let o7=(()=>{class t{get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),pe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){pe.unregister(this)}calcPeerId(e,i){let o=Tn.create(We.peer.userId,Tn.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){We.open(We.peer.userId,Tn.generateId("***"),this.roomName,this.password),Rt.myCursor.peerId=We.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["input","","roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["input","","passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Q(0,i7,18,6,"div",0),T(1,"div")(2,"span",1),q(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P()(),Q(4,r7,6,0,"ng-template",null,2,Un)),2&e){const r=Pt(5);S("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[pn,Pi,qi,ff,D_,S_,Ni],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function s7(t,n){1&t&&(T(0,"td")(1,"i",11),q(2,"lock"),P()())}function a7(t,n){1&t&&(T(0,"td"),q(1,"-"),P())}function l7(t,n){if(1&t){const e=et();T(0,"button",12),de("click",function(){Me(e);const r=H().$implicit;return ke(H(3).connect(r))}),q(1,"\u63a5\u7d9a"),P()}if(2&t){const e=H().$implicit,i=H(3);S("disabled",e.id===i.currentRoom)}}function c7(t,n){if(1&t&&(je(0),T(1,"tr")(2,"td",9),q(3),P(),T(4,"td",7),q(5),P(),Q(6,s7,3,0,"td",4),Q(7,a7,2,0,"td",4),T(8,"td"),q(9),P(),T(10,"td"),Q(11,l7,2,1,"button",10),P()(),He()),2&t){const e=n.$implicit;I(3),gt(e.id),I(2),gt(e.name),I(1),S("ngIf",e.hasPassword),I(1),S("ngIf",!e.hasPassword),I(2),Gn("",e.peers.length,"\u4eba"),I(2),S("ngIf",0<e.id.length)}}function u7(t,n){if(1&t&&(je(0),T(1,"table",6)(2,"tr")(3,"th"),q(4,"\u30eb\u30fc\u30e0ID"),P(),T(5,"th",7),q(6,"\u30eb\u30fc\u30e0\u540d"),P(),T(7,"th"),q(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),P(),T(9,"th"),q(10,"\u53c2\u52a0\u8005"),P(),Le(11,"th"),P(),Q(12,c7,12,6,"ng-container",8),P(),He()),2&t){const e=H(2);I(12),S("ngForOf",e.rooms)}}function d7(t,n){if(1&t&&(T(0,"span",13),q(1),P()),2&t){const e=H(2);I(1),gt(e.help)}}function h7(t,n){if(1&t){const e=et();T(0,"div")(1,"button",2),de("click",function(){return Me(e),ke(H().reload())}),q(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),P(),T(3,"button",3),de("click",function(){return Me(e),ke(H().showRoomSetting())}),q(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),P(),Le(5,"hr"),Q(6,u7,13,1,"ng-container",4),Q(7,d7,2,1,"span",5),P()}if(2&t){const e=H();I(1),S("disabled",e.isReloading),I(5),S("ngIf",e.rooms.length),I(1),S("ngIf",e.rooms.length<1)}}function f7(t,n){1&t&&(T(0,"span",13),q(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Le(2,"br"),q(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),P())}let p7=(()=>{class t{get currentRoom(){return We.peer.roomId}get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),pe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",We.peer.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+We.peer.roomName+"/"+We.peer.roomId+"\uff1e")}ngOnDestroy(){pe.unregister(this)}reload(){var e=this;return(0,Mt.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=yield We.listAllRooms(),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,Mt.Z)(function*(){let r="";e.hasPassword&&(r=yield i.modalService.open(J9,{peers:e.peers,title:`${e.name}/${e.id}`}),null==r&&(r=""));let o=e.filterByPassword(r);if(o.length<1)return;We.open(We.peer.userId,e.id,e.name,r),Rt.myCursor.peerId=We.peerId;let a=[];pe.register(a).on("OPEN_NETWORK",l=>{console.log("LobbyComponent OPEN_PEER",l.data.peerId),pe.unregister(a),Be.instance.clearDeleteHistory();for(let c of o)We.connect(c);pe.register(a).on("CONNECT_PEER",c=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",c.data.peerId),a.push(c.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+o.length),o.length<=a.length&&(i.resetNetwork(),pe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",c=>{console.warn("\u63a5\u7d9a\u5931\u6557",c.data.peerId),a.push(c.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+o.length),o.length<=a.length&&(i.resetNetwork(),pe.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){We.peers.length<1&&(We.open(),Rt.myCursor.peerId=We.peerId)}closeIfConnected(){0<We.peers.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,Mt.Z)(function*(){yield e.modalService.open(o7,{width:700,height:400,left:0,top:400}),e.modalService.resolve(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Q(0,h7,8,3,"div",0),Q(1,f7,4,0,"ng-template",null,1,Un)),2&e){const r=Pt(2);S("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[Vn,pn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();function g7(t,n){if(1&t){const e=et();T(0,"div",8),de("click",function(){return Me(e),ke(H(2).changeIcon())}),Zt(1,"safe"),P()}2&t&&dn("background-image",Yt(1,2,"url("+H(2).myPeer.image.url+")","style"))}function m7(t,n){if(1&t){const e=et();T(0,"div")(1,"button",5),de("click",function(){return Me(e),ke(H().changeIcon())}),q(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),P(),Q(3,g7,2,5,"div",6),T(4,"span"),q(5,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a "),T(6,"input",7),de("ngModelChange",function(r){return Me(e),ke(H().myPeer.name=r)}),P()()()}if(2&t){const e=H();I(3),S("ngIf",e.myPeer.image),I(3),S("ngModel",e.myPeer.name)}}function _7(t,n){if(1&t&&(T(0,"span",9),q(1),P()),2&t){const e=H();I(1),gt(e.networkService.peer.userId)}}function v7(t,n){1&t&&(T(0,"span",9),q(1,"???"),P())}function y7(t,n){if(1&t&&(T(0,"span",9),q(1),P()),2&t){const e=H(2);I(1),Bl("",e.networkService.peer.roomName,"/",e.networkService.peer.roomId,"")}}function b7(t,n){if(1&t&&(T(0,"span",9),q(1),P()),2&t){const e=H(3);I(1),gt(e.isPasswordVisible?e.networkService.peer.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function C7(t,n){if(1&t){const e=et();T(0,"span"),Q(1,b7,2,1,"span",1),T(2,"button",10),de("click",function(){return Me(e),ke(H(2).togglePasswordVisibility())}),T(3,"span",11),q(4),P()()()}if(2&t){const e=H(2);I(1),S("ngIf",e.networkService.isOpen),I(3),gt(e.isPasswordVisible?"visibility":"visibility_off")}}function w7(t,n){if(1&t&&(je(0),Le(1,"hr"),T(2,"div")(3,"span"),q(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Q(5,y7,2,2,"span",1),P()(),T(6,"div")(7,"span"),q(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Q(9,C7,5,2,"span",0),P()(),He()),2&t){const e=H();I(5),S("ngIf",e.networkService.isOpen),I(4),S("ngIf",e.networkService.peer.hasPassword)}}function E7(t,n){1&t&&(T(0,"span"),q(1,"[\u63a5\u7d9a\u4e2d]"),P())}function T7(t,n){if(1&t&&(T(0,"div")(1,"div"),Q(2,E7,2,0,"span",0),T(3,"span"),q(4),P()()()),2&t){const e=n.$implicit,i=H();I(2),S("ngIf",!e.isOpen),I(2),Bl("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"]")}}function x7(t,n){if(1&t){const e=et();je(0),T(1,"input",12),de("ngModelChange",function(r){return Me(e),ke(H().targetUserId=r)}),P(),T(2,"button",13),de("click",function(){return Me(e),ke(H().connectPeer())}),q(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),P(),Le(4,"br"),He()}if(2&t){const e=H();I(1),S("ngModel",e.targetUserId),I(1),S("disabled",!e.networkService.isOpen)}}function D7(t,n){if(1&t){const e=et();T(0,"button",13),de("click",function(){return Me(e),ke(H().showLobby())}),q(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),P()}2&t&&S("disabled",!H().networkService.isOpen)}function S7(t,n){1&t&&(T(0,"div",4),q(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),P())}function M7(t,n){1&t&&(T(0,"div",4),q(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),P())}function k7(t,n){if(1&t&&(je(0),Q(1,S7,2,0,"div",14),Q(2,M7,2,0,"div",14),He()),2&t){const e=H();I(1),S("ngIf",e.networkService.peers.length<1),I(1),S("ngIf",e.networkService.peers.length<1)}}function I7(t,n){1&t&&(je(0),T(1,"div",4),q(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),P(),He())}let DM=(()=>{class t{get myPeer(){return Rt.myCursor}constructor(e,i,r,o){this.ngZone=e,this.modalService=i,this.panelService=r,this.appConfigService=o,this.targetUserId="",this.networkService=We,this.gameRoomService=Be.instance,this.help="",this.isPasswordVisible=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){pe.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})})}ngOnDestroy(){pe.unregister(this)}changeIcon(){this.modalService.open(lp).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=Tn.create(e);i.isRoom||(Be.instance.clearDeleteHistory(),We.connect(i))}showLobby(){this.modalService.open(p7,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}findUserId(e){const i=Rt.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Rt.findByPeerId(e);return i?i.name:""}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Bi),J(hn),J(X0))},t.\u0275cmp=Wt({type:t,selectors:[["peer-menu"]],decls:17,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",3,"ngModel","ngModelChange"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","ngModelChange"],[3,"disabled","click"],["style","font-size: 12px;",4,"ngIf"]],template:function(e,i){1&e&&(Q(0,m7,7,2,"div",0),T(1,"div")(2,"span"),q(3,"\u3042\u306a\u305f\u306eID\uff1a"),Q(4,_7,2,1,"span",1),Q(5,v7,2,0,"span",1),P()(),Q(6,w7,10,2,"ng-container",0),Le(7,"hr"),Q(8,T7,5,3,"div",2),T(9,"div"),Q(10,x7,5,2,"ng-container",0),Q(11,D7,2,1,"button",3),P(),T(12,"div")(13,"span",4),q(14),P()(),Q(15,k7,3,2,"ng-container",0),Q(16,I7,3,0,"ng-container",0)),2&e&&(S("ngIf",i.myPeer),I(4),S("ngIf",i.networkService.isOpen),I(1),S("ngIf",!i.networkService.isOpen),I(1),S("ngIf",i.networkService.peer.isRoom),I(2),S("ngForOf",i.networkService.peers),I(2),S("ngIf",!i.networkService.peer.isRoom),I(1),S("ngIf",i.networkService.peers.length<1),I(3),gt(i.help),I(1),S("ngIf",!i.networkService.peer.isRoom),I(1),S("ngIf",i.networkService.peer.isRoom))},dependencies:[Vn,pn,Pi,qi,Ni,ni],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}"]}),t})();const hd=-9999;class ia{get startPointer(){return this.firstPointer}get pointer(){return this.primaryPointer}get magnitude(){return on.sqrMagnitude(this.firstPointer,this.primaryPointer)}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isPointerMoved(){return this._isPointerMoved}get isDestroyed(){return this._isDestroyed}constructor(...n){this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.startTime=-1e3,this.clearLastPointerTimer=new Bo(this.clearLastPointer.bind(this),2e3,!1),this.firstPointer={x:0,y:0,z:0,identifier:hd},this.lastStartPointers=[],this.lastMovePointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:hd},this._isDragging=!1,this._isGrabbing=!1,this._isPointerMoved=!1,this._isDestroyed=!1;let e=n[0],i={capture:!1,passive:!1,always:!1},r=!0;switch(n.length){case 3:i=n[1],r=n[2];break;case 2:"boolean"==typeof n[1]?r=n[1]:i=n[1]}this.target=e,this.option={capture:!0===i.capture,passive:!0===i.passive,always:!0===i.always},r&&this.initialize()}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this.clearLastPointerTimer.clear(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners(),this.onStart=null,this.onMove=null,this.onEnd=null,this.onContextMenu=null}cancel(){this._isDragging=this._isGrabbing=!1,this.clearLastPointerTimer.reset(),this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:hd};this.isSyntheticEvent(n)?this.updateLastPointer(n):(this.updateLastPointer(n),this.primaryPointer=e,this.onPointer(n))}onTouch(n){if(!(n.changedTouches.length<1)){if(this.updateLastPointer(n),"touchstart"===n.type)this.primaryPointer=this.lastStartPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this.onTap&&(this.startTime=performance.now()),this.clearLastPointerTimer.stop(),this.firstPointer=this.primaryPointer,this._isGrabbing=!0,this._isDragging=!1,this._isPointerMoved=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing,this._isPointerMoved=this._isPointerMoved||(n instanceof MouseEvent?3:12)**2<on.sqrMagnitude(this.firstPointer,this.primaryPointer);break;default:this.onEnd&&this.onEnd(n),this.onTap&&performance.now()-this.startTime<250&&!this._isPointerMoved&&this.onTap(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){let i={x:n.pageX,y:n.pageY,z:0,identifier:hd},r=this.lastMovePointers;"mousemove"!==n.type&&(r=r.concat(this.lastStartPointers));for(let o of r)if(o.identifier!==i.identifier&&on.sqrMagnitude(i,o)<e**2)return!0;return!1}updateLastPointer(n){let e=[];if(n instanceof MouseEvent)e.push({x:n.pageX,y:n.pageY,z:0,identifier:hd});else{let i=n.touches.length;for(let r=0;r<i;r++){let o=n.touches[r];e.push({x:o.pageX,y:o.pageY,z:0,identifier:o.identifier})}}this.lastMovePointers=e,("mousedown"===n.type||"touchstart"===n.type)&&(this.lastStartPointers=e)}clearLastPointer(){this.clearLastPointerTimer.stop(),this.lastStartPointers=[],this.lastMovePointers=[]}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let SM=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new Ht,this.onmove=new Ht,this.onend=new Ht,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new ia(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():e.stopPropagation()}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<on.sqrMagnitude(i)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>on.sqrMagnitude(this.input.pointer,this.startPointer))return;let r=o=>{o.cancelable&&o.preventDefault(),o.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y)),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Yn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Yn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Bn))},t.\u0275dir=vt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})();var sn=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(sn||(sn={})),sn))();class O7{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new ia(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case sn.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case sn.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case sn.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case sn.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case sn.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2";break;case sn.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case sn.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case sn.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let A7=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Ht,this.onmove=new Ht,this.onend=new Ht,this.handleMap=new Map,this.handleTypes=[sn.N,sn.E,sn.W,sn.S,sn.NE,sn.NW,sn.SE,sn.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new O7(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case sn.N:case sn.S:r.width=0;break;case sn.E:case sn.W:r.height=0}switch(i.type){case sn.SW:r.left=r.width,r.width*=-1;break;case sn.NE:r.top=r.height,r.height*=-1;break;case sn.E:case sn.S:case sn.SE:break;case sn.N:case sn.W:case sn.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Yn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Yn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Yn.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Yn.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Bn))},t.\u0275dir=vt({type:t,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const P7=["draggablePanel"],F7=["scrollablePanel"],N7=["content"];function R7(t,n){if(1&t){const e=et();T(0,"div",7)(1,"button",8),de("click",function(){return Me(e),ke(H().toggleFullScreen())}),T(2,"i",9),q(3,"fullscreen"),P()(),T(4,"button",8),de("click",function(){return Me(e),ke(H().close())}),T(5,"i",9),q(6,"close"),P()()()}}const L7=function(t){return{"pointer-events-none":t}},B7=["*"];let MM=(()=>{class t{set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleFullScreen(){let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(An(P7,7),An(F7,7),An(N7,7,ar)),2&e){let r;On(r=Pn())&&(i.draggablePanel=r.first),On(r=Pn())&&(i.scrollablePanel=r.first),On(r=Pn())&&(i.content=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[En([hn])],ngContentSelectors:B7,decls:10,vars:16,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["class","title-button",4,"ngIf"],[1,"scrollable-panel"],["scrollablePanel",""],["content",""],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(e,i){1&e&&(Kg(),T(0,"div",0,1)(2,"div",2),Q(3,R7,7,0,"div",3),q(4),P(),T(5,"div",4,5),Xg(7),Le(8,"div",null,6),P()()),2&e&&(dn("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),S("@flyInOut","in")("ngClass",dt(14,L7,i.isPointerDragging))("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),I(3),S("ngIf",i.showTitleButtons),I(1),Gn(" ",i.panelService.title," "))},dependencies:[li,pn,SM,A7],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[Ao("flyInOut",[bi("void => *",[yi("100ms ease-out",go([wt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),wt({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),bi("* => void",[yi(100,wt({transform:"scale(0, 0)"}))])])]}}),t})();class z7{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=Ss.SQUARE,o="#000000e6"){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let s=this.canvasElement.getContext("2d");if(r<0)return;let a=this.generateCalcGridPositionFunc(r);this.makeBrush(s,i,o);for(let l=0;l<=e;l++)for(let c=0;c<=n;c++){let{gx:u,gy:h}=a(c,l,i);this.strokeSquare(s,u,h,i),s.fillText((c+1).toString()+"-"+(l+1).toString(),u+i/2,h+i/2)}}generateCalcGridPositionFunc(n){switch(n){case Ss.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case Ss.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===Ss.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,c=i+r/2;n.beginPath();for(let u=0;u<6;u++){s+=60;let h=on.radians(s),g=Math.cos(h)*a+l,E=Math.sin(h)*a+c;n.lineTo(g,E)}n.closePath(),n.stroke()}}var Ka=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(Ka||(Ka={})),Ka))(),qr=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(qr||(qr={})),qr))();class U7{get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}initialize(){this.input=new ia(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,c=0,h=0,g=Ka.DRAG;2===this.buttonCode?(g=Ka.ROTATE,h=-r/5,c=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,c,0,h,g,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Ka.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,l=this.getKeyName(n);switch(l){case qr.ArrowLeft:n.shiftKey?a=-2:e=10;break;case qr.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case qr.ArrowRight:n.shiftKey?a=2:e=-10;break;case qr.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=qr[l]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Ka.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return qr.ArrowLeft;case 38:return qr.ArrowUp;case 39:return qr.ArrowRight;case 40:return qr.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}class V7{get isActive(){return this.pointerDevice.isTablePickGesture}set isActive(n){this.pointerDevice.isTablePickGesture=n}constructor(n,e,i,r,o,s){this.targetElement=n,this.gameObjectsElement=e,this.pointerDevice=o,this.selection=s,this.pickCursorScale=1,this.input=null,this.activateTimer=null,this.keydownTimer=null,this.tappedTimer=null,this.tappedPointer={x:0,y:0,z:0},this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.callbackOnKeydown=a=>this.onKeydown(a),this.onstart=null,this.onend=null,this.oncancelifneeded=null,this.onpick=null,this.pickCursor=new j7(i),this.pickArea=new H7(r),this.initialize()}initialize(){this.input=new ia(this.targetElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onTap=this.onInputTap.bind(this)}cancel(){this.input.cancel(),this.clearActivateTimer(),this.pickCursor.deactive(),this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isActive=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.clearKeyDownTimer(),this.clearTappedTimer()}destroy(){this.cancel(),this.input.destroy(),this.clearKeyDownTimer(),this.clearTappedTimer()}onInputStart(n){if(this.target=null,this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.clearActivateTimer(),this.pickCursor.update(this.input.pointer),!(n instanceof MouseEvent&&0===n.button||n.touches))return this.cancel();this.isStrokeMode=n instanceof MouseEvent&&0===n.button&&n.ctrlKey;let i=n instanceof MouseEvent&&0===n.button&&n.shiftKey;this.isStrokeMode||i?this.startQuickCursor(n):this.startLongPressCursor(n)}onInputMove(n){let e=1<n.touches?.length,i=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||i<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,null==this.keydownTimer&&((e||null!=this.target&&this.isObjectDragging&&this.isPointerMoved&&!this.isMagneticMode||null!=this.activateTimer&&this.isPointerMoved)&&this.cancel(),this.isActive&&(null==this.oncancelifneeded||!this.oncancelifneeded())&&(this.pickCursor.update(this.input.pointer),this.pickCursor.scale(0),this.isPickObjectMode&&n instanceof MouseEvent&&n.ctrlKey?this.pickObject(n):this.isPointerMoved&&this.isPickRegionMode&&this.pickRegion(n),this.onpick&&this.onpick()))}onInputEnd(n){let e=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||e<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,this.onend&&this.onend(),this.cancel()}onInputTap(n){this.setTappedTimer(),this.tappedPointer=this.input.pointer}onKeydown(n){if(!this.isActive||this.input.isGrabbing)switch(n.key){case"Control":this.isStrokeMode=!0;case"Shift":this.clearActivateTimer(),this.clearKeyDownTimer(),this.target=null,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.isActive=!0,this.pickCursor.update(this.input.pointer),this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(.6),requestAnimationFrame(()=>this.pickCursor.scale(0)),this.pointerDevice.isDragging=!1,this.pickStart()}}startQuickCursor(n){this.isActive=!0,this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(1),requestAnimationFrame(()=>this.pickCursor.scale(.6)),this.isMagneticMode=!1,this.isPickObjectMode=this.isStrokeMode,this.isPickRegionMode=!this.isStrokeMode,this.pointerDevice.isDragging=!1,this.pickStart(),this.isPickObjectMode&&(this.selection.excludeElement=null,this.pickObject(n))}startLongPressCursor(n){let e=n.target;e.contains(this.gameObjectsElement)||(this.target=e),this.isMagneticMode=null!=this.target&&this.pointerDevice.isDragging&&null!=this.tappedTimer&&on.sqrMagnitude(this.tappedPointer,this.input.pointer)<625,this.isPickObjectMode=null!=this.target&&this.pointerDevice.isDragging&&!this.isMagneticMode,this.isPickRegionMode=null==this.target||!this.isPickObjectMode&&!this.isMagneticMode,!this.isPickObjectMode&&(this.setActivateTimer(),this.setKeyDownTimer(),this.pickCursorScale=n.touches?4.5:1,this.pickCursor.active(),this.pickCursor.scale(this.pickCursorScale),this.isMagneticMode&&this.pickCursor.color(fd.MAGNETIC,fd.MAGNETIC_FILL))}pickStart(){let n=new CustomEvent("pickstart",{detail:{isMagnetic:this.isMagneticMode,isPickRegion:this.isPickRegionMode,isPickObject:this.isPickObjectMode},bubbles:!0});this.target?this.target.dispatchEvent(n):document.dispatchEvent(n),this.onstart&&this.onstart()}pickObject(n){let e=n.target;if(e.contains(this.gameObjectsElement))this.selection.excludeElement=document.body;else{this.isKeepSelection=!0;let i=new CustomEvent("pickobject",{detail:{srcEvent:n,first:this.input.startPointer,last:this.input.pointer},bubbles:!0});e.dispatchEvent(i)}}pickRegion(n){let e=this.input.startPointer,i=this.input.pointer,r=Math.min(e.x,i.x),o=Math.min(e.y,i.y),s=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);this.pickArea.update(r,o,s,a),this.selection.clear();let l=new CustomEvent("pickregion",{detail:{srcEvent:n,x:r,y:o,width:s,height:a},bubbles:!0});document.dispatchEvent(l)}setActivateTimer(){this.clearActivateTimer(),this.activateTimer=setTimeout(()=>{this.activateTimer=null,this.pickCursor.scale(.6*this.pickCursorScale),this.isActive=!0,this.isKeepSelection=this.isPickObjectMode||this.isMagneticMode,this.pickStart()},850)}clearActivateTimer(){this.isActive=!1,null!=this.activateTimer&&(clearTimeout(this.activateTimer),this.activateTimer=null),this.pickArea.deactive()}setKeyDownTimer(){this.clearKeyDownTimer(),this.keydownTimer=setTimeout(()=>{this.keydownTimer=null},66),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}clearKeyDownTimer(){null!=this.keydownTimer&&(clearTimeout(this.keydownTimer),this.keydownTimer=null),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}setTappedTimer(){this.clearTappedTimer(),this.tappedTimer=setTimeout(()=>{this.tappedTimer=null},300)}clearTappedTimer(){null!=this.tappedTimer&&(clearTimeout(this.tappedTimer),this.tappedTimer=null)}}var fd=(()=>(function(t){t.SELECTED="hsl(200, 100%, 50%)",t.MAGNETIC="hsl(45, 100%, 50%)",t.SELECTED_FILL="hsla(200, 100%, 95%, .7)",t.MAGNETIC_FILL="hsla(45, 100%, 95%, .7)"}(fd||(fd={})),fd))();class j7{constructor(n){this.targetElement=n,this.width=0,this.height=0,this.circleElement=this.targetElement.querySelector("circle"),this.active();let e=this.targetElement.getBoundingClientRect();this.width=e.width,this.height=e.height,this.deactive()}active(){this.deactive(),this.targetElement.style.display="block"}deactive(){this.targetElement.style.display=null,this.targetElement.style.stroke=null,this.targetElement.style.scale=null,this.circleElement.style.animation=null,this.circleElement.style.fill=null}scale(n){this.targetElement.style.scale=n+""}color(n,e){this.targetElement.style.stroke=n,this.circleElement.style.fill=e}disableAnimation(){this.circleElement.style.animation="none"}update(n){this.targetElement.style.left=n.x-this.width/2+"px",this.targetElement.style.top=n.y-this.height/2+"px"}}class H7{constructor(n){this.targetElement=n}update(n,e,i,r){this.targetElement.style.left=n+"px",this.targetElement.style.top=e+"px",this.targetElement.style.width=i+"px",this.targetElement.style.height=r+"px",this.targetElement.style.display="block"}deactive(){this.targetElement.style.width="0px",this.targetElement.style.height="0px",this.targetElement.style.display=null}}var ra=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(ra||(ra={})),ra))();class G7{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",l=>{let c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:l.center.x,clientY:l.center.y});this.ngZone.run(()=>l.srcEvent.target.dispatchEvent(c))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<on.sqrMagnitude(this.tappedPanCenter,n.center)&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer)this.ontransform&&this.ontransform(this.deltaHammerDeltaX,this.deltaHammerDeltaY,0,0,0,0,ra.PAN,n.srcEvent);else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,ra.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,ra.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,ra.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,ra.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let hv=(()=>{class t{constructor(){}createGameCharacter(e){let i=Dn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Wo.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Et.instance.get(i);r||(r=Et.instance.add(i));let o=this.getViewTable();if(!o)return;let s=Yr.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Zo.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=$o.create(i,r,1),a=null;return s.faces.forEach(l=>{let c=`./assets/images/dice/${o}/${o}[${l}].png`;a=Et.instance.get(c),a||(a=Et.instance.add(c)),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createTrump(e){let i=pi.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";Et.instance.get(r)||Et.instance.add(r);let o=["c","d","h","s"],s=[];for(let a of o)for(let l=1;l<=13;l++)s.push(a+("00"+l).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let l="./assets/images/trump/"+a+".gif";Et.instance.get(l)||Et.instance.add(l);let c=pr.create("\u30ab\u30fc\u30c9",l,r);i.putOnBottom(c)}return i}makeDefaultTable(){let e=new ui("gameTable"),i=null,r=en.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Et.instance.add(r),e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Ms.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Dn("testCharacter_1"),r=en.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Et.instance.add(r),e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new Dn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Dn("testCharacter_3"),r=en.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Et.instance.add(r),e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Dn("testCharacter_4"),r=en.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Et.instance.add(r),e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new Dn("testCharacter_5"),r=en.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Et.instance.add(r),e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new Dn("testCharacter_6"),r=en.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Et.instance.add(r),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),Re.play(Ee.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),Re.play(Ee.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),Re.play(Ee.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),Re.play(Ee.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),Re.play(Ee.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"D4",diceName:"D4",type:gi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:gi.D6,imagePathPrefix:"6_dice"},{menuName:"D8",diceName:"D8",type:gi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:gi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:gi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:gi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:gi.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),Re.play(Ee.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Ms.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class ii{get tabletopObject(){return this._tabletopObject}get layerName(){return this._layerName}get colideLayers(){return this._colideLayers}get transformCssOffset(){return this._transformCssOffset}set option(n){this.unregister(),this.synchronizer.unregister(),this._tabletopObject=n.tabletopObject??null,this._layerName=n.layerName??"",this._colideLayers=n.colideLayers??[],this._transformCssOffset=n.transformCssOffset??"",this._layerName.length<1&&this._tabletopObject&&(this._layerName=this._tabletopObject.aliasName),this.register(),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(n){this._posX=n,this.setUpdateBatching()}get posY(){return this._posY}set posY(n){this._posY=n,this.setUpdateBatching()}get posZ(){return this._posZ}set posZ(n){this._posZ=n,this.setUpdateBatching()}get magnitude(){return this.input.magnitude}get isPointerMoved(){return this.input.isPointerMoved}get state(){return this.selectionService.state(this.tabletopObject)}set state(n){this.selectionService.add(this.tabletopObject,n)}get isGridSnap(){return Ms.instance.gridSnap}constructor(n,e,i,r,o,s){this.ngZone=n,this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._layerName="",this._colideLayers=[],this._transformCssOffset="",this.isDisable=!1,this.onstart=new Ht,this.ondragstart=new Ht,this.ondrag=new Ht,this.ondragend=new Ht,this.onend=new Ht,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=-1,this.width=-1,this.ratio=1,this.isUpdateBatching=!1,this.collidableElements=[],this.input=new ia(this.nativeElement,!1),this.synchronizer=new Xo(this,this.selectionService,this.pointerDeviceService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,n=>{n.isSendFromSelf&&(this.input.isGrabbing||this.state!==It.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.state=It.NONE,this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.isDisable&&this.state!==It.NONE&&(this.state=It.NONE),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.unregister(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.findCollidableElements()}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}dispose(){pe.unregister(this),this.batchService.remove(this)}onInputStart(n){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||n instanceof MouseEvent&&(0!==n.button||n.ctrlKey||n.shiftKey))return void this.cancel();this.onstart.emit(n),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let e={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},i=this.coordinateService.convertToGlobal(e,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=i.x-this.input.pointer.x,this.pointerOffset2d.y=i.y-this.input.pointer.y,this.pointerOffset2d.z=i.z-this.input.pointer.z,this.pointerStart3d.x=e.x,this.pointerStart3d.y=e.y,this.pointerStart3d.z=e.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.synchronizer.prepareMove()}onInputMove(n){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();n.cancelable&&n.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let e={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};e.x=Math.min(window.innerWidth-.1,Math.max(e.x,.1)),e.y=Math.min(window.innerHeight-.1,Math.max(e.y,.1));let i=document.elementFromPoint(e.x,e.y);if(null==i)return;let r=this.coordinateService.calcTabletopLocalCoordinate(e,i);if(r.x-=this.width/2,r.y-=this.height/2,this.posX===r.x&&this.posY===r.y&&this.posZ===r.z)return;this.input.isDragging||this.ondragstart.emit(n),this.ondrag.emit(n);let s=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;s<this.ratio&&(this.ratio+=.1*(s-this.ratio));let a={x:r.x-this.posX,y:r.y-this.posY,z:r.z-this.posZ};this.posX=r.x,this.posY=r.y,this.posZ=r.z,this.synchronizer.updateMove(a)}onInputEnd(n){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(n);let e_x=this.posX,e_y=this.posY,e_z=this.posZ;this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.synchronizer.finishMove({x:this.posX-e_x,y:this.posY-e_y,z:this.posZ-e_z}),this.cancel(),this.onend.emit(n)}onContextMenu(n){if(this.isDisable)return this.cancel();n.cancelable&&n.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let e=this.input.isGrabbing&&n.isTrusted;if(this.cancel(),e){n.stopPropagation();let i=new MouseEvent(n.type,n);this.ngZone.run(()=>this.nativeElement.dispatchEvent(i))}}callSelectedEvent(){this.tabletopObject&&pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(n=25){this.posX=this.calcSnapNum(this.posX,n),this.posY=this.calcSnapNum(this.posY,n)}calcSnapNum(n,e){return e<=0?n:(n=n<0?n-e/2:n+e/2)-n%e}setPosition(n){this._posX=n.location.x,this._posY=n.location.y,this._posZ=n.posZ,this.updateTransformCss()}setUpdateBatching(){!this.isUpdateBatching&&this.tabletopObject&&(this.isUpdateBatching=!0,this.batchService.add(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.isUpdateBatching=!1})),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(n){let e=n.children;for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&"none"!==getComputedStyle(r).pointerEvents&&this.collidableElements.push(r)}if(this.collidableElements.length<1)for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&this.findNestedCollidableElements(r)}}setPointerEvents(n){let e=n?"auto":"none";this.collidableElements.forEach(i=>i.style.pointerEvents=e)}setAnimatedTransition(n){this.nativeElement.style.transition=n?"transform 132ms linear":""}shouldTransition(n){return n.location.x!==this.posX||n.location.y!==this.posY||n.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let n=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=n}setCollidableLayer(n){let e=n;for(let i of ii.layerMap.keys())e=this.colideLayers.includes(i)?!this.input.isGrabbing||n:!n,ii.layerMap.get(i).forEach(r=>{r===this||r.input?.isGrabbing||r.setPointerEvents(e)})}register(){let n=ii.layerMap.get(this.layerName)??new Set;n.add(this),ii.layerMap.set(this.layerName,n)}unregister(){let n=ii.layerMap.get(this.layerName);n&&(n.delete(this),n.size<1&&ii.layerMap.delete(this.layerName))}}ii.layerMap=new Map,ii.\u0275fac=function(n){return new(n||ii)(J(Gt),J(Bn),J(ap),J(ti),J(Wa),J(Qo))},ii.\u0275dir=vt({type:ii,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"},features:[kn]});class Xo{get selectedMovables(){let n=new Set;for(let e of this.selection.objects)Xo.objectMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e,i){this.movable=n,this.selection=e,this.pointerDevice=i,this.callbackOnPickStart=this.onPickStart.bind(this),this.callbackOnPickObject=this.onPickObject.bind(this),this.callbackOnPickRegion=this.onPickRegion.bind(this),this._isDestroyed=!1}initialize(){this.register(),this.addEventListeners()}destroy(){this.unregister(),this._isDestroyed=!0,this.removeEventListeners(),this.movable=null}onPickStart(n){null==this.movable.tabletopObject||this.movable.isDisable||(this.movable.state=n.detail.isMagnetic?It.MAGNETIC:It.SELECTED,this.prepareMove())}onPickObject(n){this.selection.excludeElement!==this.movable.nativeElement&&(this.pointerDevice.isDragging||this.movable.isDisable||(null==this.selection.excludeElement?(this.toggleState(),this.selection.excludeElement=this.movable.nativeElement):this.movable.state=It.SELECTED))}onPickRegion(n){if(this.pointerDevice.isDragging||this.movable.isDisable)return;let e=n.detail.x,i=n.detail.y,r=n.detail.width,o=n.detail.height,s=this.movable.nativeElement.getBoundingClientRect();s.x<=e+r&&e<=s.x+s.width&&s.y<=i+o&&i<=s.y+s.height&&(this.movable.state=It.SELECTED)}toggleState(){this.movable.state=this.movable.state===It.SELECTED?It.NONE:It.SELECTED}prepareMove(){if(this.shouldSynchronize())for(let n of this.selectedMovables)n!==this.movable&&(n.isDisable?n.state=It.NONE:(n.state=It.SELECTED,n.setPointerEvents(!1),n.setAnimatedTransition(!1)))}updateMove(n){if(this.shouldSynchronize()){if(this.movable.state===It.MAGNETIC){let e=ii.layerMap.get(this.movable.layerName);if(e)for(let i of e)i!==this.movable&&!i.isDisable&&i.state===It.NONE&&(i.width<0&&(i.width=i.nativeElement.clientWidth),i.height<0&&(i.height=i.nativeElement.clientHeight),this.isProximity(i)&&(i.state=It.MAGNETIC,i.setPointerEvents(!1),i.setAnimatedTransition(!1)))}for(let e of this.selectedMovables)e!==this.movable&&(e.posX+=n.x,e.posY+=n.y,e.posZ+=n.z,e.state===It.MAGNETIC&&(e.posX=.02*(this.movable.posX+(this.movable.width-e.width)/2)+.98*e.posX,e.posY=.02*(this.movable.posY+(this.movable.height-e.height)/2)+.98*e.posY,e.posZ=.02*this.movable.posZ+.98*e.posZ),e.posZ<0&&(e.posZ=0))}else this.movable.isPointerMoved&&this.selection.clear()}finishMove(n){if(!this.shouldSynchronize())return void this.selection.clear();for(let a of this.selectedMovables)a!==this.movable&&(a.posX+=n.x,a.posY+=n.y,a.posZ+=n.z);let e=Array.from(this.selectedMovables).sort((a,l)=>{let c=a.tabletopObject.zindex,u=l.tabletopObject.zindex;return null==c||null==u?0:c-u}).filter(a=>a.state===It.MAGNETIC&&a!==this.movable),i=360/e.length,r=360*Math.random(),o=Math.min(Math.max((this.movable.width+this.movable.height)/2,50),75),s_x=this.movable.posX+this.movable.width/2,s_y=this.movable.posY+this.movable.height/2;for(let a of e){if(a===this.movable)continue;r+=i;let l=on.radians(r);a.posX=s_x+o*Math.sin(l)-a.width/2,a.posY=s_y+o*Math.cos(l)-a.height/2}this.movable.state===It.MAGNETIC&&this.selection.size<=1?this.selection.clear():this.refreshState()}shouldSynchronize(){return this.movable.state!==It.NONE}refreshState(){for(let n of this.selectedMovables)n.state=It.SELECTED,n!==this.movable&&(n.setPointerEvents(!0),n.setAnimatedTransition(!0),n.width=n.height=-1)}isProximity(n,e=this.movable){let i=Math.max(.95*((n.width+e.width)/4+(n.height+e.height)/4),25)**2;return on.sqrMagnitude({x:n.posX+n.width/2,y:n.posY+n.height/2,z:n.posZ},{x:e.posX+e.width/2,y:e.posY+e.height/2,z:e.posZ})<i}addEventListeners(){this.movable.nativeElement.addEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.addEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.addEventListener("pickregion",this.callbackOnPickRegion)}removeEventListeners(){this.movable.nativeElement.removeEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.removeEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.removeEventListener("pickregion",this.callbackOnPickRegion)}register(){let n=Xo.objectMap.get(this.movable.tabletopObject)??new Set;n.add(this.movable),Xo.objectMap.set(this.movable.tabletopObject,n)}unregister(){let n=Xo.objectMap.get(this.movable.tabletopObject);n&&(n.delete(this.movable),n.size<1&&Xo.objectMap.delete(this.movable.tabletopObject))}static congregate(n,e){let i=e.sort((a,l)=>{let c=a.zindex,u=l.zindex;return null==c||null==u?0:c-u}),r=360/i.length,o=360*Math.random(),s=Math.min(Math.max(9*i.length,5),75);for(let a of i){let l=Xo.objectMap.get(a);if(null!=l)for(let c of l){c.setAnimatedTransition(!0),c.stopTransition(),c.width<0&&(c.width=c.nativeElement.clientWidth),c.height<0&&(c.height=c.nativeElement.clientHeight),o+=r;let u=on.radians(o);c.posX=n.x+s*Math.sin(u)-c.width/2,c.posY=n.y+s*Math.cos(u)-c.height/2,c.posZ=n.z}}}}Xo.objectMap=new Map;var It=(()=>(function(t){t[t.NONE=0]="NONE",t[t.SELECTED=1]="SELECTED",t[t.MAGNETIC=2]="MAGNETIC"}(It||(It={})),It))();let Qo=(()=>{class t{get size(){return this.selectionMap.size}get objects(){return Array.from(this.selectionMap.keys())}constructor(){this.selectionMap=new Map,this.previus=new Set,this.excludeElement=null,this.isUdpateCssBatching=!1}state(e){return this.selectionMap.get(e)??It.NONE}add(e,i=It.SELECTED){if(i===It.NONE)return this.remove(e);let r=this.objects;this.selectionMap.set(e,i),this.updateHighlight(r)}remove(e){if(!this.selectionMap.has(e))return;let i=this.objects;this.selectionMap.delete(e),this.updateHighlight(i)}clear(){let e=this.objects;this.selectionMap.clear(),this.updateHighlight(e)}congregate(e){Xo.congregate(e,this.objects)}updateHighlight(e=[]){e.forEach(i=>this.previus.add(i)),!this.isUdpateCssBatching&&(queueMicrotask(()=>{this.isUdpateCssBatching=!1,this.selectionMap.forEach((r,o)=>this.previus.add(o));let i=Array.from(this.previus);this.previus.clear(),0<i.length&&pe.trigger("UPDATE_SELECTION",{changed:i});for(let r of i)pe.trigger(`UPDATE_SELECTION/identifier/${r.identifier}`,{changed:i})}),this.isUdpateCssBatching=!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=kt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class fv{constructor(n){this.targetElement=n,this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchMouseInput}),this.isEnable=!0,this.onstart=null,this.oninteract=null,this.initializeHammer()}cancel(){this.isEnable=!1}destroy(){this.hammer.destroy()}initializeHammer(){let n=new Hammer.Tap({event:"tap2",taps:2});this.hammer.add([n]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap2",this.onInteract.bind(this))}onHammer(n){if(!n.isFirst)return;let e=n.srcEvent instanceof MouseEvent&&(0!==n.srcEvent.button||n.srcEvent.ctrlKey||n.srcEvent.shiftKey);this.isEnable=!e,this.isEnable&&this.onstart&&this.onstart(n.srcEvent)}onInteract(n){this.isEnable&&this.oninteract&&this.oninteract(n.srcEvent)}}class oa{get selectedRotables(){let n=new Set;for(let e of this.selection.objects)oa.rotablesMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e){this.rotable=n,this.selection=e,this._isDestroyed=!1}initialize(){this.register()}destroy(){this.unregister(),this._isDestroyed=!0,this.rotable=null}prepareRotate(){if(1<this.selection.size&&this.rotable.state!==It.NONE)for(let n of this.selectedRotables)n!==this.rotable&&(n.isDisable||n.setAnimatedTransition(!1));else this.selection.clear()}updateRotate(){if(!(this.selection.size<=1||this.rotable.state===It.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.rotate=this.rotable.rotate)}finishRotate(){if(!(this.selection.size<=1||this.rotable.state===It.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.setAnimatedTransition(!0),n.rotate=this.rotable.rotate)}register(){let n=oa.rotablesMap.get(this.rotable.tabletopObject)??new Set;n.add(this.rotable),oa.rotablesMap.set(this.rotable.tabletopObject,n)}unregister(){let n=oa.rotablesMap.get(this.rotable.tabletopObject);n&&(n.delete(this.rotable),n.size<1&&oa.rotablesMap.delete(this.rotable.tabletopObject))}}oa.rotablesMap=new Map;let bc=(()=>{class t{get tabletopObject(){return this._tabletopObject}get targetPropertyName(){return this._targetPropertyName}get targetProperty(){return this.tabletopObject[this.targetPropertyName]}set targetProperty(e){this.targetPropertyName in this.tabletopObject&&(this.tabletopObject[this.targetPropertyName]=e)}get transformCssOffset(){return this._transformCssOffset}get grabbingSelecter(){return this._grabbingSelecter}set option(e){this.synchronizer.unregister(),this._tabletopObject=e.tabletopObject,this._targetPropertyName=e.targetPropertyName??"",this._grabbingSelecter=e.grabbingSelecter??".rotate-grab",this._transformCssOffset=e.transformCssOffset??"",this._targetPropertyName.length<1&&this._tabletopObject&&(this._targetPropertyName="rotate"),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateBatching()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}get state(){return this.selectionService.state(this.tabletopObject)}constructor(e,i,r,o,s){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._targetPropertyName="",this._transformCssOffset="",this._grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Ht,this.ondragstart=new Ht,this.ondrag=new Ht,this.ondragend=new Ht,this.onend=new Ht,this.cssRotate=0,this._rotate=0,this.rotateOffset=0,this.isUpdateBatching=!1,this.grabbingElement=null,this.input=new ia(this.nativeElement,!1),this.synchronizer=new oa(this,this.selectionService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{e.isSendFromSelf&&(this.input.isGrabbing||this.state!==It.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(this.targetProperty),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)}ngOnDestroy(){this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.setAnimatedTransition(!0)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}dispose(){pe.unregister(this),this.batchService.remove(this)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||e instanceof MouseEvent&&(0!==e.button||e.ctrlKey||e.shiftKey))return void this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.synchronizer.prepareRotate()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r,this.synchronizer.updateRotate()}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.synchronizer.finishRotate(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){let l=Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2),c=(on.degrees(l)-i+720)%360;return c<180?c:c-360}radianFromMatrix(e,i,r,o,s,a){let l=0;if(0!==e||0!==i){let c=Math.sqrt(e*e+i*i);l=i>0?Math.acos(e/c):-Math.acos(e/c)}else if(0!==r||0!==o){let c=Math.sqrt(r*r+o*o);l=.5*Math.PI-(o>0?Math.acos(-r/c):-Math.acos(r/c))}return l}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateBatching(){this.isUpdateBatching||(this.isUpdateBatching=!0,this.batchService.add(()=>{this.targetProperty=this.rotate,this.isUpdateBatching=!1})),this.updateTransformCss()}setRotate(e){e&&this.targetPropertyName in e&&(this._rotate=e[this.targetPropertyName]),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return this.targetProperty!==this.rotate}stopTransition(e=this.rotate){let i=window.getComputedStyle(this.nativeElement).transform;if(Math.abs(e-this.cssRotate)<180)return;let r=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/gi.exec(i);if(!r)return;let o=this.radianFromMatrix(Number(r[1]),Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]),Number(r[6])),s=on.degrees(o),a_x=Math.cos(o),a_y=Math.sin(o),l=on.radians(e),c_x=Math.cos(l),u=a_x*Math.sin(l)-c_x*a_y,h=Math.abs(e-s);180<h&&(h=360-h);let g=e+(0<u?-h:h);if(g===s)return;let E=this.nativeElement.style.transition;this.nativeElement.style.transition="",this.cssRotate=g,this.nativeElement.style.transform=`${this.transformCssOffset} rotateZ(${g.toFixed(4)}deg)`,this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform,this.nativeElement.style.transition=E}updateTransformCss(){this.cssRotate=this.rotate;let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(J(Bn),J(ap),J(ti),J(Wa),J(Qo))},t.\u0275dir=vt({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend"},features:[kn]}),t})();function $7(t,n){if(1&t&&(Le(0,"img",7),Zt(1,"safe")),2&t){const e=H();S("src",Yt(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Xn)}}const W7=function(t){return{transform:t}};function Z7(t,n){if(1&t&&(T(0,"div",8)(1,"span"),q(2),P()()),2&t){const e=H();S("ngStyle",dt(2,W7,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),I(2),gt(e.ownerName)}}function Y7(t,n){1&t&&(Le(0,"img",9),Zt(1,"safe")),2&t&&S("src",Yt(1,1,H().frontImage.url,"resourceUrl"),Xn)}function q7(t,n){1&t&&(je(0),T(1,"div",10)(2,"i",11),q(3,"autorenew"),P()(),T(4,"div",12)(5,"i",11),q(6,"autorenew"),P()(),T(7,"div",13)(8,"i",11),q(9,"autorenew"),P()(),T(10,"div",14)(11,"i",11),q(12,"autorenew"),P()(),Le(13,"div",15),He())}const K7=function(t){return{"is-magnetic":t}};function X7(t,n){if(1&t&&Le(0,"div",16),2&t){const e=H();S("ngClass",dt(1,K7,e.isMagnetic))}}let Q7=(()=>{class t{get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return on.clampMin(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get selectionState(){return this.selectionService.state(this.card)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.selectionService=l,this.imageService=c,this.pointerDeviceService=u,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.card&&i&&i.userId===this.card.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new fv(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),pe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof pr||e.detail instanceof pi)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof pi)){let i=e.detail;this.card.calcSqrDistance(i)<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}onDoubleClick(){this.ownerIsOnline&&!this.isHand||this.ngZone.run(()=>{this.state=this.isVisible&&!this.isHand?Ds.BACK:Ds.FRONT,this.owner="",Re.play(Ee.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.card.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=pi.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>this.card.calcSqrDistance(r)<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.card.location.x+this.card.size*this.gridSize/2,y:this.card.location.y+this.card.size*this.gridSize/2,z:this.card.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.card.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ab\u30fc\u30c9",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceUp()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceDown()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>{o.faceDown(),o.owner=We.peer.userId}),Re.play(Ee.cardDraw)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push(!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),Re.play(Ee.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),Re.play(Ee.cardDraw)}}),e.push(this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),Re.play(Ee.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{Re.play(Ee.cardDraw),this.card.faceDown(),this.owner=We.peer.userId}}),e.push(gn),e.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),Re.play(Ee.cardPut)}}),e.push(gn),e.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.card.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),Re.play(Ee.cardPut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),Re.play(Ee.sweep)}}),e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(fr),J(hn),J(Bn),J(Ai),J(av),J(Qo),J(yc),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&de("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},features:[kn],decls:7,vars:9,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,$7,2,4,"img",2),Q(3,Z7,3,4,"div",3),Q(4,Y7,2,4,"img",4),Q(5,q7,14,0,"ng-container",5),Q(6,X7,1,3,"div",6),P()()),2&e&&(dn("width",i.size*i.gridSize,"px"),S("movable.option",i.movableOption),I(1),S("rotable.option",i.rotableOption),I(1),S("ngIf",i.imageFile),I(1),S("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),I(1),S("ngIf",i.isHand&&i.frontImage),I(1),S("ngIf",!i.isIconHidden),I(1),S("ngIf",i.isSelected))},dependencies:[li,pn,Ta,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:3px;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();const J7=["draggablePanel"];function eG(t,n){1&t&&wn(0)}function tG(t,n){1&t&&wn(0)}const kM=function(t){return{card:t}};function nG(t,n){if(1&t&&(je(0),Q(1,tG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(12);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,kM,e.tabletopObject))}}function iG(t,n){1&t&&wn(0)}function rG(t,n){if(1&t&&(je(0),Q(1,iG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(12);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,kM,e.tabletopObject))}}function oG(t,n){1&t&&wn(0)}const sG=function(t){return{note:t}};function aG(t,n){if(1&t&&(je(0),Q(1,oG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(14);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,sG,e.tabletopObject))}}function lG(t,n){1&t&&wn(0)}const IM=function(t){return{character:t}};function cG(t,n){if(1&t&&(je(0),Q(1,lG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(16);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,IM,e.tabletopObject))}}function uG(t,n){1&t&&wn(0)}const dG=function(t){return{dice:t}};function hG(t,n){if(1&t&&(je(0),Q(1,uG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(18);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,dG,e.tabletopObject))}}function fG(t,n){1&t&&wn(0)}function pG(t,n){if(1&t&&(je(0),Q(1,fG,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(16);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,IM,e.tabletopObject))}}function gG(t,n){1&t&&wn(0)}function mG(t,n){if(1&t&&(je(0),Q(1,gG,1,0,"ng-container",13),He()),2&t){H();const e=Pt(22);I(1),S("ngTemplateOutlet",e)}}const OM=function(t){return{"with-button-marign":t}};function _G(t,n){if(1&t&&(T(0,"div",24)(1,"div",25),q(2),P()()),2&t){const e=H(2).card,i=H();S("ngClass",dt(2,OM,i.hasImage)),I(2),gt(e.ownerName)}}function vG(t,n){if(1&t){const e=et();T(0,"div",19),Le(1,"img",20),Zt(2,"safe"),T(3,"button",21),de("click",function(){return Me(e),ke(H(2).chanageImageView(!0))}),T(4,"i",22),q(5,"zoom_in"),P()(),Q(6,_G,3,4,"div",23),P()}if(2&t){const e=H().card,i=H();I(1),S("src",Yt(2,2,i.imageUrl,"resourceUrl"),Xn),I(5),S("ngIf",e.hasOwner&&0<e.ownerName.length)}}function yG(t,n){if(1&t&&(je(0),q(1),He()),2&t){const e=H(2).card;I(1),gt(e.name)}}function bG(t,n){1&t&&(je(0),q(1,"\u30ab\u30fc\u30c9"),He())}function CG(t,n){if(1&t&&(T(0,"div",26),Q(1,yG,2,1,"ng-container",5),Q(2,bG,2,0,"ng-container",5),P()),2&t){const e=H().card,i=H();S("ngClass",dt(3,OM,i.hasImage)),I(1),S("ngIf",null==e.isVisible||e.isVisible),I(1),S("ngIf",null!=e.isVisible&&!e.isVisible)}}function wG(t,n){1&t&&wn(0)}const cp=function(t){return{dataElm:t}};function EG(t,n){if(1&t&&(je(0),Q(1,wG,1,0,"ng-container",12),He()),2&t){const e=n.$implicit;H(3);const i=Pt(20);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,cp,e))}}function TG(t,n){if(1&t&&(T(0,"div",27)(1,"div",28),Q(2,EG,2,4,"ng-container",29),P()()),2&t){const e=H(2);I(2),S("ngForOf",e.dataElms)}}const vo=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function xG(t,n){if(1&t&&(T(0,"div",14),Q(1,vG,7,5,"div",15),Q(2,CG,3,5,"div",16),T(3,"div",17),Q(4,TG,3,1,"div",18),P()()),2&t){const e=n.card,i=H();S("ngClass",vi(4,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngIf",i.hasImage),I(1),S("ngIf",0<(null==e||null==e.name?null:e.name.length)),I(2),S("ngIf",i.hasDataElms&&e.isVisible)}}function DG(t,n){if(1&t){const e=et();T(0,"div",30)(1,"div",31),q(2),P(),T(3,"div",32)(4,"div",19)(5,"div",33)(6,"textarea",34),de("ngModelChange",function(r){return ke(Me(e).note.text=r)}),P()(),T(7,"div",35),q(8),P()()()()}if(2&t){const e=n.note,i=H();S("ngClass",vi(4,vo,!i.isPointerDragging,i.isPointerDragging)),I(2),gt(e.title),I(4),S("ngModel",e.text),I(2),gt(e.text)}}function SG(t,n){if(1&t&&(T(0,"div",42),Le(1,"img",43),Zt(2,"safe"),P()),2&t){const e=H(2);S("ngClass",vi(5,vo,!e.isPointerDragging,e.isPointerDragging)),I(1),S("src",Yt(2,2,e.imageUrl,"resourceUrl"),Xn)}}function MG(t,n){1&t&&wn(0)}function kG(t,n){if(1&t&&(je(0),T(1,"div",28),Q(2,MG,1,0,"ng-container",12),P(),He()),2&t){const e=H().$implicit;H(3);const i=Pt(20);I(2),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,cp,e))}}function IG(t,n){if(1&t&&(je(0),Q(1,kG,3,4,"ng-container",5),He()),2&t){const e=n.$implicit,i=H(3);I(1),S("ngIf",e&&e.name!==i.newLineString)}}function OG(t,n){if(1&t&&(T(0,"div",27),Q(1,IG,2,1,"ng-container",29),P()),2&t){const e=H(2);I(1),S("ngForOf",e.inventoryDataElms)}}function AG(t,n){if(1&t&&(T(0,"div",36),Le(1,"div",37),Q(2,SG,3,8,"div",38),T(3,"div",39),q(4),P(),Le(5,"div",40),T(6,"div",41),Q(7,OG,2,1,"div",18),P()()),2&t){const e=n.character,i=H();I(1),S("ngClass",vi(6,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngIf",i.hasImage),I(1),S("ngClass",vi(9,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),gt(e.name),I(2),S("ngClass",vi(12,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngIf",i.hasDataElms)}}function PG(t,n){if(1&t&&(je(0),q(1),He()),2&t){const e=H().dice;I(1),gt(e.face)}}function FG(t,n){1&t&&(je(0),q(1,"???"),He())}function NG(t,n){if(1&t&&(T(0,"div",45)(1,"div",25),q(2),P()()),2&t){const e=H().dice,i=H();S("ngClass",vi(2,vo,!i.isPointerDragging,i.isPointerDragging)),I(2),Gn("",e.ownerName," ")}}const RG=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function LG(t,n){if(1&t&&(T(0,"div",42),Le(1,"img",46),Zt(2,"safe"),P()),2&t){const e=H().dice,i=H();S("ngClass",vi(6,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngClass",vi(9,RG,!e.isVisible,e.isMine))("src",Yt(2,3,i.imageUrl,"resourceUrl"),Xn)}}function BG(t,n){1&t&&wn(0)}function zG(t,n){if(1&t&&(je(0),Q(1,BG,1,0,"ng-container",12),He()),2&t){const e=H().$implicit;H(3);const i=Pt(20);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,cp,e))}}function UG(t,n){if(1&t&&(je(0),Q(1,zG,2,4,"ng-container",5),He()),2&t){const e=n.$implicit,i=H(3);I(1),S("ngIf",e&&e.name!==i.newLineString)}}function VG(t,n){if(1&t&&(T(0,"div",27)(1,"div",28),Q(2,UG,2,1,"ng-container",29),P()()),2&t){const e=H(2);I(2),S("ngForOf",e.dataElms)}}function jG(t,n){if(1&t&&(T(0,"div",36),Le(1,"div",37),T(2,"div",39),q(3),Q(4,PG,2,1,"ng-container",5),Q(5,FG,2,0,"ng-container",5),P(),Q(6,NG,3,5,"div",44),Q(7,LG,3,12,"div",38),Le(8,"div",40),T(9,"div",41),Q(10,VG,3,1,"div",18),P()()),2&t){const e=n.dice,i=H();I(1),S("ngClass",vi(9,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngClass",vi(12,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),Gn(" ",e.name,": "),I(1),S("ngIf",e.isVisible),I(1),S("ngIf",!e.isVisible),I(1),S("ngIf",e.hasOwner&&0<e.ownerName.length),I(1),S("ngIf",i.hasImage),I(2),S("ngClass",vi(15,vo,!i.isPointerDragging,i.isPointerDragging)),I(1),S("ngIf",i.hasDataElms&&e.isVisible)}}function HG(t,n){1&t&&wn(0)}function GG(t,n){if(1&t&&(T(0,"div",53),q(1),P()),2&t){const e=H(2).dataElm;I(1),gt(e.name)}}function $G(t,n){1&t&&wn(0)}function WG(t,n){if(1&t&&(je(0),Q(1,$G,1,0,"ng-container",12),He()),2&t){const e=n.$implicit;H(3);const i=Pt(20);I(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,cp,e))}}function ZG(t,n){if(1&t&&(T(0,"div",50),Q(1,GG,2,1,"div",51),T(2,"div",52),Q(3,WG,2,4,"ng-container",29),P()()),2&t){const e=H().dataElm;I(1),S("ngIf",0<e.name.trim().length),I(2),S("ngForOf",e.children)}}function YG(t,n){if(1&t){const e=et();je(0),T(1,"div",55)(2,"div"),q(3),P(),T(4,"div",56)(5,"div",33)(6,"textarea",34),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),P()(),T(7,"div",35),q(8),P()()(),He()}if(2&t){const e=H(2).dataElm;I(3),gt(e.name),I(3),S("ngModel",e.value),I(2),gt(e.value)}}function qG(t,n){if(1&t){const e=et();je(0),T(1,"div",57),q(2),P(),T(3,"div",58)(4,"div",59)(5,"div",60),q(6),P(),T(7,"input",61),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),P()(),T(8,"div",62),q(9),P()(),T(10,"div",63)(11,"input",64),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),Zt(12,"safe"),P()(),He()}if(2&t){const e=H(2).dataElm;I(2),gt(e.name),I(4),gt(e.currentValue),I(1),S("ngModel",e.currentValue),I(2),Gn(" / ",e.value,""),I(2),Cr(Yt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),S("ngModel",e.currentValue)}}function KG(t,n){if(1&t){const e=et();je(0),T(1,"div",57),q(2),P(),T(3,"div",58)(4,"div",65),q(5),P(),T(6,"input",66),de("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),P()(),He()}if(2&t){const e=H(2).dataElm;I(2),gt(e.name),I(3),gt(e.value),I(1),S("ngModel",e.value)}}function XG(t,n){1&t&&(je(0,2),Q(1,YG,9,3,"ng-container",3),Q(2,qG,13,11,"ng-container",3),Q(3,KG,7,3,"ng-container",4),He(),Le(4,"div",54)),2&t&&(S("ngSwitch",H().dataElm.type),I(1),S("ngSwitchCase","note"),I(1),S("ngSwitchCase","numberResource"))}function QG(t,n){if(1&t&&(Q(0,HG,1,0,"ng-container",47),Q(1,ZG,4,2,"ng-template",null,48,Un),Q(3,XG,5,3,"ng-template",null,49,Un)),2&t){const e=n.dataElm,i=Pt(2),r=Pt(4);S("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function JG(t,n){if(1&t){const e=et();T(0,"div",67),de("click",function(){return Me(e),ke(H().chanageImageView(!1))}),T(1,"div",68)(2,"i",22),q(3,"close"),P()(),Le(4,"img",69),Zt(5,"safe"),P()}if(2&t){const e=H();S("@fadeInOut","in"),I(4),S("src",Yt(5,2,e.imageUrl,"resourceUrl"),Xn)}}let e$=(()=>{class t{get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}constructor(e,i,r){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16)}ngOnDestroy(){pe.unregister(this)}onChangeDragging(e){this.changeDetector.markForCheck()}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(J(ov),J(Ai),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&An(J7,7),2&e){let r;On(r=Pn())&&(i.draggablePanel=r.first)}},hostBindings:function(e,i){1&e&&de("draggingstate",function(o){return i.onChangeDragging(o)},0,nu)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},features:[kn],decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"hidden-spacer"],["size","1",1,"input",3,"ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,i){1&e&&(T(0,"div",0,1),je(2,2),Q(3,eG,1,0,"ng-container",3),Q(4,nG,2,4,"ng-container",3),Q(5,rG,2,4,"ng-container",3),Q(6,aG,2,4,"ng-container",3),Q(7,cG,2,4,"ng-container",3),Q(8,hG,2,4,"ng-container",3),Q(9,pG,2,4,"ng-container",4),He(),P(),Q(10,mG,2,1,"ng-container",5),Q(11,xG,5,7,"ng-template",null,6,Un),Q(13,DG,9,7,"ng-template",null,7,Un),Q(15,AG,8,15,"ng-template",null,8,Un),Q(17,jG,11,18,"ng-template",null,9,Un),Q(19,QG,5,3,"ng-template",null,10,Un),Q(21,JG,6,5,"ng-template",null,11,Un)),2&e&&(S("@fadeInOut","in"),I(2),S("ngSwitch",i.tabletopObject.aliasName),I(1),S("ngSwitchCase","numberResource"),I(1),S("ngSwitchCase","card"),I(1),S("ngSwitchCase","card-stack"),I(1),S("ngSwitchCase","text-note"),I(1),S("ngSwitchCase","character"),I(1),S("ngSwitchCase","dice-symbol"),I(2),S("ngIf",i.isOpenImageView))},dependencies:[li,Vn,pn,wu,Ea,bu,Cu,Pi,ql,Da,qi,Ni,SM,ni],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],data:{animation:[Ao("fadeInOut",[bi("void => *",[yi("100ms ease-out",go([wt({opacity:0,offset:0}),wt({opacity:1,offset:1})]))]),bi("* => void",[yi("100ms ease-in",go([wt({opacity:1,offset:0}),wt({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),AM=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o),this.callbackOnPick=o=>this.ngZone.run(()=>this.closeAll())}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointer;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<on.sqrMagnitude(e,this.pointerDeviceService.pointer)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture)return;let e=fr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(e$,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0),document.addEventListener("pickstart",this.callbackOnPick,!0),document.addEventListener("pickobject",this.callbackOnPick,!0),document.addEventListener("pickregion",this.callbackOnPick,!0)}),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject.identifier}`,o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("UPDATE_SELECTION",o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),document.removeEventListener("pickstart",this.callbackOnPick,!0),document.removeEventListener("pickobject",this.callbackOnPick,!0),document.removeEventListener("pickregion",this.callbackOnPick,!0),this.clearTimer(),this.tooltipComponentRef=null,pe.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef);let r=this.tooltipComponentRef.instance;null!=r?.ngOnChanges&&queueMicrotask(()=>{this.tooltipComponentRef.instance&&r?.ngOnChanges({})})}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(J(Gt),J(ar),J(ti))},t.\u0275dir=vt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();function t$(t,n){if(1&t){const e=et();T(0,"div",2)(1,"div",3)(2,"div",4),Zt(3,"safe"),P(),T(4,"div",4),Zt(5,"safe"),P()(),T(6,"div",5)(7,"button",6),de("click",function(){const o=Me(e).$implicit;return ke(H().drawCard(o))}),q(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),P(),T(9,"button",0),de("click",function(){const o=Me(e).$implicit;return ke(H().showDetail(o))}),T(10,"i",7),q(11,"settings"),P(),q(12,"\u7de8\u96c6"),P(),Le(13,"br"),T(14,"button",0),de("click",function(){const o=Me(e).$implicit;return ke(H().up(o))}),q(15,"\u2191"),P(),T(16,"button",0),de("click",function(){const o=Me(e).$implicit;return ke(H().down(o))}),q(17,"\u2193"),P(),Le(18,"br"),P()()}if(2&t){const e=n.$implicit;I(1),S("appTooltip",e),I(1),dn("background-image",Yt(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),I(2),dn("background-image",Yt(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let n$=(()=>{class t{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=We.peer.userId}ngOnChanges(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck(),this.cardStack.owner!==this.owner&&this.panelService.close()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){pe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),Re.play(Ee.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),pe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),Re.play(Ee.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(hn),J(Ai))},t.\u0275cmp=Wt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},features:[kn],decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(T(0,"div")(1,"button",0),de("click",function(){return i.close(!0)}),q(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),P(),Le(3,"hr"),Q(4,t$,19,11,"div",1),P()),2&e&&(I(4),S("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},dependencies:[Vn,AM,ni],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();const pv=function(t){return{transform:t}};function i$(t,n){if(1&t&&(Le(0,"img",7),Zt(1,"safe")),2&t){const e=H();S("ngStyle",dt(5,pv,"rotateZ("+e.topCard.rotate+"deg)"))("src",Yt(1,2,e.imageFile.url,"resourceUrl"),Xn)}}function r$(t,n){1&t&&(je(0),T(1,"div",8)(2,"i",9),q(3,"autorenew"),P()(),T(4,"div",10)(5,"i",9),q(6,"autorenew"),P()(),T(7,"div",11)(8,"i",9),q(9,"autorenew"),P()(),T(10,"div",12)(11,"i",9),q(12,"autorenew"),P()(),He())}function o$(t,n){if(1&t&&(T(0,"div",13)(1,"span"),q(2),P()()),2&t){const e=H();S("ngStyle",dt(2,pv,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),I(2),Gn("",e.cards.length,"\u679a")}}function s$(t,n){if(1&t&&(T(0,"div",14)(1,"span"),q(2),P()()),2&t){const e=H();S("ngStyle",dt(2,pv,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),I(2),Gn("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}const a$=function(t){return{"is-magnetic":t}};function l$(t,n){if(1&t&&Le(0,"div",15),2&t){const e=H();S("ngClass",dt(1,a$,e.isMagnetic))}}const c$=function(t){return{"is-empty":t}};let u$=(()=>{class t{get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?on.clampMin(e.size):2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get selectionState(){return this.selectionService.state(this.cardStack)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){pe.unregister(this),pe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.cardStack&&i&&i.userId===this.cardStack.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new fv(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),pe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof pr||e.detail instanceof pi))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof pr){let i=e.detail;this.cardStack.calcSqrDistance(i)<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof pi){let i=e.detail;this.cardStack.calcSqrDistance(i)<625&&this.concatStack(i)}}onDoubleClick(){this.ngZone.run(()=>{null!=this.drawCard()&&Re.play(Ee.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.cardStack.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let l=pi.create(this.cardStack.name);l.location.x=this.cardStack.location.x+50-100*Math.random(),l.location.y=this.cardStack.location.y+50-100*Math.random(),l.posZ=this.cardStack.posZ,l.location.name=this.cardStack.location.name,l.rotate=this.rotate,l.toTopmost(),i.push(l)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=pi.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.cardStack.topCard?.size??2,r={x:this.cardStack.location.x+i*this.gridSize/2,y:this.cardStack.location.y+i*this.gridSize/2,z:this.cardStack.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),this.isSelected){let o=()=>this.selectionService.objects.filter(s=>s.aliasName===this.cardStack.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5c71\u672d",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceUpAll()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceDownAll()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.uprightAll()),Re.play(Ee.cardDraw)}},gn,{name:"\u3059\u3079\u3066\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{Re.play(Ee.cardShuffle),o().forEach(s=>{s.shuffle(),pe.call("SHUFFLE_CARD_STACK",{identifier:s.identifier})})}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&Re.play(Ee.cardDraw)}}),e.push(gn),e.push({name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),Re.play(Ee.cardDraw)}}),e.push({name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),Re.play(Ee.cardDraw)}}),e.push(gn),e.push({name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),Re.play(Ee.cardDraw)}}),e.push({name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),Re.play(Ee.cardDraw)}}),e.push({name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),Re.play(Ee.cardDraw)}}),e.push(gn),e.push({name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),Re.play(Ee.cardShuffle),pe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}}),e.push({name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}}),e.push(gn),e.push(this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}}),e.push({name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}}),e.push(gn),e.push({name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(We.peerIds.length+1),Re.play(Ee.cardDraw)}}),e.push({name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),Re.play(Ee.cardShuffle)}}),e.push(gn),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.cardStack.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.owner="",i.toTopmost(),Re.play(Ee.cardPut)}}),e.push({name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),Re.play(Ee.sweep)}}),e}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=We.peer.userId,this.panelService.open(n$,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(fr),J(hn),J(Bn),J(Ai),J(Qo),J(yc),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&de("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},features:[kn],decls:8,vars:13,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),T(2,"div"),de("@shuffle.start",function(o){return i.animationShuffleStarted(o)})("@shuffle.done",function(o){return i.animationShuffleDone(o)}),Q(3,i$,2,7,"img",2),P(),Q(4,r$,13,0,"ng-container",3),Q(5,o$,3,4,"div",4),Q(6,s$,3,4,"div",5),Q(7,l$,1,3,"div",6),P()()),2&e&&(dn("width",i.size*i.gridSize,"px"),S("ngClass",dt(11,c$,i.isEmpty))("movable.option",i.movableOption),I(1),S("rotable.option",i.rotableOption),I(1),S("@shuffle",i.animeState),I(1),S("ngIf",i.topCard&&i.imageFile),I(1),S("ngIf",!i.isIconHidden),I(1),S("ngIf",i.isShowTotal),I(1),S("ngIf",i.hasOwner),I(1),S("ngIf",i.isSelected))},dependencies:[li,pn,Ta,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99;inset:-5px}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("shuffle",[bi("* => active",[yi("800ms ease",go([wt({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),wt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0}),t})();const d$=function(t){return{"is-magnetic":t}};function h$(t,n){if(1&t&&Le(0,"div",18),2&t){const e=H();S("ngClass",dt(1,d$,e.isMagnetic))}}const gv=function(t){return{transform:t}};function f$(t,n){if(1&t&&(T(0,"div",20)(1,"div",21),q(2),P()()),2&t){const e=n.$implicit,i=H(2);S("ngStyle",dt(2,gv,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),I(2),gt(i.name)}}const p$=function(){return["0","180deg"]};function g$(t,n){1&t&&(je(0),Q(1,f$,3,4,"div",19),He()),2&t&&(I(1),S("ngForOf",Ca(1,p$)))}function m$(t,n){1&t&&(Le(0,"img",22),Zt(1,"safe")),2&t&&S("src",Yt(1,1,H().imageFile.url,"resourceUrl"),Xn)}let _$=(()=>{class t{get name(){return this.gameCharacter.name}get size(){return on.clampMin(this.gameCharacter.size)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get selectionState(){return this.selectionService.state(this.gameCharacter)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}constructor(e,i,r,o,s){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.selectionService=o,this.pointerDeviceService=s,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.rollOption={}}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter},this.rollOption={tabletopObject:this.gameCharacter,targetPropertyName:"roll"}}ngOnDestroy(){pe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.piecePick)}onMoved(){Re.play(Ee.piecePut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.gameCharacter.location.x+this.gameCharacter.size*this.gridSize/2,y:this.gameCharacter.location.y+this.gameCharacter.size*this.gridSize/2,z:this.gameCharacter.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameCharacter.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:[{name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("common"),this.selectionService.remove(o)}),Re.play(Ee.piecePut)}},{name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation(We.peerId),this.selectionService.remove(o)}),Re.play(Ee.piecePut)}},{name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("graveyard"),this.selectionService.remove(o)}),Re.play(Ee.sweep)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}}),e.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}}),e.push(gn),e.push({name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),Re.play(Ee.piecePut)}}),e.push({name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation(We.peerId),Re.play(Ee.piecePut)}}),e.push({name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),Re.play(Ee.sweep)}}),e.push(gn),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.gameCharacter.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),Re.play(Ee.piecePut)}}),e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(TM,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}}return t.\u0275fac=function(e){return new(e||t)(J(fr),J(hn),J(Ai),J(Qo),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["game-character"]],hostBindings:function(e,i){1&e&&de("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},features:[kn],decls:23,vars:21,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"pedestal-inner"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],[4,"ngIf"],["class","image chrome-smooth-image-trick",3,"src",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngFor","ngForOf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"has-length-limit"],[1,"image","chrome-smooth-image-trick",3,"src"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1)(2,"div",2),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),T(3,"div",3)(4,"div",4)(5,"div",5),q(6,"autorenew"),P(),T(7,"div",6),q(8,"autorenew"),P()()(),Le(9,"div",7),Q(10,h$,1,3,"div",8),Le(11,"div",9),T(12,"div",10)(13,"div",11),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),T(14,"div",12),Q(15,g$,2,2,"ng-container",13),Q(16,m$,2,4,"img",14),T(17,"div",15)(18,"i",16),q(19,"autorenew"),P()(),T(20,"div",17)(21,"i",16),q(22,"autorenew"),P()()()()()()()()),2&e&&(dn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),S("movable.option",i.movableOption),I(1),S("@bounceInOut","in"),I(1),S("rotable.option",i.rotableOption),I(8),S("ngIf",i.isSelected),I(3),dn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),S("rotable.option",i.rollOption),I(2),S("ngIf",0<i.name.length),I(1),S("ngIf",0<i.imageFile.url.length),I(1),S("ngStyle",dt(17,gv,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px)")),I(3),S("ngStyle",dt(19,gv,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")))},dependencies:[li,Vn,pn,Ta,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:25px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("bounceInOut",[bi("void => *",[yi("600ms ease",go([wt({transform:"scale3d(0, 0, 0)",offset:0}),wt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),bi("* => void",[yi(100,wt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function v$(t,n){1&t&&Le(0,"div")}function y$(t,n){1&t&&Le(0,"div",6),2&t&&dn("background-color","rgba(10, 10, 10,"+H().opacity+")")}function b$(t,n){if(1&t&&(T(0,"div",7),Le(1,"img",8),Zt(2,"safe"),P()),2&t){const e=H();I(1),dn("opacity",e.opacity),S("src",Yt(2,3,e.imageFile.url,"resourceUrl"),Xn)}}function C$(t,n){1&t&&(T(0,"div",9)(1,"i",10),q(2,"lock"),P()())}const w$=function(t){return{"is-magnetic":t}};function E$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H();S("ngClass",dt(1,w$,e.isMagnetic))}}const T$=function(t){return{"is-grab":t}};let x$=(()=>{class t{get name(){return this.gameTableMask.name}get width(){return on.clampMin(this.gameTableMask.width)}get height(){return on.clampMin(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get selectionState(){return this.selectionService.state(this.gameTableMask)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.selectionService=l,this.pointerDeviceService=c,this.coordinateService=u,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ia(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),pe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&pe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameTableMask.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30de\u30c3\u30d7\u30de\u30b9\u30af",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLock=!0),Re.play(Ee.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,o.parent&&o.parent.appendChild(s)}),Re.play(Ee.cardPut)}}]})}return e.push(gn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,Re.play(Ee.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,Re.play(Ee.lock)}}),i.push(gn),i.push({name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameTableMask.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(r),Re.play(Ee.cardPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),Re.play(Ee.sweep)}}),i.push(gn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hv),J(fr),J(Bn),J(hn),J(Ai),J(Qo),J(ti),J(Wa))},t.\u0275cmp=Wt({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&de("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[kn],decls:8,vars:14,consts:[["appMovable","",1,"component","is-3d",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[4,"ngIf","ngIfThen","ngIfElse"],["blackMask",""],["imageMask",""],["class","lock-icon is-center",4,"ngIf"],["class","selected-highlight border",3,"ngClass",4,"ngIf"],[1,"border","is-fit-full"],[1,"border","is-fit-full","chrome-smooth-image-trick"],[1,"image","is-fit-full","chrome-smooth-image-trick",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"selected-highlight","border",3,"ngClass"]],template:function(e,i){if(1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,v$,1,0,"div",1),Q(2,y$,1,2,"ng-template",null,2,Un),Q(4,b$,3,6,"ng-template",null,3,Un),Q(6,C$,3,0,"div",4),Q(7,E$,1,3,"div",5),P()),2&e){const r=Pt(3),o=Pt(5);dn("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),S("ngClass",dt(12,T$,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),I(1),S("ngIf",i.imageFile.url.length<1)("ngIfThen",r)("ngIfElse",o),I(5),S("ngIf",i.isLock),I(1),S("ngIf",i.isSelected)}},dependencies:[li,pn,ii,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],changeDetection:0}),t})();function D$(t,n){1&t&&(je(0),Le(1,"div",3),T(2,"div",4)(3,"i",5),q(4,"autorenew"),P()(),T(5,"div",6)(6,"i",5),q(7,"autorenew"),P()(),T(8,"div",7)(9,"i",5),q(10,"autorenew"),P()(),T(11,"div",8)(12,"i",5),q(13,"autorenew"),P()(),He())}const pd=function(t){return{"is-magnetic":t}};function S$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(2);S("ngClass",dt(1,pd,e.isMagnetic))}}const gd=function(t){return{"blinking-animation":t}},M$=function(t){return{transform:t}};function k$(t,n){if(1&t&&(je(0),T(1,"div",9),Zt(2,"safe"),Q(3,S$,1,3,"div",10),P(),He()),2&t){const e=H();I(1),dn("background-image",Yt(2,5,"url("+e.floorImage.url+")","style")),S("ngClass",dt(8,gd,!e.isLocked))("ngStyle",dt(10,M$,"translateZ("+e.height*e.gridSize+"px)")),I(2),S("ngIf",e.isSelected)}}function I$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);S("ngClass",dt(1,pd,e.isMagnetic))}}function O$(t,n){if(1&t&&(T(0,"div",16),Zt(1,"safe"),Q(2,I$,1,3,"div",10),P()),2&t){const e=H(2);dn("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),S("ngClass",dt(11,gd,!e.isLocked)),I(2),S("ngIf",e.isSelected)}}function A$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);S("ngClass",dt(1,pd,e.isMagnetic))}}function P$(t,n){if(1&t&&(T(0,"div",17),Zt(1,"safe"),Q(2,A$,1,3,"div",10),P()),2&t){const e=H(2);dn("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),S("ngClass",dt(11,gd,!e.isLocked)),I(2),S("ngIf",e.isSelected)}}function F$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);S("ngClass",dt(1,pd,e.isMagnetic))}}function N$(t,n){if(1&t&&(T(0,"div",18),Zt(1,"safe"),Q(2,F$,1,3,"div",10),P()),2&t){const e=H(2);dn("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),S("ngClass",dt(11,gd,!e.isLocked)),I(2),S("ngIf",e.isSelected)}}function R$(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);S("ngClass",dt(1,pd,e.isMagnetic))}}function L$(t,n){if(1&t&&(T(0,"div",19),Zt(1,"safe"),Q(2,R$,1,3,"div",10),P()),2&t){const e=H(2);dn("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),S("ngClass",dt(11,gd,!e.isLocked)),I(2),S("ngIf",e.isSelected)}}function B$(t,n){if(1&t&&(je(0),Q(1,O$,3,13,"div",12),Q(2,P$,3,13,"div",13),Q(3,N$,3,13,"div",14),Q(4,L$,3,13,"div",15),He()),2&t){const e=H();I(1),S("ngIf",e.isVisibleWallTopBottom),I(1),S("ngIf",e.isVisibleWallTopBottom),I(1),S("ngIf",e.isVisibleWallLeftRight),I(1),S("ngIf",e.isVisibleWallLeftRight)}}const z$=function(t){return{"is-grab":t}};let U$=(()=>{class t{get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return on.clampMin(this.terrain.height)}get width(){return on.clampMin(this.terrain.width)}get depth(){return on.clampMin(this.terrain.depth)}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get selectionState(){return this.selectionService.state(this.terrain)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u,h){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=l,this.selectionService=c,this.pointerDeviceService=u,this.coordinateService=h,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.input=null}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ia(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),pe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&pe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.blockPick)}onMoved(){Re.play(Ee.blockPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.terrain.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5730\u5f62",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLocked=!0),Re.play(Ee.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,o.parent&&o.parent.appendChild(s)}),Re.play(Ee.blockPut)}}]})}return e.push(gn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,Re.play(Ee.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,Re.play(Ee.lock)}}),i.push(gn),i.push(this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=na.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=na.ALL}}),i.push(gn),i.push({name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.terrain.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(r),Re.play(Ee.blockPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),Re.play(Ee.sweep)}}),i.push(gn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-250,top:i.y-150,width:500,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(yc),J(hv),J(fr),J(Bn),J(hn),J(Ai),J(Qo),J(ti),J(Wa))},t.\u0275cmp=Wt({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&de("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},features:[kn],decls:5,vars:14,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"],[1,"texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],["class","texture of-wall-top chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-bottom chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-left chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-right chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"texture","of-wall-top","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-bottom","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-left","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-right","chrome-smooth-image-trick",3,"ngClass"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,D$,14,0,"ng-container",2),Q(3,k$,4,12,"ng-container",2),Q(4,B$,5,4,"ng-container",2),P()()),2&e&&(dn("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),S("movable.option",i.movableOption)("movable.disable",i.isLocked),I(1),S("ngClass",dt(12,z$,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),I(1),S("ngIf",!i.isLocked),I(1),S("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),I(1),S("ngIf",i.hasWall&&0<(null==i.wallImage?null:i.wallImage.url.length)))},dependencies:[li,pn,Ta,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.selected-highlight[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.pedestal-grab[_ngcontent-%COMP%]{position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s linear infinite alternate}@keyframes _ngcontent-%COMP%_blink{0%{opacity:.9}to{opacity:.5}}"],changeDetection:0}),t})();const V$=["cursor"],j$=["opacity"];function H$(t,n){if(1&t&&(T(0,"div",6)(1,"div",7),Zt(2,"safe"),T(3,"div",8)(4,"span",9),q(5),P()()()()),2&t){const e=n.$implicit,i=H(2);S("ngClass",e),I(1),dn("background-image",Yt(2,4,"url("+i.iconUrl+")","style")),I(4),gt(i.name)}}const G$=function(){return["is-front","is-back"]};function $$(t,n){1&t&&(je(0),T(1,"div",1,2)(3,"div",3,4),Q(5,H$,6,7,"div",5),P()(),He()),2&t&&(I(5),S("ngForOf",Ca(1,G$)))}let W$=(()=>{class t{get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get delayMs(){let e=16.6*(We.peerIds.length+1);return e<100?100:e}constructor(e,i,r){this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Rt.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}ngOnInit(){this.isMine||pe.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),pe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),pe.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new Bo(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}}return t.\u0275fac=function(e){return new(e||t)(J(ap),J(Wa),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(An(V$,5),An(j$,5)),2&e){let r;On(r=Pn())&&(i.cursorElementRef=r.first),On(r=Pn())&&(i.opacityElementRef=r.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(e,i){1&e&&Q(0,$$,6,2,"ng-container",0),2&e&&S("ngIf",!i.isMine)},dependencies:[li,Vn,pn,ni],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),t})();const Z$=["textArea"];function Y$(t,n){if(1&t&&(T(0,"div",12),q(1),P()),2&t){const e=H();I(1),gt(e.title)}}const PM=function(t){return{"is-magnetic":t}};function q$(t,n){if(1&t&&Le(0,"div",13),2&t){const e=H();S("ngClass",dt(1,PM,e.isMagnetic))}}function K$(t,n){if(1&t&&Le(0,"div",13),2&t){const e=H();S("ngClass",dt(1,PM,e.isMagnetic))}}const X$=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"is-outline-text":e}};let Q$=(()=>{class t{get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return on.clampMin(this.textNote.height)}get width(){return on.clampMin(this.textNote.width)}get isActive(){return document.activeElement===this.textAreaElementRef.nativeElement}get selectionState(){return this.selectionService.state(this.textNote)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.changeDetector=o,this.selectionService=s,this.pointerDeviceService=a,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=l=>this.onMouseUp(l),this.gridSize=50,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={}}ngOnChanges(){pe.unregister(this),pe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngOnDestroy(){pe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isActive){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void pe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(this.removeMouseEventListeners(),this.isActive||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.title)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.textNote.location.x,y:this.textNote.location.y,z:this.textNote.posZ};return e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),e.push(gn),e}makeContextMenu(){let e=[];return e.push({name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.textNote.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),Re.play(Ee.cardPut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),Re.play(Ee.sweep)}}),e}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(Ko,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(fr),J(hn),J(Ai),J(Qo),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&An(Z$,7),2&e){let r;On(r=Pn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&de("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},features:[kn],decls:18,vars:34,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"upright-transform","is-front","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"upright-transform","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],[1,"title","is-black-background","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),T(2,"div",2)(3,"div",3)(4,"i",4),q(5,"autorenew"),P()(),T(6,"div",5)(7,"i",4),q(8,"autorenew"),P()(),T(9,"div",6),Zt(10,"safe"),Q(11,Y$,2,1,"div",7),T(12,"textarea",8,9),de("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),P(),Q(14,q$,1,3,"div",10),P(),T(15,"div",11),Zt(16,"safe"),Q(17,K$,1,3,"div",10),P()()()()),2&e&&(S("movable.option",i.movableOption)("movable.disable",i.isActive),I(1),S("rotable.option",i.rotableOption),I(1),dn("width",i.width*i.gridSize,"px"),I(7),dn("background-image",Yt(10,24,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),I(2),S("ngIf",i.title.length),I(1),dn("font-size",i.fontSize+9,"px"),S("ngClass",Ih(30,X$,!i.isActive,i.isActive,!i.isActive))("ngModel",i.text),I(2),S("ngIf",i.isSelected),I(1),dn("background-image",Yt(16,27,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),I(2),S("ngIf",i.isSelected))},dependencies:[li,pn,Pi,qi,Ni,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;box-sizing:border-box;height:100%;width:100%;top:0;left:0;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();function J$(t,n){1&t&&(je(0),T(1,"div",12)(2,"div",13)(3,"div",14),q(4,"autorenew"),P(),T(5,"div",15),q(6,"autorenew"),P()()(),He())}const eW=function(t){return{"is-magnetic":t}};function tW(t,n){if(1&t&&Le(0,"div",16),2&t){const e=H();S("ngClass",dt(1,eW,e.isMagnetic))}}function nW(t,n){if(1&t&&(T(0,"span"),q(1),P()),2&t){const e=H(3);I(1),gt(e.face)}}function iW(t,n){1&t&&(T(0,"span"),q(1,"???"),P())}const FM=function(t){return{transform:t}};function rW(t,n){if(1&t&&(T(0,"div",19)(1,"div"),q(2),Q(3,nW,2,1,"span",3),Q(4,iW,2,0,"span",3),P()()),2&t){const e=H().$implicit,i=H();S("ngStyle",dt(4,FM,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),I(2),Gn("",i.name,":"),I(1),S("ngIf",i.isVisible),I(1),S("ngIf",!i.isVisible)}}function oW(t,n){if(1&t&&(T(0,"div",20)(1,"div"),q(2),P()()),2&t){const e=H().$implicit,i=H();S("ngStyle",dt(2,FM,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),I(2),gt(i.ownerName)}}function sW(t,n){if(1&t&&(je(0),Q(1,rW,5,6,"div",17),Q(2,oW,3,4,"div",18),He()),2&t){const e=H();I(1),S("ngIf",0<e.name.length),I(1),S("ngIf",e.hasOwner&&0<e.ownerName.length)}}const aW=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function lW(t,n){if(1&t&&(Le(0,"img",21),Zt(1,"safe")),2&t){const e=H();S("src",Yt(1,2,e.imageFile.url,"resourceUrl"),Xn)("ngClass",vi(5,aW,!e.isVisible,e.isMine))}}const cW=function(t){return{"is-gray-border":t}},uW=function(){return["0","180deg"]};let dW=(()=>{class t{get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return on.clampMin(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get selectionState(){return this.selectionService.state(this.diceSymbol)}get isSelected(){return this.selectionState!==It.NONE}get isMagnetic(){return this.selectionState===It.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){pe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.diceSymbol&&i&&i.userId===this.diceSymbol.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new fv(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),pe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.ngZone.run(()=>this.startIconHiddenTimer())}onDoubleClick(){this.isVisible&&this.ngZone.run(()=>this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.diceSymbol.location.x+this.diceSymbol.size*this.gridSize/2,y:this.diceSymbol.location.y+this.diceSymbol.size*this.gridSize/2,z:this.diceSymbol.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.diceSymbol.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30c0\u30a4\u30b9",action:null,subActions:[{name:"\u3059\u3079\u3066\u632f\u308b",action:()=>{let o=!1;r().forEach(s=>{s.isVisible&&(o=!0,pe.call("ROLL_DICE_SYMBOL",{identifier:s.identifier}),s.diceRoll())}),o&&Re.play(Ee.diceRoll1)}},{name:"\u3059\u3079\u3066\u516c\u958b",action:()=>{r().forEach(o=>o.owner=""),Re.play(Ee.unlock)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>o.owner=We.peer.userId),Re.play(Ee.lock)}}]})}return e.push(gn),e}makeContextMenu(){let e=[];if(this.isVisible&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()}}),e.length&&e.push(gn),(this.isMine||this.hasOwner)&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",Re.play(Ee.unlock)}}),this.isMine||e.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=We.peer.userId,Re.play(Ee.lock)}}),this.isVisible){let i=[];this.faces.forEach(r=>{i.push({name:`${r}`,action:()=>{this.face=r,Re.play(Ee.dicePut)}})}),e.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:i})}return e.push(gn),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.diceSymbol.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),Re.play(Ee.dicePut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),Re.play(Ee.sweep)}}),e}onMove(){this.contextMenuService.close(),Re.play(Ee.dicePick)}onMoved(){Re.play(Ee.dicePut)}diceRoll(){return pe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),Re.play(Ee.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){pe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ko,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hn),J(fr),J(Bn),J(Ai),J(Qo),J(yc),J(ti))},t.\u0275cmp=Wt({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&de("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},features:[kn],decls:13,vars:20,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[4,"ngFor","ngForOf"],["class","image chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"owner-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"image","chrome-smooth-image-trick",3,"src","ngClass"]],template:function(e,i){1&e&&(T(0,"div",0),de("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),T(1,"div",1)(2,"div",2),de("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(3,J$,7,0,"ng-container",3),Le(4,"div",4),Q(5,tW,1,3,"div",5),Le(6,"div",6),T(7,"div",1),de("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),T(8,"div",7)(9,"div",8)(10,"div",9),Q(11,sW,3,2,"ng-container",10),Q(12,lW,2,8,"img",11),P()()()()()()()),2&e&&(dn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),S("movable.option",i.movableOption),I(1),S("@bounceInOut","in"),I(1),S("rotable.option",i.rotableOption),I(1),S("ngIf",!i.isIconHidden),I(1),S("ngClass",dt(17,cW,i.hasOwner)),I(1),S("ngIf",i.isSelected),I(2),S("@diceRoll",i.animeState),I(2),dn("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),I(2),S("ngForOf",Ca(19,uW)),I(1),S("ngIf",0<i.imageFile.url.length))},dependencies:[li,Vn,pn,Ta,ii,bc,ni],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("diceRoll",[bi("* => active",[yi("800ms ease",go([wt({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),wt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),Ao("bounceInOut",[bi("void => *",[yi("600ms ease",go([wt({transform:"scale3d(0, 0, 0)",offset:0}),wt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),bi("* => void",[yi(100,wt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const hW=["root"],fW=["gameTable"],pW=["gameObjects"],gW=["gridCanvas"],mW=["pickArea"],_W=["pickCursor"];function vW(t,n){1&t&&Le(0,"terrain",23),2&t&&S("terrain",n.$implicit)}function yW(t,n){1&t&&Le(0,"game-table-mask",24),2&t&&S("gameTableMask",n.$implicit)}const bW=function(t){return{"z-index":t}};function CW(t,n){if(1&t&&Le(0,"text-note",25),2&t){const e=n.$implicit;S("textNote",e)("appTooltip",e)("ngStyle",dt(3,bW,e.zindex))}}const NM=function(t,n){return{"z-index":t,transform:n}};function wW(t,n){if(1&t&&Le(0,"card-stack",26),2&t){const e=n.$implicit;S("cardStack",e)("appTooltip",e)("ngStyle",vi(3,NM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function EW(t,n){if(1&t&&Le(0,"card",27),2&t){const e=n.$implicit;S("card",e)("appTooltip",e)("ngStyle",vi(3,NM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function TW(t,n){if(1&t&&Le(0,"dice-symbol",28),2&t){const e=n.$implicit;S("diceSymbol",e)("appTooltip",e)}}function xW(t,n){if(1&t&&Le(0,"game-character",29),2&t){const e=n.$implicit;S("gameCharacter",e)("appTooltip",e)}}function DW(t,n){1&t&&Le(0,"peer-cursor",30),2&t&&S("cursor",n.$implicit)}const SW=function(t,n){return[t,n]},MW=function(t){return{"is-grabbing":t}};let kW=(()=>{class t{get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=l,this.selectionService=c,this.modalService=u,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null,this.pickGesture=null}ngOnInit(){pe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture(),this.initializeTablePickGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){pe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy(),this.pickGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new G7(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new U7(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}initializeTablePickGesture(){this.pickGesture=new V7(this.rootElementRef.nativeElement,this.gameObjects.nativeElement,this.pickCursor.nativeElement,this.pickArea.nativeElement,this.pointerDeviceService,this.selectionService),this.pickGesture.onstart=this.onTablePickStart.bind(this),this.pickGesture.onend=this.onTablePickEnd.bind(this),this.pickGesture.oncancelifneeded=this.onTablePickCancelIfNeeded.bind(this),this.pickGesture.onpick=this.onTablePick.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTablePickStart(){this.isTableTransformMode=!1,Re.playLocal(Ee.selectionStart),this.pickGesture.isMagneticMode||(this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+"")}onTablePickEnd(){this.pickGesture.isKeepSelection||requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.contextMenuService.isShow||this.selectionService.clear()})})}onTablePickCancelIfNeeded(){return this.isTableTransformMode}onTablePick(){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close())}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];0<this.selectionService.size&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>{this.selectionService.congregate(r)},enabled:0<this.selectionService.size}),o.push(gn)),Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(gn),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(xM)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=Ss.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new z7(this.gridCanvas.nativeElement).render(e,i,r,o,s),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(fr),J(ti),J(Wa),J(yc),J(av),J(hv),J(Qo),J(Bi))},t.\u0275cmp=Wt({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(An(hW,7),An(fW,7),An(pW,7),An(gW,7),An(mW,7),An(_W,7)),2&e){let r;On(r=Pn())&&(i.rootElementRef=r.first),On(r=Pn())&&(i.gameTable=r.first),On(r=Pn())&&(i.gameObjects=r.first),On(r=Pn())&&(i.gridCanvas=r.first),On(r=Pn())&&(i.pickArea=r.first),On(r=Pn())&&(i.pickCursor=r.first)}},hostBindings:function(e,i){1&e&&de("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,nu)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,nu)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,nu)},decls:25,vars:33,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none"],["gridCanvas",""],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pick-area"],["pickArea",""],[1,"pick-cursor"],["pickCursor",""],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 100 100"],["cx","50","cy","50","r","15"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(T(0,"div",0),Zt(1,"safe"),P(),T(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Zt(8,"safe"),Le(9,"canvas",7,8),Q(11,vW,1,1,"terrain",9),Q(12,yW,1,1,"game-table-mask",10),Q(13,CW,1,5,"text-note",11),Q(14,wW,1,6,"card-stack",12),Q(15,EW,1,6,"card",13),Q(16,TW,1,2,"dice-symbol",14),Q(17,xW,1,2,"game-character",15),Q(18,DW,1,1,"peer-cursor",16),P()()(),Le(19,"div",17,18),T(21,"div",19,20),function Qv(){Ot.lFrame.currentNamespace=Rv}(),T(23,"svg",21),Le(24,"circle",22),P()()),2&e&&(dn("background-image",Yt(1,22,"url("+i.backgroundImage.url+")","style")),S("ngClass",vi(28,SW,i.backgroundFilterType?"is-filter":"",i.backgroundFilterType)),I(2),S("ngClass",dt(31,MW,i.isPointerDragging)),I(4),dn("background-image",Yt(8,25,"url("+i.tableImage.url+")","style")),I(5),S("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),I(1),S("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},dependencies:[li,Vn,Ta,Q7,u$,_$,x$,U$,W$,Q$,dW,AM,ni],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:none;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.pick-area[_ngcontent-%COMP%]{position:absolute;display:none;background-color:#00a8ff1a;border:1px solid hsl(200,100%,50%);pointer-events:none}.pick-cursor[_ngcontent-%COMP%]{position:absolute;display:none;scale:1;transition:scale .2s ease-out;stroke:#0af;pointer-events:none}.pick-cursor[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(-90deg)}.pick-cursor[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:#e5f6ffb3;stroke:inherit;stroke-width:4;animation-name:_ngcontent-%COMP%_circle-animation,_ngcontent-%COMP%_circle-fill;animation-timing-function:linear,ease-out;animation-duration:.85s,.85s}@keyframes _ngcontent-%COMP%_circle-animation{0%{stroke-dasharray:0 94.3}55%{stroke-dasharray:0 94.3}99.9%,to{stroke-dasharray:94.3 94.3}}@keyframes _ngcontent-%COMP%_circle-fill{0%{opacity:0}45%{opacity:0}99.9%,to{opacity:1}}']}),t})(),IW=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};pe.register(this).on("*",i=>{this.needRepeat||We.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){pe.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(J(Bn))},t.\u0275cmp=Wt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(T(0,"div",0),Le(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),T(10,"div",10),q(11,"sync"),P()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const OW=["modalLayer"];function AW(t,n){if(1&t){const e=et();T(0,"li",2),de("click",function(){return Me(e),ke(H().save())}),T(1,"a",3)(2,"div")(3,"i",5),q(4,"sd_storage"),P()(),T(5,"div"),q(6,"\u4fdd\u5b58"),P()()()}}function PW(t,n){if(1&t&&(T(0,"li",11)(1,"a")(2,"div")(3,"i",12),q(4,"sd_storage"),P()(),T(5,"div"),q(6),P()()()),2&t){const e=H();I(6),Gn("",e.progresPercent,"%")}}let FW=(()=>{class t{constructor(e,i,r,o,s,a,l){var c=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngZone=l,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(()=>{Yo.instance.initialize(),_c.instance.initialize(),gc.instance.initialize(),vc.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Ms.instance.initialize(),jo.instance.initialize(),Go.instance.initialize(),new qo("DiceBot").initialize(),qo.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new qa("Jukebox").initialize(),new Re("SoundEffect").initialize(),jo.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),jo.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let E=en.createEmpty("none_icon").toContext();E.url="./assets/images/ic_account_circle_black_24dp_2x.png";let L=Et.instance.add(E);it.resumeAudioContext(),Ee.dicePick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.dicePut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.diceRoll1=at.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Ee.diceRoll2=at.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Ee.cardDraw=at.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Ee.cardPick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.cardPut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.cardShuffle=at.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Ee.piecePick=at.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.piecePut=at.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.blockPick=at.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ee.blockPut=at.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ee.lock=at.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ee.unlock=at.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ee.sweep=at.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Ee.selectionStart=at.instance.add("./assets/sounds/soundeffect-lab/decision50.mp3").identifier,at.instance.get(Ee.dicePick).isHidden=!0,at.instance.get(Ee.dicePut).isHidden=!0,at.instance.get(Ee.diceRoll1).isHidden=!0,at.instance.get(Ee.diceRoll2).isHidden=!0,at.instance.get(Ee.cardDraw).isHidden=!0,at.instance.get(Ee.cardPick).isHidden=!0,at.instance.get(Ee.cardPut).isHidden=!0,at.instance.get(Ee.cardShuffle).isHidden=!0,at.instance.get(Ee.piecePick).isHidden=!0,at.instance.get(Ee.piecePut).isHidden=!0,at.instance.get(Ee.blockPick).isHidden=!0,at.instance.get(Ee.blockPut).isHidden=!0,at.instance.get(Ee.lock).isHidden=!0,at.instance.get(Ee.unlock).isHidden=!0,at.instance.get(Ee.sweep).isHidden=!0,at.instance.get(Ee.selectionStart).isHidden=!0,Rt.createMyCursor(),Rt.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",Rt.myCursor.imageIdentifier=L.identifier,pe.register(this).on("UPDATE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DELETE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("UPDATE_SELECTION",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",Z=>{console.log("LOAD_CONFIG !!!"),We.setApiKey(Z.data.webrtc.key),We.open()}).on("FILE_LOADED",Z=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",Z=>{console.log("OPEN_NETWORK",Z.data.peerId),Rt.myCursor.peerId=We.peer.peerId,Rt.myCursor.userId=We.peer.userId}).on("NETWORK_ERROR",Z=>{console.log("NETWORK_ERROR",Z.data.peerId);let re=Z.data.errorType,oe=Z.data.errorMessage;this.ngZone.run((0,Mt.Z)(function*(){["peer-unavailable"].includes(re)||(yield c.modalService.open(dv,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:oe}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(re)&&(yield c.modalService.open(dv,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),We.open()))}))}).on("CONNECT_PEER",Z=>{Z.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DISCONNECT_PEER",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}),function NW(){let t=window.navigator.userAgent.toLowerCase();if(t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("macintosh")>-1&&"ontouchend"in document){let e=document.createElement("style");e.innerHTML="\n      .chrome-smooth-image-trick {\n        transform-style: flat;\n      }\n      ",document.body.appendChild(e)}}()}ngAfterViewInit(){hn.defaultParentViewContainerRef=Bi.defaultParentViewContainerRef=fr.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(DM,{width:500,height:450,left:100}),this.panelService.open(EM,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){pe.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=DM;break;case"ChatWindowComponent":i=EM,r.width=700;break;case"GameTableSettingComponent":i=xM,r={width:630,height:400,left:100};break;case"FileStorageComponent":i=iH;break;case"GameCharacterSheetComponent":i=Ko;break;case"JukeboxComponent":i=Z9;break;case"GameObjectInventoryComponent":i=D9}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,Mt.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=0<We.peer.roomName.length?We.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Yo.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}}return t.\u0275fac=function(e){return new(e||t)(J(Bi),J(hn),J(ti),J(Ha),J(X0),J(kr),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&An(OW,7,ar),2&e){let r;On(r=Pn())&&(i.modalLayerViewContainerRef=r.first)}},decls:61,vars:8,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(T(0,"div",0),Le(1,"game-table"),P(),T(2,"ui-panel",1)(3,"nav")(4,"ul")(5,"li",2),de("click",function(){return i.open("PeerMenuComponent")}),T(6,"a",3)(7,"div")(8,"i",4),q(9,"people"),P()(),T(10,"div"),q(11,"\u63a5\u7d9a"),P()()(),T(12,"li",2),de("click",function(){return i.open("ChatWindowComponent")}),T(13,"a",3)(14,"div")(15,"i",4),q(16,"speaker_notes"),P()(),T(17,"div"),q(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),P()()(),T(19,"li",2),de("click",function(){return i.open("GameTableSettingComponent")}),T(20,"a",3)(21,"div")(22,"i",4),q(23,"layers"),P()(),T(24,"div"),q(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),P()()(),T(26,"li",2),de("click",function(){return i.open("FileStorageComponent")}),T(27,"a",3)(28,"div")(29,"i",4),q(30,"photo_library"),P()(),T(31,"div"),q(32,"\u753b\u50cf"),P()()(),T(33,"li",2),de("click",function(){return i.open("JukeboxComponent")}),T(34,"a",3)(35,"div")(36,"i",5),q(37,"queue_music"),P()(),T(38,"div"),q(39,"\u97f3\u697d"),P()()(),T(40,"li",2),de("click",function(){return i.open("GameObjectInventoryComponent")}),T(41,"a",3)(42,"div")(43,"i",4),q(44,"folder_shared"),P()(),T(45,"div"),q(46,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),P()()(),T(47,"li")(48,"a",3)(49,"label")(50,"div")(51,"i",5),q(52,"open_in_browser"),P()(),T(53,"div"),q(54,"ZIP\u8aad\u8fbc"),P(),T(55,"input",6),de("change",function(o){return i.handleFileSelect(o)}),P()()()(),Q(56,AW,7,0,"li",7),Q(57,PW,7,1,"li",8),P()()(),Le(58,"div",null,9)(60,"network-indicator",10)),2&e&&(I(2),S("top",0)("left",0)("width",100)("height",470)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),I(54),S("ngIf",!i.isSaveing),I(1),S("ngIf",i.isSaveing))},dependencies:[pn,kW,MM,IW],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer;white-space:nowrap}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_vibration .2s infinite}@keyframes _ngcontent-%COMP%_vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]}),t})();hn.UIPanelComponentClass=MM,fr.ContextMenuComponentClass=Jj,Bi.ModalComponentClass=K9;let RW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ss({type:t,bootstrap:[FW]}),t.\u0275inj=Co({providers:[X0,Ha,fr,Bi,ov,hn,ti,av],imports:[FE,bB,uE,b4]}),t})();rL().bootstrapModule(RW).catch(t=>console.error(t))},1082:Ye=>{"use strict";Ye.exports=function N(Y){if(Y.length>=255)throw new TypeError("Alphabet too long");for(var O=new Uint8Array(256),A=0;A<O.length;A++)O[A]=255;for(var D=0;D<Y.length;D++){var f=Y.charAt(D),p=f.charCodeAt(0);if(255!==O[p])throw new TypeError(f+" is ambiguous");O[p]=D}var b=Y.length,x=Y.charAt(0),M=Math.log(b)/Math.log(256),m=Math.log(256)/Math.log(b);function _(k){if("string"!=typeof k)throw new TypeError("Expected String");if(0===k.length)return new Uint8Array;for(var w=0,R=0,W=0;k[w]===x;)R++,w++;for(var ne=(k.length-w)*M+1>>>0,B=new Uint8Array(ne);k[w];){var V=O[k.charCodeAt(w)];if(255===V)return;for(var z=0,te=ne-1;(0!==V||z<W)&&-1!==te;te--,z++)B[te]=(V+=b*B[te]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");W=z,w++}for(var ee=ne-W;ee!==ne&&0===B[ee];)ee++;for(var K=new Uint8Array(R+(ne-ee)),Ce=R;ee!==ne;)K[Ce++]=B[ee++];return K}return{encode:function d(k){if(k instanceof Uint8Array||(ArrayBuffer.isView(k)?k=new Uint8Array(k.buffer,k.byteOffset,k.byteLength):Array.isArray(k)&&(k=Uint8Array.from(k))),!(k instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===k.length)return"";for(var w=0,R=0,W=0,ne=k.length;W!==ne&&0===k[W];)W++,w++;for(var B=(ne-W)*m+1>>>0,V=new Uint8Array(B);W!==ne;){for(var z=k[W],te=0,ee=B-1;(0!==z||te<R)&&-1!==ee;ee--,te++)V[ee]=(z+=256*V[ee]>>>0)%b>>>0,z=z/b>>>0;if(0!==z)throw new Error("Non-zero carry");R=te,W++}for(var K=B-R;K!==B&&0===V[K];)K++;for(var Ce=x.repeat(w);K<B;++K)Ce+=Y.charAt(V[K]);return Ce},decodeUnsafe:_,decode:function v(k){var w=_(k);if(w)return w;throw new Error("Non-base"+b+" character")}}}},7585:function(Ye,N,Y){var O;Ye.exports=(O=O||function(A,D){var f;if(typeof window<"u"&&window.crypto&&(f=window.crypto),typeof self<"u"&&self.crypto&&(f=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(f=globalThis.crypto),!f&&typeof window<"u"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof global<"u"&&global.crypto&&(f=global.crypto),!f)try{f=Y(2480)}catch{}var p=function(){if(f){if("function"==typeof f.getRandomValues)try{return f.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof f.randomBytes)try{return f.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},b=Object.create||function(){function B(){}return function(V){var z;return B.prototype=V,z=new B,B.prototype=null,z}}(),x={},M=x.lib={},m=M.Base={extend:function(B){var V=b(this);return B&&V.mixIn(B),(!V.hasOwnProperty("init")||this.init===V.init)&&(V.init=function(){V.$super.init.apply(this,arguments)}),V.init.prototype=V,V.$super=this,V},create:function(){var B=this.extend();return B.init.apply(B,arguments),B},init:function(){},mixIn:function(B){for(var V in B)B.hasOwnProperty(V)&&(this[V]=B[V]);B.hasOwnProperty("toString")&&(this.toString=B.toString)},clone:function(){return this.init.prototype.extend(this)}},d=M.WordArray=m.extend({init:function(B,V){B=this.words=B||[],this.sigBytes=null!=V?V:4*B.length},toString:function(B){return(B||v).stringify(this)},concat:function(B){var V=this.words,z=B.words,te=this.sigBytes,ee=B.sigBytes;if(this.clamp(),te%4)for(var K=0;K<ee;K++)V[te+K>>>2]|=(z[K>>>2]>>>24-K%4*8&255)<<24-(te+K)%4*8;else for(var $=0;$<ee;$+=4)V[te+$>>>2]=z[$>>>2];return this.sigBytes+=ee,this},clamp:function(){var B=this.words,V=this.sigBytes;B[V>>>2]&=4294967295<<32-V%4*8,B.length=A.ceil(V/4)},clone:function(){var B=m.clone.call(this);return B.words=this.words.slice(0),B},random:function(B){for(var V=[],z=0;z<B;z+=4)V.push(p());return new d.init(V,B)}}),_=x.enc={},v=_.Hex={stringify:function(B){for(var V=B.words,z=B.sigBytes,te=[],ee=0;ee<z;ee++){var K=V[ee>>>2]>>>24-ee%4*8&255;te.push((K>>>4).toString(16)),te.push((15&K).toString(16))}return te.join("")},parse:function(B){for(var V=B.length,z=[],te=0;te<V;te+=2)z[te>>>3]|=parseInt(B.substr(te,2),16)<<24-te%8*4;return new d.init(z,V/2)}},k=_.Latin1={stringify:function(B){for(var V=B.words,z=B.sigBytes,te=[],ee=0;ee<z;ee++)te.push(String.fromCharCode(V[ee>>>2]>>>24-ee%4*8&255));return te.join("")},parse:function(B){for(var V=B.length,z=[],te=0;te<V;te++)z[te>>>2]|=(255&B.charCodeAt(te))<<24-te%4*8;return new d.init(z,V)}},w=_.Utf8={stringify:function(B){try{return decodeURIComponent(escape(k.stringify(B)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(B){return k.parse(unescape(encodeURIComponent(B)))}},R=M.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(B){"string"==typeof B&&(B=w.parse(B)),this._data.concat(B),this._nDataBytes+=B.sigBytes},_process:function(B){var V,z=this._data,te=z.words,ee=z.sigBytes,K=this.blockSize,$=ee/(4*K),ae=($=B?A.ceil($):A.max((0|$)-this._minBufferSize,0))*K,C=A.min(4*ae,ee);if(ae){for(var ge=0;ge<ae;ge+=K)this._doProcessBlock(te,ge);V=te.splice(0,ae),z.sigBytes-=C}return new d.init(V,C)},clone:function(){var B=m.clone.call(this);return B._data=this._data.clone(),B},_minBufferSize:0}),ne=(M.Hasher=R.extend({cfg:m.extend(),init:function(B){this.cfg=this.cfg.extend(B),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(B){return this._append(B),this._process(),this},finalize:function(B){return B&&this._append(B),this._doFinalize()},blockSize:16,_createHelper:function(B){return function(V,z){return new B.init(z).finalize(V)}},_createHmacHelper:function(B){return function(V,z){return new ne.HMAC.init(B,z).finalize(V)}}}),x.algo={});return x}(Math),O)},7412:function(Ye,N,Y){var O;Ye.exports=(O=Y(7585),function(){if("function"==typeof ArrayBuffer){var f=O.lib.WordArray,p=f.init,b=f.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||typeof Uint8ClampedArray<"u"&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var M=x.byteLength,m=[],d=0;d<M;d++)m[d>>>2]|=x[d]<<24-d%4*8;p.call(this,m,M)}else p.apply(this,arguments)};b.prototype=f}}(),O.lib.WordArray)},1817:function(Ye,N,Y){var O;Ye.exports=(O=Y(7585),function(A){var D=O,f=D.lib,p=f.WordArray,b=f.Hasher,x=D.algo,M=[],m=[];!function(){function v(W){for(var ne=A.sqrt(W),B=2;B<=ne;B++)if(!(W%B))return!1;return!0}function k(W){return 4294967296*(W-(0|W))|0}for(var w=2,R=0;R<64;)v(w)&&(R<8&&(M[R]=k(A.pow(w,.5))),m[R]=k(A.pow(w,1/3)),R++),w++}();var d=[],_=x.SHA256=b.extend({_doReset:function(){this._hash=new p.init(M.slice(0))},_doProcessBlock:function(v,k){for(var w=this._hash.words,R=w[0],W=w[1],ne=w[2],B=w[3],V=w[4],z=w[5],te=w[6],ee=w[7],K=0;K<64;K++){if(K<16)d[K]=0|v[k+K];else{var Ce=d[K-15],ae=d[K-2];d[K]=((Ce<<25|Ce>>>7)^(Ce<<14|Ce>>>18)^Ce>>>3)+d[K-7]+((ae<<15|ae>>>17)^(ae<<13|ae>>>19)^ae>>>10)+d[K-16]}var ze=R&W^R&ne^W&ne,ve=ee+((V<<26|V>>>6)^(V<<21|V>>>11)^(V<<7|V>>>25))+(V&z^~V&te)+m[K]+d[K];ee=te,te=z,z=V,V=B+ve|0,B=ne,ne=W,W=R,R=ve+(((R<<30|R>>>2)^(R<<19|R>>>13)^(R<<10|R>>>22))+ze)|0}w[0]=w[0]+R|0,w[1]=w[1]+W|0,w[2]=w[2]+ne|0,w[3]=w[3]+B|0,w[4]=w[4]+V|0,w[5]=w[5]+z|0,w[6]=w[6]+te|0,w[7]=w[7]+ee|0},_doFinalize:function(){var v=this._data,k=v.words,w=8*this._nDataBytes,R=8*v.sigBytes;return k[R>>>5]|=128<<24-R%32,k[14+(R+64>>>9<<4)]=A.floor(w/4294967296),k[15+(R+64>>>9<<4)]=w,v.sigBytes=4*k.length,this._process(),this._hash},clone:function(){var v=b.clone.call(this);return v._hash=this._hash.clone(),v}});D.SHA256=b._createHelper(_),D.HmacSHA256=b._createHmacHelper(_)}(Math),O.SHA256)},6654:Ye=>{!function(Y){Ye.exports=Y;var O="listeners",A={on:function f(m,d){return M(this,m).push(d),this},once:function p(m,d){var _=this;return v.originalListener=d,M(_,m).push(v),_;function v(){b.call(_,m,v),d.apply(this,arguments)}},off:b,emit:function x(m,d){var _=this,v=M(_,m,!0);if(!v)return!1;var k=arguments.length;if(1===k)v.forEach(function R(B){B.call(_)});else if(2===k)v.forEach(function W(B){B.call(_,d)});else{var w=Array.prototype.slice.call(arguments,1);v.forEach(function ne(B){B.apply(_,w)})}return!!v.length}};function D(m){for(var d in A)m[d]=A[d];return m}function b(m,d){var v,_=this;if(arguments.length){if(d){if(v=M(_,m,!0)){if(!(v=v.filter(function k(w){return w!==d&&w.originalListener!==d})).length)return b.call(_,m);_[O][m]=v}}else if((v=_[O])&&(delete v[m],!Object.keys(v).length))return b.call(_)}else delete _[O];return _}function M(m,d,_){if(!_||m[O]){var v=m[O]||(m[O]={});return v[d]||(v[d]=[])}}D(Y.prototype),Y.mixin=D}(function N(){if(!(this instanceof N))return new N})},9069:Ye=>{"use strict";var O,N="object"==typeof Reflect?Reflect:null,Y=N&&"function"==typeof N.apply?N.apply:function(z,te,ee){return Function.prototype.apply.call(z,te,ee)};O=N&&"function"==typeof N.ownKeys?N.ownKeys:Object.getOwnPropertySymbols?function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:function(z){return Object.getOwnPropertyNames(z)};var D=Number.isNaN||function(z){return z!=z};function f(){f.init.call(this)}Ye.exports=f,Ye.exports.once=function W(V,z){return new Promise(function(te,ee){function K($){V.removeListener(z,Ce),ee($)}function Ce(){"function"==typeof V.removeListener&&V.removeListener("error",K),te([].slice.call(arguments))}B(V,z,Ce,{once:!0}),"error"!==z&&function ne(V,z,te){"function"==typeof V.on&&B(V,"error",z,te)}(V,K,{once:!0})})},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var p=10;function b(V){if("function"!=typeof V)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof V)}function x(V){return void 0===V._maxListeners?f.defaultMaxListeners:V._maxListeners}function M(V,z,te,ee){var K,Ce,$;if(b(te),void 0===(Ce=V._events)?(Ce=V._events=Object.create(null),V._eventsCount=0):(void 0!==Ce.newListener&&(V.emit("newListener",z,te.listener?te.listener:te),Ce=V._events),$=Ce[z]),void 0===$)$=Ce[z]=te,++V._eventsCount;else if("function"==typeof $?$=Ce[z]=ee?[te,$]:[$,te]:ee?$.unshift(te):$.push(te),(K=x(V))>0&&$.length>K&&!$.warned){$.warned=!0;var ae=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");ae.name="MaxListenersExceededWarning",ae.emitter=V,ae.type=z,ae.count=$.length,function A(V){console&&console.warn&&console.warn(V)}(ae)}return V}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(V,z,te){var ee={fired:!1,wrapFn:void 0,target:V,type:z,listener:te},K=m.bind(ee);return K.listener=te,ee.wrapFn=K,K}function _(V,z,te){var ee=V._events;if(void 0===ee)return[];var K=ee[z];return void 0===K?[]:"function"==typeof K?te?[K.listener||K]:[K]:te?function R(V){for(var z=new Array(V.length),te=0;te<z.length;++te)z[te]=V[te].listener||V[te];return z}(K):k(K,K.length)}function v(V){var z=this._events;if(void 0!==z){var te=z[V];if("function"==typeof te)return 1;if(void 0!==te)return te.length}return 0}function k(V,z){for(var te=new Array(z),ee=0;ee<z;++ee)te[ee]=V[ee];return te}function B(V,z,te,ee){if("function"==typeof V.on)ee.once?V.once(z,te):V.on(z,te);else{if("function"!=typeof V.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof V);V.addEventListener(z,function K(Ce){ee.once&&V.removeEventListener(z,K),te(Ce)})}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(V){if("number"!=typeof V||V<0||D(V))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+V+".");p=V}}),f.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(z){if("number"!=typeof z||z<0||D(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this},f.prototype.getMaxListeners=function(){return x(this)},f.prototype.emit=function(z){for(var te=[],ee=1;ee<arguments.length;ee++)te.push(arguments[ee]);var K="error"===z,Ce=this._events;if(void 0!==Ce)K=K&&void 0===Ce.error;else if(!K)return!1;if(K){var $;if(te.length>0&&($=te[0]),$ instanceof Error)throw $;var ae=new Error("Unhandled error."+($?" ("+$.message+")":""));throw ae.context=$,ae}var C=Ce[z];if(void 0===C)return!1;if("function"==typeof C)Y(C,this,te);else{var ge=C.length,ze=k(C,ge);for(ee=0;ee<ge;++ee)Y(ze[ee],this,te)}return!0},f.prototype.on=f.prototype.addListener=function(z,te){return M(this,z,te,!1)},f.prototype.prependListener=function(z,te){return M(this,z,te,!0)},f.prototype.once=function(z,te){return b(te),this.on(z,d(this,z,te)),this},f.prototype.prependOnceListener=function(z,te){return b(te),this.prependListener(z,d(this,z,te)),this},f.prototype.off=f.prototype.removeListener=function(z,te){var ee,K,Ce,$,ae;if(b(te),void 0===(K=this._events))return this;if(void 0===(ee=K[z]))return this;if(ee===te||ee.listener===te)0==--this._eventsCount?this._events=Object.create(null):(delete K[z],K.removeListener&&this.emit("removeListener",z,ee.listener||te));else if("function"!=typeof ee){for(Ce=-1,$=ee.length-1;$>=0;$--)if(ee[$]===te||ee[$].listener===te){ae=ee[$].listener,Ce=$;break}if(Ce<0)return this;0===Ce?ee.shift():function w(V,z){for(;z+1<V.length;z++)V[z]=V[z+1];V.pop()}(ee,Ce),1===ee.length&&(K[z]=ee[0]),void 0!==K.removeListener&&this.emit("removeListener",z,ae||te)}return this},f.prototype.removeAllListeners=function(z){var te,ee,K;if(void 0===(ee=this._events))return this;if(void 0===ee.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ee[z]&&(0==--this._eventsCount?this._events=Object.create(null):delete ee[z]),this;if(0===arguments.length){var $,Ce=Object.keys(ee);for(K=0;K<Ce.length;++K)"removeListener"!==($=Ce[K])&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(te=ee[z]))this.removeListener(z,te);else if(void 0!==te)for(K=te.length-1;K>=0;K--)this.removeListener(z,te[K]);return this},f.prototype.listeners=function(z){return _(this,z,!0)},f.prototype.rawListeners=function(z){return _(this,z,!1)},f.listenerCount=function(V,z){return"function"==typeof V.listenerCount?V.listenerCount(z):v.call(V,z)},f.prototype.listenerCount=v,f.prototype.eventNames=function(){return this._eventsCount>0?O(this._events):[]}},4327:function(Ye,N){var Y,A;void 0!==(A="function"==typeof(Y=function(){"use strict";function f(d,_,v){var k=new XMLHttpRequest;k.open("GET",d),k.responseType="blob",k.onload=function(){m(k.response,_,v)},k.onerror=function(){console.error("could not download file")},k.send()}function p(d){var _=new XMLHttpRequest;_.open("HEAD",d,!1);try{_.send()}catch{}return 200<=_.status&&299>=_.status}function b(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(_)}}var x="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,M=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=x.saveAs||("object"!=typeof window||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!M?function(d,_,v){var k=x.URL||x.webkitURL,w=document.createElement("a");w.download=_=_||d.name||"download",w.rel="noopener","string"==typeof d?(w.href=d,w.origin===location.origin?b(w):p(w.href)?f(d,_,v):b(w,w.target="_blank")):(w.href=k.createObjectURL(d),setTimeout(function(){k.revokeObjectURL(w.href)},4e4),setTimeout(function(){b(w)},0))}:"msSaveOrOpenBlob"in navigator?function(d,_,v){if(_=_||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function D(d,_){return typeof _>"u"?_={autoBom:!1}:"object"!=typeof _&&(console.warn("Deprecated: Expected third argument to be a object"),_={autoBom:!_}),_.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,v),_);else if(p(d))f(d,_,v);else{var k=document.createElement("a");k.href=d,k.target="_blank",setTimeout(function(){b(k)})}}:function(d,_,v,k){if((k=k||open("","_blank"))&&(k.document.title=k.document.body.innerText="downloading..."),"string"==typeof d)return f(d,_,v);var w="application/octet-stream"===d.type,R=/constructor/i.test(x.HTMLElement)||x.safari,W=/CriOS\/[\d]+/.test(navigator.userAgent);if((W||w&&R||M)&&typeof FileReader<"u"){var ne=new FileReader;ne.onloadend=function(){var z=ne.result;z=W?z:z.replace(/^data:[^;]*;/,"data:attachment/file;"),k?k.location.href=z:location=z,k=null},ne.readAsDataURL(d)}else{var B=x.URL||x.webkitURL,V=B.createObjectURL(d);k?k.location=V:location.href=V,k=null,setTimeout(function(){B.revokeObjectURL(V)},4e4)}});x.saveAs=m.saveAs=m,Ye.exports=m})?Y.apply(N,[]):Y)&&(Ye.exports=A)},5386:(Ye,N,Y)=>{var O;!function(A,D,f,p){"use strict";var W,b=["","webkit","Moz","MS","ms","o"],x=D.createElement("div"),M="function",m=Math.round,d=Math.abs,_=Date.now;function v(F,j,ie){return setTimeout(z(F,ie),j)}function k(F,j,ie){return!!Array.isArray(F)&&(w(F,ie[j],ie),!0)}function w(F,j,ie){var ye;if(F)if(F.forEach)F.forEach(j,ie);else if(F.length!==p)for(ye=0;ye<F.length;)j.call(ie,F[ye],ye,F),ye++;else for(ye in F)F.hasOwnProperty(ye)&&j.call(ie,F[ye],ye,F)}function R(F,j,ie){var ye="DEPRECATED METHOD: "+j+"\n"+ie+" AT \n";return function(){var Oe=new Error("get-stack-trace"),$e=Oe&&Oe.stack?Oe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",jt=A.console&&(A.console.warn||A.console.log);return jt&&jt.call(A.console,ye,$e),F.apply(this,arguments)}}W="function"!=typeof Object.assign?function(j){if(j===p||null===j)throw new TypeError("Cannot convert undefined or null to object");for(var ie=Object(j),ye=1;ye<arguments.length;ye++){var Oe=arguments[ye];if(Oe!==p&&null!==Oe)for(var $e in Oe)Oe.hasOwnProperty($e)&&(ie[$e]=Oe[$e])}return ie}:Object.assign;var ne=R(function(j,ie,ye){for(var Oe=Object.keys(ie),$e=0;$e<Oe.length;)(!ye||ye&&j[Oe[$e]]===p)&&(j[Oe[$e]]=ie[Oe[$e]]),$e++;return j},"extend","Use `assign`."),B=R(function(j,ie){return ne(j,ie,!0)},"merge","Use `assign`.");function V(F,j,ie){var Oe,ye=j.prototype;(Oe=F.prototype=Object.create(ye)).constructor=F,Oe._super=ye,ie&&W(Oe,ie)}function z(F,j){return function(){return F.apply(j,arguments)}}function te(F,j){return typeof F==M?F.apply(j&&j[0]||p,j):F}function ee(F,j){return F===p?j:F}function K(F,j,ie){w(C(j),function(ye){F.addEventListener(ye,ie,!1)})}function Ce(F,j,ie){w(C(j),function(ye){F.removeEventListener(ye,ie,!1)})}function $(F,j){for(;F;){if(F==j)return!0;F=F.parentNode}return!1}function ae(F,j){return F.indexOf(j)>-1}function C(F){return F.trim().split(/\s+/g)}function ge(F,j,ie){if(F.indexOf&&!ie)return F.indexOf(j);for(var ye=0;ye<F.length;){if(ie&&F[ye][ie]==j||!ie&&F[ye]===j)return ye;ye++}return-1}function ze(F){return Array.prototype.slice.call(F,0)}function le(F,j,ie){for(var ye=[],Oe=[],$e=0;$e<F.length;){var jt=j?F[$e][j]:F[$e];ge(Oe,jt)<0&&ye.push(F[$e]),Oe[$e]=jt,$e++}return ie&&(ye=j?ye.sort(function(hi,Sn){return hi[j]>Sn[j]}):ye.sort()),ye}function Ae(F,j){for(var ie,ye,Oe=j[0].toUpperCase()+j.slice(1),$e=0;$e<b.length;){if((ye=(ie=b[$e])?ie+Oe:j)in F)return ye;$e++}return p}var ve=1;function fe(F){var j=F.ownerDocument||F;return j.defaultView||j.parentWindow||A}var Je="ontouchstart"in A,Ge=Ae(A,"PointerEvent")!==p,Ue=Je&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),qt="touch",Ie="mouse",pt=25,nt=1,Kt=2,Ct=4,y=8,_e=1,X=2,G=4,U=8,se=16,we=X|G,Te=U|se,he=we|Te,Ne=["x","y"],Ze=["clientX","clientY"];function Pe(F,j){var ie=this;this.manager=F,this.callback=j,this.element=F.element,this.target=F.options.inputTarget,this.domHandler=function(ye){te(F.options.enable,[F])&&ie.handler(ye)},this.init()}function tn(F,j,ie){var ye=ie.pointers.length,Oe=ie.changedPointers.length,$e=j&nt&&ye-Oe==0,jt=j&(Ct|y)&&ye-Oe==0;ie.isFirst=!!$e,ie.isFinal=!!jt,$e&&(F.session={}),ie.eventType=j,function Vt(F,j){var ie=F.session,ye=j.pointers,Oe=ye.length;ie.firstInput||(ie.firstInput=er(j)),Oe>1&&!ie.firstMultiple?ie.firstMultiple=er(j):1===Oe&&(ie.firstMultiple=!1);var $e=ie.firstInput,jt=ie.firstMultiple,Kn=jt?jt.center:$e.center,hi=j.center=xi(ye);j.timeStamp=_(),j.deltaTime=j.timeStamp-$e.timeStamp,j.angle=tr(Kn,hi),j.distance=yo(Kn,hi),function Vi(F,j){var ie=j.center,ye=F.offsetDelta||{},Oe=F.prevDelta||{},$e=F.prevInput||{};(j.eventType===nt||$e.eventType===Ct)&&(Oe=F.prevDelta={x:$e.deltaX||0,y:$e.deltaY||0},ye=F.offsetDelta={x:ie.x,y:ie.y}),j.deltaX=Oe.x+(ie.x-ye.x),j.deltaY=Oe.y+(ie.y-ye.y)}(ie,j),j.offsetDirection=Is(j.deltaX,j.deltaY);var Sn=mn(j.deltaTime,j.deltaX,j.deltaY);j.overallVelocityX=Sn.x,j.overallVelocityY=Sn.y,j.overallVelocity=d(Sn.x)>d(Sn.y)?Sn.x:Sn.y,j.scale=jt?function md(F,j){return yo(j[0],j[1],Ze)/yo(F[0],F[1],Ze)}(jt.pointers,ye):1,j.rotation=jt?function Qa(F,j){return tr(j[1],j[0],Ze)+tr(F[1],F[0],Ze)}(jt.pointers,ye):0,j.maxPointers=ie.prevInput?j.pointers.length>ie.prevInput.maxPointers?j.pointers.length:ie.prevInput.maxPointers:j.pointers.length,function ks(F,j){var Oe,$e,jt,Kn,ie=F.lastInterval||j,ye=j.timeStamp-ie.timeStamp;if(j.eventType!=y&&(ye>pt||ie.velocity===p)){var hi=j.deltaX-ie.deltaX,Sn=j.deltaY-ie.deltaY,io=mn(ye,hi,Sn);$e=io.x,jt=io.y,Oe=d(io.x)>d(io.y)?io.x:io.y,Kn=Is(hi,Sn),F.lastInterval=j}else Oe=ie.velocity,$e=ie.velocityX,jt=ie.velocityY,Kn=ie.direction;j.velocity=Oe,j.velocityX=$e,j.velocityY=jt,j.direction=Kn}(ie,j);var io=F.element;$(j.srcEvent.target,io)&&(io=j.srcEvent.target),j.target=io}(F,ie),F.emit("hammer.input",ie),F.recognize(ie),F.session.prevInput=ie}function er(F){for(var j=[],ie=0;ie<F.pointers.length;)j[ie]={clientX:m(F.pointers[ie].clientX),clientY:m(F.pointers[ie].clientY)},ie++;return{timeStamp:_(),pointers:j,center:xi(j),deltaX:F.deltaX,deltaY:F.deltaY}}function xi(F){var j=F.length;if(1===j)return{x:m(F[0].clientX),y:m(F[0].clientY)};for(var ie=0,ye=0,Oe=0;Oe<j;)ie+=F[Oe].clientX,ye+=F[Oe].clientY,Oe++;return{x:m(ie/j),y:m(ye/j)}}function mn(F,j,ie){return{x:j/F||0,y:ie/F||0}}function Is(F,j){return F===j?_e:d(F)>=d(j)?F<0?X:G:j<0?U:se}function yo(F,j,ie){ie||(ie=Ne);var ye=j[ie[0]]-F[ie[0]],Oe=j[ie[1]]-F[ie[1]];return Math.sqrt(ye*ye+Oe*Oe)}function tr(F,j,ie){return ie||(ie=Ne),180*Math.atan2(j[ie[1]]-F[ie[1]],j[ie[0]]-F[ie[0]])/Math.PI}Pe.prototype={handler:function(){},init:function(){this.evEl&&K(this.element,this.evEl,this.domHandler),this.evTarget&&K(this.target,this.evTarget,this.domHandler),this.evWin&&K(fe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ce(this.element,this.evEl,this.domHandler),this.evTarget&&Ce(this.target,this.evTarget,this.domHandler),this.evWin&&Ce(fe(this.element),this.evWin,this.domHandler)}};var _d={mousedown:nt,mousemove:Kt,mouseup:Ct},vd="mousedown",Cc="mousemove mouseup";function Jr(){this.evEl=vd,this.evWin=Cc,this.pressed=!1,Pe.apply(this,arguments)}V(Jr,Pe,{handler:function(j){var ie=_d[j.type];ie&nt&&0===j.button&&(this.pressed=!0),ie&Kt&&1!==j.which&&(ie=Ct),this.pressed&&(ie&Ct&&(this.pressed=!1),this.callback(this.manager,ie,{pointers:[j],changedPointers:[j],pointerType:Ie,srcEvent:j}))}});var es={pointerdown:nt,pointermove:Kt,pointerup:Ct,pointercancel:y,pointerout:y},yd={2:qt,3:"pen",4:Ie,5:"kinect"},wc="pointerdown",Ec="pointermove pointerup pointercancel";function Ja(){this.evEl=wc,this.evWin=Ec,Pe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A.MSPointerEvent&&!A.PointerEvent&&(wc="MSPointerDown",Ec="MSPointerMove MSPointerUp MSPointerCancel"),V(Ja,Pe,{handler:function(j){var ie=this.store,ye=!1,Oe=j.type.toLowerCase().replace("ms",""),$e=es[Oe],jt=yd[j.pointerType]||j.pointerType,Kn=jt==qt,hi=ge(ie,j.pointerId,"pointerId");$e&nt&&(0===j.button||Kn)?hi<0&&(ie.push(j),hi=ie.length-1):$e&(Ct|y)&&(ye=!0),!(hi<0)&&(ie[hi]=j,this.callback(this.manager,$e,{pointers:ie,changedPointers:[j],pointerType:jt,srcEvent:j}),ye&&ie.splice(hi,1))}});var dp={touchstart:nt,touchmove:Kt,touchend:Ct,touchcancel:y},bd="touchstart",Cd="touchstart touchmove touchend touchcancel";function Tc(){this.evTarget=bd,this.evWin=Cd,this.started=!1,Pe.apply(this,arguments)}function wd(F,j){var ie=ze(F.touches),ye=ze(F.changedTouches);return j&(Ct|y)&&(ie=le(ie.concat(ye),"identifier",!0)),[ie,ye]}V(Tc,Pe,{handler:function(j){var ie=dp[j.type];if(ie===nt&&(this.started=!0),this.started){var ye=wd.call(this,j,ie);ie&(Ct|y)&&ye[0].length-ye[1].length==0&&(this.started=!1),this.callback(this.manager,ie,{pointers:ye[0],changedPointers:ye[1],pointerType:qt,srcEvent:j})}}});var eo={touchstart:nt,touchmove:Kt,touchend:Ct,touchcancel:y},hp="touchstart touchmove touchend touchcancel";function el(){this.evTarget=hp,this.targetIds={},Pe.apply(this,arguments)}function fp(F,j){var ie=ze(F.touches),ye=this.targetIds;if(j&(nt|Kt)&&1===ie.length)return ye[ie[0].identifier]=!0,[ie,ie];var Oe,$e,jt=ze(F.changedTouches),Kn=[],hi=this.target;if($e=ie.filter(function(Sn){return $(Sn.target,hi)}),j===nt)for(Oe=0;Oe<$e.length;)ye[$e[Oe].identifier]=!0,Oe++;for(Oe=0;Oe<jt.length;)ye[jt[Oe].identifier]&&Kn.push(jt[Oe]),j&(Ct|y)&&delete ye[jt[Oe].identifier],Oe++;return Kn.length?[le($e.concat(Kn),"identifier",!0),Kn]:void 0}V(el,Pe,{handler:function(j){var ie=eo[j.type],ye=fp.call(this,j,ie);ye&&this.callback(this.manager,ie,{pointers:ye[0],changedPointers:ye[1],pointerType:qt,srcEvent:j})}});var pp=2500,xc=25;function Dc(){Pe.apply(this,arguments);var F=z(this.handler,this);this.touch=new el(this.manager,F),this.mouse=new Jr(this.manager,F),this.primaryTouch=null,this.lastTouches=[]}function gp(F,j){F&nt?(this.primaryTouch=j.changedPointers[0].identifier,to.call(this,j)):F&(Ct|y)&&to.call(this,j)}function to(F){var j=F.changedPointers[0];if(j.identifier===this.primaryTouch){var ie={x:j.clientX,y:j.clientY};this.lastTouches.push(ie);var ye=this.lastTouches;setTimeout(function(){var $e=ye.indexOf(ie);$e>-1&&ye.splice($e,1)},pp)}}function mp(F){for(var j=F.srcEvent.clientX,ie=F.srcEvent.clientY,ye=0;ye<this.lastTouches.length;ye++){var Oe=this.lastTouches[ye],$e=Math.abs(j-Oe.x),jt=Math.abs(ie-Oe.y);if($e<=xc&&jt<=xc)return!0}return!1}V(Dc,Pe,{handler:function(j,ie,ye){var $e=ye.pointerType==Ie;if(!($e&&ye.sourceCapabilities&&ye.sourceCapabilities.firesTouchEvents)){if(ye.pointerType==qt)gp.call(this,ie,ye);else if($e&&mp.call(this,ye))return;this.callback(j,ie,ye)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Sc=Ae(x.style,"touchAction"),Ed=Sc!==p,Mc="compute",kc="manipulation",ts="none",ns="pan-x",sa="pan-y",tl=function xd(){if(!Ed)return!1;var F={},j=A.CSS&&A.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ie){F[ie]=!j||A.CSS.supports("touch-action",ie)}),F}();function Ic(F,j){this.manager=F,this.set(j)}Ic.prototype={set:function(F){F==Mc&&(F=this.compute()),Ed&&this.manager.element.style&&tl[F]&&(this.manager.element.style[Sc]=F),this.actions=F.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var F=[];return w(this.manager.recognizers,function(j){te(j.options.enable,[j])&&(F=F.concat(j.getTouchAction()))}),function Td(F){if(ae(F,ts))return ts;var j=ae(F,ns),ie=ae(F,sa);return j&&ie?ts:j||ie?j?ns:sa:ae(F,kc)?kc:"auto"}(F.join(" "))},preventDefaults:function(F){var j=F.srcEvent,ie=F.offsetDirection;if(!this.manager.session.prevented){var ye=this.actions,Oe=ae(ye,ts)&&!tl[ts],$e=ae(ye,sa)&&!tl[sa],jt=ae(ye,ns)&&!tl[ns];if(Oe&&1===F.pointers.length&&F.distance<2&&F.deltaTime<250)return;return jt&&$e||!(Oe||$e&&ie&we||jt&&ie&Te)?void 0:this.preventSrc(j)}j.preventDefault()},preventSrc:function(F){this.manager.session.prevented=!0,F.preventDefault()}};var nl=1,nr=2,Os=4,bo=8,Or=bo,aa=16;function Pr(F){this.options=W({},this.defaults,F||{}),this.id=function xe(){return ve++}(),this.manager=null,this.options.enable=ee(this.options.enable,!0),this.state=nl,this.simultaneous={},this.requireFail=[]}function Dd(F){return F&aa?"cancel":F&bo?"end":F&Os?"move":F&nr?"start":""}function Sd(F){return F==se?"down":F==U?"up":F==X?"left":F==G?"right":""}function As(F,j){var ie=j.manager;return ie?ie.get(F):F}function Ut(){Pr.apply(this,arguments)}function Ps(){Ut.apply(this,arguments),this.pX=null,this.pY=null}function an(){Ut.apply(this,arguments)}function la(){Pr.apply(this,arguments),this._timer=null,this._input=null}function Oc(){Ut.apply(this,arguments)}function ln(){Ut.apply(this,arguments)}function ut(){Pr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function no(F,j){return(j=j||{}).recognizers=ee(j.recognizers,no.defaults.preset),new Fs(F,j)}function Fs(F,j){this.options=W({},no.defaults,j||{}),this.options.inputTarget=this.options.inputTarget||F,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=F,this.input=function ct(F){return new(F.options.inputClass||(Ge?Ja:Ue?el:Je?Dc:Jr))(F,tn)}(this),this.touchAction=new Ic(this,this.options.touchAction),De(this,!0),w(this.options.recognizers,function(ie){var ye=this.add(new ie[0](ie[1]));ie[2]&&ye.recognizeWith(ie[2]),ie[3]&&ye.requireFailure(ie[3])},this)}function De(F,j){var ye,ie=F.element;ie.style&&(w(F.options.cssProps,function(Oe,$e){ye=Ae(ie.style,$e),j?(F.oldCssProps[ye]=ie.style[ye],ie.style[ye]=Oe):ie.style[ye]=F.oldCssProps[ye]||""}),j||(F.oldCssProps={}))}Pr.prototype={defaults:{},set:function(F){return W(this.options,F),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(F){if(k(F,"recognizeWith",this))return this;var j=this.simultaneous;return j[(F=As(F,this)).id]||(j[F.id]=F,F.recognizeWith(this)),this},dropRecognizeWith:function(F){return k(F,"dropRecognizeWith",this)||(F=As(F,this),delete this.simultaneous[F.id]),this},requireFailure:function(F){if(k(F,"requireFailure",this))return this;var j=this.requireFail;return-1===ge(j,F=As(F,this))&&(j.push(F),F.requireFailure(this)),this},dropRequireFailure:function(F){if(k(F,"dropRequireFailure",this))return this;F=As(F,this);var j=ge(this.requireFail,F);return j>-1&&this.requireFail.splice(j,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(F){return!!this.simultaneous[F.id]},emit:function(F){var j=this,ie=this.state;function ye(Oe){j.manager.emit(Oe,F)}ie<bo&&ye(j.options.event+Dd(ie)),ye(j.options.event),F.additionalEvent&&ye(F.additionalEvent),ie>=bo&&ye(j.options.event+Dd(ie))},tryEmit:function(F){if(this.canEmit())return this.emit(F);this.state=32},canEmit:function(){for(var F=0;F<this.requireFail.length;){if(!(this.requireFail[F].state&(32|nl)))return!1;F++}return!0},recognize:function(F){var j=W({},F);if(!te(this.options.enable,[this,j]))return this.reset(),void(this.state=32);this.state&(Or|aa|32)&&(this.state=nl),this.state=this.process(j),this.state&(nr|Os|bo|aa)&&this.tryEmit(j)},process:function(F){},getTouchAction:function(){},reset:function(){}},V(Ut,Pr,{defaults:{pointers:1},attrTest:function(F){var j=this.options.pointers;return 0===j||F.pointers.length===j},process:function(F){var j=this.state,ie=F.eventType,ye=j&(nr|Os),Oe=this.attrTest(F);return ye&&(ie&y||!Oe)?j|aa:ye||Oe?ie&Ct?j|bo:j&nr?j|Os:nr:32}}),V(Ps,Ut,{defaults:{event:"pan",threshold:10,pointers:1,direction:he},getTouchAction:function(){var F=this.options.direction,j=[];return F&we&&j.push(sa),F&Te&&j.push(ns),j},directionTest:function(F){var j=this.options,ie=!0,ye=F.distance,Oe=F.direction,$e=F.deltaX,jt=F.deltaY;return Oe&j.direction||(j.direction&we?(Oe=0===$e?_e:$e<0?X:G,ie=$e!=this.pX,ye=Math.abs(F.deltaX)):(Oe=0===jt?_e:jt<0?U:se,ie=jt!=this.pY,ye=Math.abs(F.deltaY))),F.direction=Oe,ie&&ye>j.threshold&&Oe&j.direction},attrTest:function(F){return Ut.prototype.attrTest.call(this,F)&&(this.state&nr||!(this.state&nr)&&this.directionTest(F))},emit:function(F){this.pX=F.deltaX,this.pY=F.deltaY;var j=Sd(F.direction);j&&(F.additionalEvent=this.options.event+j),this._super.emit.call(this,F)}}),V(an,Ut,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ts]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.scale-1)>this.options.threshold||this.state&nr)},emit:function(F){1!==F.scale&&(F.additionalEvent=this.options.event+(F.scale<1?"in":"out")),this._super.emit.call(this,F)}}),V(la,Pr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(F){var j=this.options,ie=F.pointers.length===j.pointers,ye=F.distance<j.threshold,Oe=F.deltaTime>j.time;if(this._input=F,!ye||!ie||F.eventType&(Ct|y)&&!Oe)this.reset();else if(F.eventType&nt)this.reset(),this._timer=v(function(){this.state=Or,this.tryEmit()},j.time,this);else if(F.eventType&Ct)return Or;return 32},reset:function(){clearTimeout(this._timer)},emit:function(F){this.state===Or&&(F&&F.eventType&Ct?this.manager.emit(this.options.event+"up",F):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}}),V(Oc,Ut,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ts]},attrTest:function(F){return this._super.attrTest.call(this,F)&&(Math.abs(F.rotation)>this.options.threshold||this.state&nr)}}),V(ln,Ut,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:we|Te,pointers:1},getTouchAction:function(){return Ps.prototype.getTouchAction.call(this)},attrTest:function(F){var ie,j=this.options.direction;return j&(we|Te)?ie=F.overallVelocity:j&we?ie=F.overallVelocityX:j&Te&&(ie=F.overallVelocityY),this._super.attrTest.call(this,F)&&j&F.offsetDirection&&F.distance>this.options.threshold&&F.maxPointers==this.options.pointers&&d(ie)>this.options.velocity&&F.eventType&Ct},emit:function(F){var j=Sd(F.offsetDirection);j&&this.manager.emit(this.options.event+j,F),this.manager.emit(this.options.event,F)}}),V(ut,Pr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kc]},process:function(F){var j=this.options,ie=F.pointers.length===j.pointers,ye=F.distance<j.threshold,Oe=F.deltaTime<j.time;if(this.reset(),F.eventType&nt&&0===this.count)return this.failTimeout();if(ye&&Oe&&ie){if(F.eventType!=Ct)return this.failTimeout();var $e=!this.pTime||F.timeStamp-this.pTime<j.interval,jt=!this.pCenter||yo(this.pCenter,F.center)<j.posThreshold;if(this.pTime=F.timeStamp,this.pCenter=F.center,jt&&$e?this.count+=1:this.count=1,this._input=F,0==this.count%j.taps)return this.hasRequireFailures()?(this._timer=v(function(){this.state=Or,this.tryEmit()},j.interval,this),nr):Or}return 32},failTimeout:function(){return this._timer=v(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Or&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),no.VERSION="2.0.7",no.defaults={domEvents:!1,touchAction:Mc,enable:!0,inputTarget:null,inputClass:null,preset:[[Oc,{enable:!1}],[an,{enable:!1},["rotate"]],[ln,{direction:we}],[Ps,{direction:we},["swipe"]],[ut],[ut,{event:"doubletap",taps:2},["tap"]],[la]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Fs.prototype={set:function(F){return W(this.options,F),F.touchAction&&this.touchAction.update(),F.inputTarget&&(this.input.destroy(),this.input.target=F.inputTarget,this.input.init()),this},stop:function(F){this.session.stopped=F?2:1},recognize:function(F){var j=this.session;if(!j.stopped){this.touchAction.preventDefaults(F);var ie,ye=this.recognizers,Oe=j.curRecognizer;(!Oe||Oe&&Oe.state&Or)&&(Oe=j.curRecognizer=null);for(var $e=0;$e<ye.length;)ie=ye[$e],2===j.stopped||Oe&&ie!=Oe&&!ie.canRecognizeWith(Oe)?ie.reset():ie.recognize(F),!Oe&&ie.state&(nr|Os|bo)&&(Oe=j.curRecognizer=ie),$e++}},get:function(F){if(F instanceof Pr)return F;for(var j=this.recognizers,ie=0;ie<j.length;ie++)if(j[ie].options.event==F)return j[ie];return null},add:function(F){if(k(F,"add",this))return this;var j=this.get(F.options.event);return j&&this.remove(j),this.recognizers.push(F),F.manager=this,this.touchAction.update(),F},remove:function(F){if(k(F,"remove",this))return this;if(F=this.get(F)){var j=this.recognizers,ie=ge(j,F);-1!==ie&&(j.splice(ie,1),this.touchAction.update())}return this},on:function(F,j){if(F!==p&&j!==p){var ie=this.handlers;return w(C(F),function(ye){ie[ye]=ie[ye]||[],ie[ye].push(j)}),this}},off:function(F,j){if(F!==p){var ie=this.handlers;return w(C(F),function(ye){j?ie[ye]&&ie[ye].splice(ge(ie[ye],j),1):delete ie[ye]}),this}},emit:function(F,j){this.options.domEvents&&function il(F,j){var ie=D.createEvent("Event");ie.initEvent(F,!0,!0),ie.gesture=j,j.target.dispatchEvent(ie)}(F,j);var ie=this.handlers[F]&&this.handlers[F].slice();if(ie&&ie.length){j.type=F,j.preventDefault=function(){j.srcEvent.preventDefault()};for(var ye=0;ye<ie.length;)ie[ye](j),ye++}},destroy:function(){this.element&&De(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},W(no,{INPUT_START:nt,INPUT_MOVE:Kt,INPUT_END:Ct,INPUT_CANCEL:y,STATE_POSSIBLE:nl,STATE_BEGAN:nr,STATE_CHANGED:Os,STATE_ENDED:bo,STATE_RECOGNIZED:Or,STATE_CANCELLED:aa,STATE_FAILED:32,DIRECTION_NONE:_e,DIRECTION_LEFT:X,DIRECTION_RIGHT:G,DIRECTION_UP:U,DIRECTION_DOWN:se,DIRECTION_HORIZONTAL:we,DIRECTION_VERTICAL:Te,DIRECTION_ALL:he,Manager:Fs,Input:Pe,TouchAction:Ic,TouchInput:el,MouseInput:Jr,PointerEventInput:Ja,TouchMouseInput:Dc,SingleTouchInput:Tc,Recognizer:Pr,AttrRecognizer:Ut,Tap:ut,Pan:Ps,Swipe:ln,Pinch:an,Rotate:Oc,Press:la,on:K,off:Ce,each:w,merge:B,extend:ne,assign:W,inherit:V,bindFn:z,prefixed:Ae}),(typeof A<"u"?A:typeof self<"u"?self:{}).Hammer=no,(O=function(){return no}.call(N,Y,N,Ye))!==p&&(Ye.exports=O)}(window,document)},8461:(Ye,N)=>{N.read=function(Y,O,A,D,f){var p,b,x=8*f-D-1,M=(1<<x)-1,m=M>>1,d=-7,_=A?f-1:0,v=A?-1:1,k=Y[O+_];for(_+=v,p=k&(1<<-d)-1,k>>=-d,d+=x;d>0;p=256*p+Y[O+_],_+=v,d-=8);for(b=p&(1<<-d)-1,p>>=-d,d+=D;d>0;b=256*b+Y[O+_],_+=v,d-=8);if(0===p)p=1-m;else{if(p===M)return b?NaN:1/0*(k?-1:1);b+=Math.pow(2,D),p-=m}return(k?-1:1)*b*Math.pow(2,p-D)},N.write=function(Y,O,A,D,f,p){var b,x,M,m=8*p-f-1,d=(1<<m)-1,_=d>>1,v=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,k=D?0:p-1,w=D?1:-1,R=O<0||0===O&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(x=isNaN(O)?1:0,b=d):(b=Math.floor(Math.log(O)/Math.LN2),O*(M=Math.pow(2,-b))<1&&(b--,M*=2),(O+=b+_>=1?v/M:v*Math.pow(2,1-_))*M>=2&&(b++,M/=2),b+_>=d?(x=0,b=d):b+_>=1?(x=(O*M-1)*Math.pow(2,f),b+=_):(x=O*Math.pow(2,_-1)*Math.pow(2,f),b=0));f>=8;Y[A+k]=255&x,k+=w,x/=256,f-=8);for(b=b<<f|x,m+=f;m>0;Y[A+k]=255&b,k+=w,b/=256,m-=8);Y[A+k-w]|=128*R}},6256:function(Ye,N){!function(f){var k,p="undefined",b=p!==typeof Buffer&&Buffer,x=p!==typeof Uint8Array&&Uint8Array,M=p!==typeof ArrayBuffer&&ArrayBuffer,m=[0,0,0,0,0,0,0,0],d=Array.isArray||function $(ae){return!!ae&&"[object Array]"==Object.prototype.toString.call(ae)},_=4294967296,v=16777216;function w(ae,C,ge){var ze=C?0:4,le=C?4:0,Ae=C?0:3,ve=C?1:2,xe=C?2:1,fe=C?3:0,me=C?te:K,Je=C?ee:Ce,Ge=Ve.prototype,Ue="is"+ae,qt="_"+Ue;return Ge.buffer=void 0,Ge.offset=0,Ge[qt]=!0,Ge.toNumber=nt,Ge.toString=function Kt(_e){var X=this.buffer,G=this.offset,U=y(X,G+ze),se=y(X,G+le),we="",Te=!ge&&2147483648&U;for(Te&&(U=~U,se=_-se),_e=_e||10;;){var he=U%_e*_+se;if(U=Math.floor(U/_e),se=Math.floor(he/_e),we=(he%_e).toString(_e)+we,!U&&!se)break}return Te&&(we="-"+we),we},Ge.toJSON=nt,Ge.toArray=R,b&&(Ge.toBuffer=W),x&&(Ge.toArrayBuffer=ne),Ve[Ue]=function Ie(_e){return!(!_e||!_e[qt])},f[ae]=Ve,Ve;function Ve(_e,X,G,U){return this instanceof Ve?function Fe(_e,X,G,U,se){x&&M&&(X instanceof M&&(X=new x(X)),U instanceof M&&(U=new x(U))),X||G||U||k?(B(X,G)||(se=G,U=X,G=0,X=new(k||Array)(8)),_e.buffer=X,_e.offset=G|=0,p!==typeof U&&("string"==typeof U?function pt(_e,X,G,U){var se=0,we=G.length,Te=0,he=0;"-"===G[0]&&se++;for(var Ne=se;se<we;){var Ze=parseInt(G[se++],U);if(!(Ze>=0))break;he=he*U+Ze,Te=Te*U+Math.floor(he/_),he%=_}Ne&&(Te=~Te,he?he=_-he:Te++),Ct(_e,X+ze,Te),Ct(_e,X+le,he)}(X,G,U,se||10):B(U,se)?V(X,G,U,se):"number"==typeof se?(Ct(X,G+ze,U),Ct(X,G+le,se)):U>0?me(X,G,U):U<0?Je(X,G,U):V(X,G,m,0))):_e.buffer=z(m,0)}(this,_e,X,G,U):new Ve(_e,X,G,U)}function nt(){var _e=this.buffer,X=this.offset,G=y(_e,X+ze),U=y(_e,X+le);return ge||(G|=0),G?G*_+U:U}function Ct(_e,X,G){_e[X+fe]=255&G,_e[X+xe]=255&(G>>=8),_e[X+ve]=255&(G>>=8),_e[X+Ae]=255&(G>>=8)}function y(_e,X){return _e[X+Ae]*v+(_e[X+ve]<<16)+(_e[X+xe]<<8)+_e[X+fe]}}function R(ae){var C=this.buffer,ge=this.offset;return k=null,!1!==ae&&0===ge&&8===C.length&&d(C)?C:z(C,ge)}function W(ae){var C=this.buffer,ge=this.offset;if(k=b,!1!==ae&&0===ge&&8===C.length&&Buffer.isBuffer(C))return C;var ze=new b(8);return V(ze,0,C,ge),ze}function ne(ae){var C=this.buffer,ge=this.offset,ze=C.buffer;if(k=x,!1!==ae&&0===ge&&ze instanceof M&&8===ze.byteLength)return ze;var le=new x(8);return V(le,0,C,ge),le.buffer}function B(ae,C){var ge=ae&&ae.length;return C|=0,ge&&C+8<=ge&&"string"!=typeof ae[C]}function V(ae,C,ge,ze){C|=0,ze|=0;for(var le=0;le<8;le++)ae[C++]=255&ge[ze++]}function z(ae,C){return Array.prototype.slice.call(ae,C,C+8)}function te(ae,C,ge){for(var ze=C+8;ze>C;)ae[--ze]=255&ge,ge/=256}function ee(ae,C,ge){var ze=C+8;for(ge++;ze>C;)ae[--ze]=255&-ge^255,ge/=256}function K(ae,C,ge){for(var ze=C+8;C<ze;)ae[C++]=255&ge,ge/=256}function Ce(ae,C,ge){var ze=C+8;for(ge++;C<ze;)ae[C++]=255&-ge^255,ge/=256}w("Uint64BE",!0,!0),w("Int64BE",!0,!1),w("Uint64LE",!1,!0),w("Int64LE",!1,!1)}("string"!=typeof N.nodeName?N:this||{})},6425:Ye=>{var N={}.toString;Ye.exports=Array.isArray||function(Y){return"[object Array]"==N.call(Y)}},5650:Ye=>{Ye.exports=function N(Y,O,A){function D(b,x){if(!O[b]){if(!Y[b]){if(f)return f(b,!0);var m=new Error("Cannot find module '"+b+"'");throw m.code="MODULE_NOT_FOUND",m}var d=O[b]={exports:{}};Y[b][0].call(d.exports,function(_){return D(Y[b][1][_]||_)},d,d.exports,N,Y,O,A)}return O[b].exports}for(var f=void 0,p=0;p<A.length;p++)D(A[p]);return D}({1:[function(N,Y,O){"use strict";var A=N("./utils"),D=N("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";O.encode=function(p){for(var b,x,M,d,_,v,k=[],w=0,R=p.length,W=R,ne="string"!==A.getTypeOf(p);w<p.length;)W=R-w,M=ne?(b=p[w++],x=w<R?p[w++]:0,w<R?p[w++]:0):(b=p.charCodeAt(w++),x=w<R?p.charCodeAt(w++):0,w<R?p.charCodeAt(w++):0),d=(3&b)<<4|x>>4,_=1<W?(15&x)<<2|M>>6:64,v=2<W?63&M:64,k.push(f.charAt(b>>2)+f.charAt(d)+f.charAt(_)+f.charAt(v));return k.join("")},O.decode=function(p){var b,x,M,m,d,_,v=0,k=0,w="data:";if(p.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var R,W=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===f.charAt(64)&&W--,p.charAt(p.length-2)===f.charAt(64)&&W--,W%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=D.uint8array?new Uint8Array(0|W):new Array(0|W);v<p.length;)b=f.indexOf(p.charAt(v++))<<2|(m=f.indexOf(p.charAt(v++)))>>4,x=(15&m)<<4|(d=f.indexOf(p.charAt(v++)))>>2,M=(3&d)<<6|(_=f.indexOf(p.charAt(v++))),R[k++]=b,64!==d&&(R[k++]=x),64!==_&&(R[k++]=M);return R}},{"./support":30,"./utils":32}],2:[function(N,Y,O){"use strict";var A=N("./external"),D=N("./stream/DataWorker"),f=N("./stream/Crc32Probe"),p=N("./stream/DataLengthProbe");function b(x,M,m,d,_){this.compressedSize=x,this.uncompressedSize=M,this.crc32=m,this.compression=d,this.compressedContent=_}b.prototype={getContentWorker:function(){var x=new D(A.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),M=this;return x.on("end",function(){if(this.streamInfo.data_length!==M.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),x},getCompressedWorker:function(){return new D(A.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(x,M,m){return x.pipe(new f).pipe(new p("uncompressedSize")).pipe(M.compressWorker(m)).pipe(new p("compressedSize")).withStreamInfo("compression",M)},Y.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(N,Y,O){"use strict";var A=N("./stream/GenericWorker");O.STORE={magic:"\0\0",compressWorker:function(){return new A("STORE compression")},uncompressWorker:function(){return new A("STORE decompression")}},O.DEFLATE=N("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(N,Y,O){"use strict";var A=N("./utils"),D=function(){for(var f,p=[],b=0;b<256;b++){f=b;for(var x=0;x<8;x++)f=1&f?3988292384^f>>>1:f>>>1;p[b]=f}return p}();Y.exports=function(f,p){return void 0!==f&&f.length?"string"!==A.getTypeOf(f)?function(b,x,M,m){var d=D,_=0+M;b^=-1;for(var v=0;v<_;v++)b=b>>>8^d[255&(b^x[v])];return-1^b}(0|p,f,f.length):function(b,x,M,m){var d=D,_=0+M;b^=-1;for(var v=0;v<_;v++)b=b>>>8^d[255&(b^x.charCodeAt(v))];return-1^b}(0|p,f,f.length):0}},{"./utils":32}],5:[function(N,Y,O){"use strict";O.base64=!1,O.binary=!1,O.dir=!1,O.createFolders=!0,O.date=null,O.compression=null,O.compressionOptions=null,O.comment=null,O.unixPermissions=null,O.dosPermissions=null},{}],6:[function(N,Y,O){"use strict";var A;A=typeof Promise<"u"?Promise:N("lie"),Y.exports={Promise:A}},{lie:37}],7:[function(N,Y,O){"use strict";var A=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",D=N("pako"),f=N("./utils"),p=N("./stream/GenericWorker"),b=A?"uint8array":"array";function x(M,m){p.call(this,"FlateWorker/"+M),this._pako=null,this._pakoAction=M,this._pakoOptions=m,this.meta={}}O.magic="\b\0",f.inherits(x,p),x.prototype.processChunk=function(M){this.meta=M.meta,null===this._pako&&this._createPako(),this._pako.push(f.transformTo(b,M.data),!1)},x.prototype.flush=function(){p.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},x.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},x.prototype._createPako=function(){this._pako=new D[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var M=this;this._pako.onData=function(m){M.push({data:m,meta:M.meta})}},O.compressWorker=function(M){return new x("Deflate",M)},O.uncompressWorker=function(){return new x("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(N,Y,O){"use strict";function A(d,_){var v,k="";for(v=0;v<_;v++)k+=String.fromCharCode(255&d),d>>>=8;return k}function D(d,_,v,k,w,R){var W,ne,B=d.file,V=d.compression,z=R!==b.utf8encode,te=f.transformTo("string",R(B.name)),ee=f.transformTo("string",b.utf8encode(B.name)),K=B.comment,Ce=f.transformTo("string",R(K)),$=f.transformTo("string",b.utf8encode(K)),ae=ee.length!==B.name.length,C=$.length!==K.length,ge="",ze="",le="",Ae=B.dir,ve=B.date,xe={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(xe.crc32=d.crc32,xe.compressedSize=d.compressedSize,xe.uncompressedSize=d.uncompressedSize);var fe=0;_&&(fe|=8),z||!ae&&!C||(fe|=2048);var Ue,Ve,me=0,Je=0;Ae&&(me|=16),"UNIX"===w?(Je=798,me|=(Ve=Ue=B.unixPermissions,Ue||(Ve=Ae?16893:33204),(65535&Ve)<<16)):(Je=20,me|=function(Ue){return 63&(Ue||0)}(B.dosPermissions)),W=ve.getUTCHours(),W<<=6,W|=ve.getUTCMinutes(),W<<=5,W|=ve.getUTCSeconds()/2,ne=ve.getUTCFullYear()-1980,ne<<=4,ne|=ve.getUTCMonth()+1,ne<<=5,ne|=ve.getUTCDate(),ae&&(ze=A(1,1)+A(x(te),4)+ee,ge+="up"+A(ze.length,2)+ze),C&&(le=A(1,1)+A(x(Ce),4)+$,ge+="uc"+A(le.length,2)+le);var Ge="";return Ge+="\n\0",Ge+=A(fe,2),Ge+=V.magic,Ge+=A(W,2),Ge+=A(ne,2),Ge+=A(xe.crc32,4),Ge+=A(xe.compressedSize,4),Ge+=A(xe.uncompressedSize,4),Ge+=A(te.length,2),Ge+=A(ge.length,2),{fileRecord:M.LOCAL_FILE_HEADER+Ge+te+ge,dirRecord:M.CENTRAL_FILE_HEADER+A(Je,2)+Ge+A(Ce.length,2)+"\0\0\0\0"+A(me,4)+A(k,4)+te+ge+Ce}}var f=N("../utils"),p=N("../stream/GenericWorker"),b=N("../utf8"),x=N("../crc32"),M=N("../signature");function m(d,_,v,k){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=k,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}f.inherits(m,p),m.prototype.push=function(d){var _=d.meta.percent||0,v=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,p.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-k-1))/v:100}}))},m.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var _=this.streamFiles&&!d.file.dir;if(_){var v=D(d,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(d){this.accumulate=!1;var k,_=this.streamFiles&&!d.file.dir,v=D(d,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:(k=d,M.DATA_DESCRIPTOR+A(k.crc32,4)+A(k.compressedSize,4)+A(k.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var d=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var w,R,W,V,k=(w=this.dirRecords.length,R=this.bytesWritten-d,W=d,V=f.transformTo("string",(0,this.encodeFileName)(this.zipComment)),M.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(w,2)+A(w,2)+A(R,4)+A(W,4)+A(V.length,2)+V);this.push({data:k,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(d){this._sources.push(d);var _=this;return d.on("data",function(v){_.processChunk(v)}),d.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),d.on("error",function(v){_.error(v)}),this},m.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(d){var _=this._sources;if(!p.prototype.error.call(this,d))return!1;for(var v=0;v<_.length;v++)try{_[v].error(d)}catch{}return!0},m.prototype.lock=function(){p.prototype.lock.call(this);for(var d=this._sources,_=0;_<d.length;_++)d[_].lock()},Y.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(N,Y,O){"use strict";var A=N("../compressions"),D=N("./ZipFileWorker");O.generateWorker=function(f,p,b){var x=new D(p.streamFiles,b,p.platform,p.encodeFileName),M=0;try{f.forEach(function(m,d){M++;var _=function(R,W){var ne=R||W,B=A[ne];if(!B)throw new Error(ne+" is not a valid compression method !");return B}(d.options.compression,p.compression),k=d.dir,w=d.date;d._compressWorker(_,d.options.compressionOptions||p.compressionOptions||{}).withStreamInfo("file",{name:m,dir:k,date:w,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(x)}),x.entriesCount=M}catch(m){x.error(m)}return x}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(N,Y,O){"use strict";function A(){if(!(this instanceof A))return new A;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var D=new A;for(var f in this)"function"!=typeof this[f]&&(D[f]=this[f]);return D}}(A.prototype=N("./object")).loadAsync=N("./load"),A.support=N("./support"),A.defaults=N("./defaults"),A.version="3.10.1",A.loadAsync=function(D,f){return(new A).loadAsync(D,f)},A.external=N("./external"),Y.exports=A},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(N,Y,O){"use strict";var A=N("./utils"),D=N("./external"),f=N("./utf8"),p=N("./zipEntries"),b=N("./stream/Crc32Probe"),x=N("./nodejsUtils");function M(m){return new D.Promise(function(d,_){var v=m.decompressed.getContentWorker().pipe(new b);v.on("error",function(k){_(k)}).on("end",function(){v.streamInfo.crc32!==m.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}Y.exports=function(m,d){var _=this;return d=A.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),x.isNode&&x.isStream(m)?D.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):A.prepareContent("the loaded zip file",m,!0,d.optimizedBinaryString,d.base64).then(function(v){var k=new p(d);return k.load(v),k}).then(function(v){var k=[D.Promise.resolve(v)],w=v.files;if(d.checkCRC32)for(var R=0;R<w.length;R++)k.push(M(w[R]));return D.Promise.all(k)}).then(function(v){for(var k=v.shift(),w=k.files,R=0;R<w.length;R++){var W=w[R],ne=W.fileNameStr,B=A.resolve(W.fileNameStr);_.file(B,W.decompressed,{binary:!0,optimizedBinaryString:!0,date:W.date,dir:W.dir,comment:W.fileCommentStr.length?W.fileCommentStr:null,unixPermissions:W.unixPermissions,dosPermissions:W.dosPermissions,createFolders:d.createFolders}),W.dir||(_.file(B).unsafeOriginalName=ne)}return k.zipComment.length&&(_.comment=k.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(N,Y,O){"use strict";var A=N("../utils"),D=N("../stream/GenericWorker");function f(p,b){D.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(b)}A.inherits(f,D),f.prototype._bindStream=function(p){var b=this;(this._stream=p).pause(),p.on("data",function(x){b.push({data:x,meta:{percent:0}})}).on("error",function(x){b.isPaused?this.generatedError=x:b.error(x)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},f.prototype.pause=function(){return!!D.prototype.pause.call(this)&&(this._stream.pause(),!0)},f.prototype.resume=function(){return!!D.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Y.exports=f},{"../stream/GenericWorker":28,"../utils":32}],13:[function(N,Y,O){"use strict";var A=N("readable-stream").Readable;function D(f,p,b){A.call(this,p),this._helper=f;var x=this;f.on("data",function(M,m){x.push(M)||x._helper.pause(),b&&b(m)}).on("error",function(M){x.emit("error",M)}).on("end",function(){x.push(null)})}N("../utils").inherits(D,A),D.prototype._read=function(){this._helper.resume()},Y.exports=D},{"../utils":32,"readable-stream":16}],14:[function(N,Y,O){"use strict";Y.exports={isNode:typeof Buffer<"u",newBufferFrom:function(A,D){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(A,D);if("number"==typeof A)throw new Error('The "data" argument must not be a number');return new Buffer(A,D)},allocBuffer:function(A){if(Buffer.alloc)return Buffer.alloc(A);var D=new Buffer(A);return D.fill(0),D},isBuffer:function(A){return Buffer.isBuffer(A)},isStream:function(A){return A&&"function"==typeof A.on&&"function"==typeof A.pause&&"function"==typeof A.resume}}},{}],15:[function(N,Y,O){"use strict";function A(B,V,z){var te,ee=f.getTypeOf(V),K=f.extend(z||{},x);K.date=K.date||new Date,null!==K.compression&&(K.compression=K.compression.toUpperCase()),"string"==typeof K.unixPermissions&&(K.unixPermissions=parseInt(K.unixPermissions,8)),K.unixPermissions&&16384&K.unixPermissions&&(K.dir=!0),K.dosPermissions&&16&K.dosPermissions&&(K.dir=!0),K.dir&&(B=w(B)),K.createFolders&&(te=k(B))&&R.call(this,te,!0),z&&void 0!==z.binary||(K.binary=!("string"===ee&&!1===K.binary&&!1===K.base64)),(V instanceof M&&0===V.uncompressedSize||K.dir||!V||0===V.length)&&(K.base64=!1,K.binary=!0,V="",K.compression="STORE",ee="string");var $;$=V instanceof M||V instanceof p?V:_.isNode&&_.isStream(V)?new v(B,V):f.prepareContent(B,V,K.binary,K.optimizedBinaryString,K.base64);var ae=new m(B,$,K);this.files[B]=ae}var D=N("./utf8"),f=N("./utils"),p=N("./stream/GenericWorker"),b=N("./stream/StreamHelper"),x=N("./defaults"),M=N("./compressedObject"),m=N("./zipObject"),d=N("./generate"),_=N("./nodejsUtils"),v=N("./nodejs/NodejsStreamInputAdapter"),k=function(B){"/"===B.slice(-1)&&(B=B.substring(0,B.length-1));var V=B.lastIndexOf("/");return 0<V?B.substring(0,V):""},w=function(B){return"/"!==B.slice(-1)&&(B+="/"),B},R=function(B,V){return V=void 0!==V?V:x.createFolders,B=w(B),this.files[B]||A.call(this,B,null,{dir:!0,createFolders:V}),this.files[B]};function W(B){return"[object RegExp]"===Object.prototype.toString.call(B)}var ne={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(B){var V,z,te;for(V in this.files)te=this.files[V],(z=V.slice(this.root.length,V.length))&&V.slice(0,this.root.length)===this.root&&B(z,te)},filter:function(B){var V=[];return this.forEach(function(z,te){B(z,te)&&V.push(te)}),V},file:function(B,V,z){if(1!==arguments.length)return A.call(this,B=this.root+B,V,z),this;if(W(B)){var te=B;return this.filter(function(K,Ce){return!Ce.dir&&te.test(K)})}var ee=this.files[this.root+B];return ee&&!ee.dir?ee:null},folder:function(B){if(!B)return this;if(W(B))return this.filter(function(ee,K){return K.dir&&B.test(ee)});var z=R.call(this,this.root+B),te=this.clone();return te.root=z.name,te},remove:function(B){var V=this.files[B=this.root+B];if(V||("/"!==B.slice(-1)&&(B+="/"),V=this.files[B]),V&&!V.dir)delete this.files[B];else for(var z=this.filter(function(ee,K){return K.name.slice(0,B.length)===B}),te=0;te<z.length;te++)delete this.files[z[te].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(B){var V,z={};try{if((z=f.extend(B||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:D.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),"binarystring"===z.type&&(z.type="string"),!z.type)throw new Error("No output type specified.");f.checkSupport(z.type),"darwin"!==z.platform&&"freebsd"!==z.platform&&"linux"!==z.platform&&"sunos"!==z.platform||(z.platform="UNIX"),"win32"===z.platform&&(z.platform="DOS"),V=d.generateWorker(this,z,z.comment||this.comment||"")}catch(ee){(V=new p("error")).error(ee)}return new b(V,z.type||"string",z.mimeType)},generateAsync:function(B,V){return this.generateInternalStream(B).accumulate(V)},generateNodeStream:function(B,V){return(B=B||{}).type||(B.type="nodebuffer"),this.generateInternalStream(B).toNodejsStream(V)}};Y.exports=ne},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(N,Y,O){"use strict";Y.exports=N("stream")},{stream:void 0}],17:[function(N,Y,O){"use strict";var A=N("./DataReader");function D(f){A.call(this,f);for(var p=0;p<this.data.length;p++)f[p]=255&f[p]}N("../utils").inherits(D,A),D.prototype.byteAt=function(f){return this.data[this.zero+f]},D.prototype.lastIndexOfSignature=function(f){for(var p=f.charCodeAt(0),b=f.charCodeAt(1),x=f.charCodeAt(2),M=f.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===p&&this.data[m+1]===b&&this.data[m+2]===x&&this.data[m+3]===M)return m-this.zero;return-1},D.prototype.readAndCheckSignature=function(f){var p=f.charCodeAt(0),b=f.charCodeAt(1),x=f.charCodeAt(2),M=f.charCodeAt(3),m=this.readData(4);return p===m[0]&&b===m[1]&&x===m[2]&&M===m[3]},D.prototype.readData=function(f){if(this.checkOffset(f),0===f)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=D},{"../utils":32,"./DataReader":18}],18:[function(N,Y,O){"use strict";var A=N("../utils");function D(f){this.data=f,this.length=f.length,this.index=0,this.zero=0}D.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+f+"). Corrupted zip ?")},setIndex:function(f){this.checkIndex(f),this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var p,b=0;for(this.checkOffset(f),p=this.index+f-1;p>=this.index;p--)b=(b<<8)+this.byteAt(p);return this.index+=f,b},readString:function(f){return A.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}},Y.exports=D},{"../utils":32}],19:[function(N,Y,O){"use strict";var A=N("./Uint8ArrayReader");function D(f){A.call(this,f)}N("../utils").inherits(D,A),D.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=D},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(N,Y,O){"use strict";var A=N("./DataReader");function D(f){A.call(this,f)}N("../utils").inherits(D,A),D.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)},D.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero},D.prototype.readAndCheckSignature=function(f){return f===this.readData(4)},D.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=D},{"../utils":32,"./DataReader":18}],21:[function(N,Y,O){"use strict";var A=N("./ArrayReader");function D(f){A.call(this,f)}N("../utils").inherits(D,A),D.prototype.readData=function(f){if(this.checkOffset(f),0===f)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=D},{"../utils":32,"./ArrayReader":17}],22:[function(N,Y,O){"use strict";var A=N("../utils"),D=N("../support"),f=N("./ArrayReader"),p=N("./StringReader"),b=N("./NodeBufferReader"),x=N("./Uint8ArrayReader");Y.exports=function(M){var m=A.getTypeOf(M);return A.checkSupport(m),"string"!==m||D.uint8array?"nodebuffer"===m?new b(M):D.uint8array?new x(A.transformTo("uint8array",M)):new f(A.transformTo("array",M)):new p(M)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(N,Y,O){"use strict";O.LOCAL_FILE_HEADER="PK\x03\x04",O.CENTRAL_FILE_HEADER="PK\x01\x02",O.CENTRAL_DIRECTORY_END="PK\x05\x06",O.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",O.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",O.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(N,Y,O){"use strict";var A=N("./GenericWorker"),D=N("../utils");function f(p){A.call(this,"ConvertWorker to "+p),this.destType=p}D.inherits(f,A),f.prototype.processChunk=function(p){this.push({data:D.transformTo(this.destType,p.data),meta:p.meta})},Y.exports=f},{"../utils":32,"./GenericWorker":28}],25:[function(N,Y,O){"use strict";var A=N("./GenericWorker"),D=N("../crc32");function f(){A.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}N("../utils").inherits(f,A),f.prototype.processChunk=function(p){this.streamInfo.crc32=D(p.data,this.streamInfo.crc32||0),this.push(p)},Y.exports=f},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(N,Y,O){"use strict";var A=N("../utils"),D=N("./GenericWorker");function f(p){D.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}A.inherits(f,D),f.prototype.processChunk=function(p){p&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+p.data.length),D.prototype.processChunk.call(this,p)},Y.exports=f},{"../utils":32,"./GenericWorker":28}],27:[function(N,Y,O){"use strict";var A=N("../utils"),D=N("./GenericWorker");function f(p){D.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(x){b.dataIsReady=!0,b.data=x,b.max=x&&x.length||0,b.type=A.getTypeOf(x),b.isPaused||b._tickAndRepeat()},function(x){b.error(x)})}A.inherits(f,D),f.prototype.cleanUp=function(){D.prototype.cleanUp.call(this),this.data=null},f.prototype.resume=function(){return!!D.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,A.delay(this._tickAndRepeat,[],this)),!0)},f.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(A.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},f.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,b);break;case"uint8array":p=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":p=this.data.slice(this.index,b)}return this.index=b,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},Y.exports=f},{"../utils":32,"./GenericWorker":28}],28:[function(N,Y,O){"use strict";function A(D){this.name=D||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}A.prototype={push:function(D){this.emit("data",D)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(D){this.emit("error",D)}return!0},error:function(D){return!this.isFinished&&(this.isPaused?this.generatedError=D:(this.isFinished=!0,this.emit("error",D),this.previous&&this.previous.error(D),this.cleanUp()),!0)},on:function(D,f){return this._listeners[D].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(D,f){if(this._listeners[D])for(var p=0;p<this._listeners[D].length;p++)this._listeners[D][p].call(this,f)},pipe:function(D){return D.registerPrevious(this)},registerPrevious:function(D){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=D.streamInfo,this.mergeStreamInfo(),this.previous=D;var f=this;return D.on("data",function(p){f.processChunk(p)}),D.on("end",function(){f.end()}),D.on("error",function(p){f.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var D=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),D=!0),this.previous&&this.previous.resume(),!D},flush:function(){},processChunk:function(D){this.push(D)},withStreamInfo:function(D,f){return this.extraStreamInfo[D]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var D in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,D)&&(this.streamInfo[D]=this.extraStreamInfo[D])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var D="Worker "+this.name;return this.previous?this.previous+" -> "+D:D}},Y.exports=A},{}],29:[function(N,Y,O){"use strict";var A=N("../utils"),D=N("./ConvertWorker"),f=N("./GenericWorker"),p=N("../base64"),b=N("../support"),x=N("../external"),M=null;if(b.nodestream)try{M=N("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(_,v,k){var w=v;switch(v){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=v,this._mimeType=k,A.checkSupport(w),this._worker=_.pipe(new D(w)),_.lock()}catch(R){this._worker=new f("error"),this._worker.error(R)}}d.prototype={accumulate:function(_){return function m(_,v){return new x.Promise(function(k,w){var R=[],W=_._internalType,ne=_._outputType,B=_._mimeType;_.on("data",function(V,z){R.push(V),v&&v(z)}).on("error",function(V){R=[],w(V)}).on("end",function(){try{var V=function(z,te,ee){switch(z){case"blob":return A.newBlob(A.transformTo("arraybuffer",te),ee);case"base64":return p.encode(te);default:return A.transformTo(z,te)}}(ne,function(z,te){var ee,K=0,Ce=null,$=0;for(ee=0;ee<te.length;ee++)$+=te[ee].length;switch(z){case"string":return te.join("");case"array":return Array.prototype.concat.apply([],te);case"uint8array":for(Ce=new Uint8Array($),ee=0;ee<te.length;ee++)Ce.set(te[ee],K),K+=te[ee].length;return Ce;case"nodebuffer":return Buffer.concat(te);default:throw new Error("concat : unsupported type '"+z+"'")}}(W,R),B);k(V)}catch(z){w(z)}R=[]}).resume()})}(this,_)},on:function(_,v){var k=this;return this._worker.on(_,"data"===_?function(w){v.call(k,w.data,w.meta)}:function(){A.delay(v,arguments,k)}),this},resume:function(){return A.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(A.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new M(this,{objectMode:"nodebuffer"!==this._outputType},_)}},Y.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(N,Y,O){"use strict";if(O.base64=!0,O.array=!0,O.string=!0,O.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",O.nodebuffer=typeof Buffer<"u",O.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")O.blob=!1;else{var A=new ArrayBuffer(0);try{O.blob=0===new Blob([A],{type:"application/zip"}).size}catch{try{var D=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);D.append(A),O.blob=0===D.getBlob("application/zip").size}catch{O.blob=!1}}}try{O.nodestream=!!N("readable-stream").Readable}catch{O.nodestream=!1}},{"readable-stream":16}],31:[function(N,Y,O){"use strict";for(var A=N("./utils"),D=N("./support"),f=N("./nodejsUtils"),p=N("./stream/GenericWorker"),b=new Array(256),x=0;x<256;x++)b[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function M(){p.call(this,"utf-8 decode"),this.leftOver=null}function m(){p.call(this,"utf-8 encode")}b[254]=b[254]=1,O.utf8encode=function(d){return D.nodebuffer?f.newBufferFrom(d,"utf-8"):function(_){var v,k,w,R,W,ne=_.length,B=0;for(R=0;R<ne;R++)55296==(64512&(k=_.charCodeAt(R)))&&R+1<ne&&56320==(64512&(w=_.charCodeAt(R+1)))&&(k=65536+(k-55296<<10)+(w-56320),R++),B+=k<128?1:k<2048?2:k<65536?3:4;for(v=D.uint8array?new Uint8Array(B):new Array(B),R=W=0;W<B;R++)55296==(64512&(k=_.charCodeAt(R)))&&R+1<ne&&56320==(64512&(w=_.charCodeAt(R+1)))&&(k=65536+(k-55296<<10)+(w-56320),R++),k<128?v[W++]=k:(k<2048?v[W++]=192|k>>>6:(k<65536?v[W++]=224|k>>>12:(v[W++]=240|k>>>18,v[W++]=128|k>>>12&63),v[W++]=128|k>>>6&63),v[W++]=128|63&k);return v}(d)},O.utf8decode=function(d){return D.nodebuffer?A.transformTo("nodebuffer",d).toString("utf-8"):function(_){var v,k,w,R,W=_.length,ne=new Array(2*W);for(v=k=0;v<W;)if((w=_[v++])<128)ne[k++]=w;else if(4<(R=b[w]))ne[k++]=65533,v+=R-1;else{for(w&=2===R?31:3===R?15:7;1<R&&v<W;)w=w<<6|63&_[v++],R--;1<R?ne[k++]=65533:w<65536?ne[k++]=w:(ne[k++]=55296|(w-=65536)>>10&1023,ne[k++]=56320|1023&w)}return ne.length!==k&&(ne.subarray?ne=ne.subarray(0,k):ne.length=k),A.applyFromCharCode(ne)}(d=A.transformTo(D.uint8array?"uint8array":"array",d))},A.inherits(M,p),M.prototype.processChunk=function(d){var _=A.transformTo(D.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(D.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var k=function(R,W){var ne;for((W=W||R.length)>R.length&&(W=R.length),ne=W-1;0<=ne&&128==(192&R[ne]);)ne--;return ne<0||0===ne?W:ne+b[R[ne]]>W?ne:W}(_),w=_;k!==_.length&&(D.uint8array?(w=_.subarray(0,k),this.leftOver=_.subarray(k,_.length)):(w=_.slice(0,k),this.leftOver=_.slice(k,_.length))),this.push({data:O.utf8decode(w),meta:d.meta})},M.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:O.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},O.Utf8DecodeWorker=M,A.inherits(m,p),m.prototype.processChunk=function(d){this.push({data:O.utf8encode(d.data),meta:d.meta})},O.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(N,Y,O){"use strict";var A=N("./support"),D=N("./base64"),f=N("./nodejsUtils"),p=N("./external");function b(v){return v}function x(v,k){for(var w=0;w<v.length;++w)k[w]=255&v.charCodeAt(w);return k}N("setimmediate"),O.newBlob=function(v,k){O.checkSupport("blob");try{return new Blob([v],{type:k})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(v),w.getBlob(k)}catch{throw new Error("Bug : can't construct the Blob.")}}};var M={stringifyByChunk:function(v,k,w){var R=[],W=0,ne=v.length;if(ne<=w)return String.fromCharCode.apply(null,v);for(;W<ne;)R.push(String.fromCharCode.apply(null,"array"===k||"nodebuffer"===k?v.slice(W,Math.min(W+w,ne)):v.subarray(W,Math.min(W+w,ne)))),W+=w;return R.join("")},stringifyByChar:function(v){for(var k="",w=0;w<v.length;w++)k+=String.fromCharCode(v[w]);return k},applyCanBeUsed:{uint8array:function(){try{return A.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return A.nodebuffer&&1===String.fromCharCode.apply(null,f.allocBuffer(1)).length}catch{return!1}}()}};function m(v){var k=65536,w=O.getTypeOf(v),R=!0;if("uint8array"===w?R=M.applyCanBeUsed.uint8array:"nodebuffer"===w&&(R=M.applyCanBeUsed.nodebuffer),R)for(;1<k;)try{return M.stringifyByChunk(v,w,k)}catch{k=Math.floor(k/2)}return M.stringifyByChar(v)}function d(v,k){for(var w=0;w<v.length;w++)k[w]=v[w];return k}O.applyFromCharCode=m;var _={};_.string={string:b,array:function(v){return x(v,new Array(v.length))},arraybuffer:function(v){return _.string.uint8array(v).buffer},uint8array:function(v){return x(v,new Uint8Array(v.length))},nodebuffer:function(v){return x(v,f.allocBuffer(v.length))}},_.array={string:m,array:b,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(v)}},_.arraybuffer={string:function(v){return m(new Uint8Array(v))},array:function(v){return d(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:b,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(new Uint8Array(v))}},_.uint8array={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:b,nodebuffer:function(v){return f.newBufferFrom(v)}},_.nodebuffer={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return _.nodebuffer.uint8array(v).buffer},uint8array:function(v){return d(v,new Uint8Array(v.length))},nodebuffer:b},O.transformTo=function(v,k){if(k=k||"",!v)return k;O.checkSupport(v);var w=O.getTypeOf(k);return _[w][v](k)},O.resolve=function(v){for(var k=v.split("/"),w=[],R=0;R<k.length;R++){var W=k[R];"."===W||""===W&&0!==R&&R!==k.length-1||(".."===W?w.pop():w.push(W))}return w.join("/")},O.getTypeOf=function(v){return"string"==typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?"array":A.nodebuffer&&f.isBuffer(v)?"nodebuffer":A.uint8array&&v instanceof Uint8Array?"uint8array":A.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},O.checkSupport=function(v){if(!A[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},O.MAX_VALUE_16BITS=65535,O.MAX_VALUE_32BITS=-1,O.pretty=function(v){var k,w,R="";for(w=0;w<(v||"").length;w++)R+="\\x"+((k=v.charCodeAt(w))<16?"0":"")+k.toString(16).toUpperCase();return R},O.delay=function(v,k,w){setImmediate(function(){v.apply(w||null,k||[])})},O.inherits=function(v,k){function w(){}w.prototype=k.prototype,v.prototype=new w},O.extend=function(){var v,k,w={};for(v=0;v<arguments.length;v++)for(k in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],k)&&void 0===w[k]&&(w[k]=arguments[v][k]);return w},O.prepareContent=function(v,k,w,R,W){return p.Promise.resolve(k).then(function(ne){return A.blob&&(ne instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ne)))&&typeof FileReader<"u"?new p.Promise(function(B,V){var z=new FileReader;z.onload=function(te){B(te.target.result)},z.onerror=function(te){V(te.target.error)},z.readAsArrayBuffer(ne)}):ne}).then(function(ne){var V,B=O.getTypeOf(ne);return B?("arraybuffer"===B?ne=O.transformTo("uint8array",ne):"string"===B&&(W?ne=D.decode(ne):w&&!0!==R&&(ne=x(V=ne,A.uint8array?new Uint8Array(V.length):new Array(V.length)))),ne):p.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(N,Y,O){"use strict";var A=N("./reader/readerFor"),D=N("./utils"),f=N("./signature"),p=N("./zipEntry"),b=N("./support");function x(M){this.files=[],this.loadOptions=M}x.prototype={checkSignature:function(M){if(!this.reader.readAndCheckSignature(M)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+D.pretty(m)+", expected "+D.pretty(M)+")")}},isSignature:function(M,m){var d=this.reader.index;this.reader.setIndex(M);var _=this.reader.readString(4)===m;return this.reader.setIndex(d),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var M=this.reader.readData(this.zipCommentLength),d=D.transformTo(b.uint8array?"uint8array":"array",M);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var M,m,d,_=this.zip64EndOfCentralSize-44;0<_;)M=this.reader.readInt(2),m=this.reader.readInt(4),d=this.reader.readData(m),this.zip64ExtensibleData[M]={id:M,length:m,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var M,m;for(M=0;M<this.files.length;M++)this.reader.setIndex((m=this.files[M]).localHeaderOffset),this.checkSignature(f.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var M;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(f.CENTRAL_FILE_HEADER);)(M=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(M);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var M=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(M<0)throw this.isSignature(0,f.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(M);var m=M;if(this.checkSignature(f.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===D.MAX_VALUE_16BITS||this.diskWithCentralDirStart===D.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===D.MAX_VALUE_16BITS||this.centralDirRecords===D.MAX_VALUE_16BITS||this.centralDirSize===D.MAX_VALUE_32BITS||this.centralDirOffset===D.MAX_VALUE_32BITS){if(this.zip64=!0,(M=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(M),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,f.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var _=m-d;if(0<_)this.isSignature(m,f.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(M){this.reader=A(M)},load:function(M){this.prepareReader(M),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Y.exports=x},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(N,Y,O){"use strict";var A=N("./reader/readerFor"),D=N("./utils"),f=N("./compressedObject"),p=N("./crc32"),b=N("./utf8"),x=N("./compressions"),M=N("./support");function m(d,_){this.options=d,this.loadOptions=_}m.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(d){var _,v;if(d.skip(22),this.fileNameLength=d.readInt(2),v=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(v),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(_=function(k){for(var w in x)if(Object.prototype.hasOwnProperty.call(x,w)&&x[w].magic===k)return x[w];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+D.pretty(this.compressionMethod)+" unknown (inner file : "+D.transformTo("string",this.fileName)+")");this.decompressed=new f(this.compressedSize,this.uncompressedSize,this.crc32,_,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var _=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(_),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==d&&(this.dosPermissions=63&this.externalFileAttributes),3==d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=A(this.extraFields[1].value);this.uncompressedSize===D.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===D.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===D.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===D.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var _,v,k,w=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<w;)_=d.readInt(2),v=d.readInt(2),k=d.readData(v),this.extraFields[_]={id:_,length:v,value:k};d.setIndex(w)},handleUTF8:function(){var d=M.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(null!==_)this.fileNameStr=_;else{var v=D.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var k=this.findExtraFieldUnicodeComment();if(null!==k)this.fileCommentStr=k;else{var w=D.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var _=A(d.value);return 1!==_.readInt(1)||p(this.fileName)!==_.readInt(4)?null:b.utf8decode(_.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var _=A(d.value);return 1!==_.readInt(1)||p(this.fileComment)!==_.readInt(4)?null:b.utf8decode(_.readData(d.length-5))}return null}},Y.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(N,Y,O){"use strict";function A(_,v,k){this.name=_,this.dir=k.dir,this.date=k.date,this.comment=k.comment,this.unixPermissions=k.unixPermissions,this.dosPermissions=k.dosPermissions,this._data=v,this._dataBinary=k.binary,this.options={compression:k.compression,compressionOptions:k.compressionOptions}}var D=N("./stream/StreamHelper"),f=N("./stream/DataWorker"),p=N("./utf8"),b=N("./compressedObject"),x=N("./stream/GenericWorker");A.prototype={internalStream:function(_){var v=null,k="string";try{if(!_)throw new Error("No output type specified.");var w="string"===(k=_.toLowerCase())||"text"===k;"binarystring"!==k&&"text"!==k||(k="string"),v=this._decompressWorker();var R=!this._dataBinary;R&&!w&&(v=v.pipe(new p.Utf8EncodeWorker)),!R&&w&&(v=v.pipe(new p.Utf8DecodeWorker))}catch(W){(v=new x("error")).error(W)}return new D(v,k,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof b&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var k=this._decompressWorker();return this._dataBinary||(k=k.pipe(new p.Utf8EncodeWorker)),b.createWorkerFrom(k,_,v)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof x?this._data:new f(this._data)}};for(var M=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<M.length;d++)A.prototype[M[d]]=m;Y.exports=A},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(N,Y,O){(function(A){"use strict";var D,f,p=A.MutationObserver||A.WebKitMutationObserver;if(p){var b=0,x=new p(_),M=A.document.createTextNode("");x.observe(M,{characterData:!0}),D=function(){M.data=b=++b%2}}else if(A.setImmediate||void 0===A.MessageChannel)D="document"in A&&"onreadystatechange"in A.document.createElement("script")?function(){var v=A.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},A.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var m=new A.MessageChannel;m.port1.onmessage=_,D=function(){m.port2.postMessage(0)}}var d=[];function _(){var v,k;f=!0;for(var w=d.length;w;){for(k=d,d=[],v=-1;++v<w;)k[v]();w=d.length}f=!1}Y.exports=function(v){1!==d.push(v)||f||D()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(N,Y,O){"use strict";var A=N("immediate");function D(){}var f={},p=["REJECTED"],b=["FULFILLED"],x=["PENDING"];function M(w){if("function"!=typeof w)throw new TypeError("resolver must be a function");this.state=x,this.queue=[],this.outcome=void 0,w!==D&&v(this,w)}function m(w,R,W){this.promise=w,"function"==typeof R&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),"function"==typeof W&&(this.onRejected=W,this.callRejected=this.otherCallRejected)}function d(w,R,W){A(function(){var ne;try{ne=R(W)}catch(B){return f.reject(w,B)}ne===w?f.reject(w,new TypeError("Cannot resolve promise with itself")):f.resolve(w,ne)})}function _(w){var R=w&&w.then;if(w&&("object"==typeof w||"function"==typeof w)&&"function"==typeof R)return function(){R.apply(w,arguments)}}function v(w,R){var W=!1;function ne(z){W||(W=!0,f.reject(w,z))}function B(z){W||(W=!0,f.resolve(w,z))}var V=k(function(){R(B,ne)});"error"===V.status&&ne(V.value)}function k(w,R){var W={};try{W.value=w(R),W.status="success"}catch(ne){W.status="error",W.value=ne}return W}(Y.exports=M).prototype.finally=function(w){if("function"!=typeof w)return this;var R=this.constructor;return this.then(function(W){return R.resolve(w()).then(function(){return W})},function(W){return R.resolve(w()).then(function(){throw W})})},M.prototype.catch=function(w){return this.then(null,w)},M.prototype.then=function(w,R){if("function"!=typeof w&&this.state===b||"function"!=typeof R&&this.state===p)return this;var W=new this.constructor(D);return this.state!==x?d(W,this.state===b?w:R,this.outcome):this.queue.push(new m(W,w,R)),W},m.prototype.callFulfilled=function(w){f.resolve(this.promise,w)},m.prototype.otherCallFulfilled=function(w){d(this.promise,this.onFulfilled,w)},m.prototype.callRejected=function(w){f.reject(this.promise,w)},m.prototype.otherCallRejected=function(w){d(this.promise,this.onRejected,w)},f.resolve=function(w,R){var W=k(_,R);if("error"===W.status)return f.reject(w,W.value);var ne=W.value;if(ne)v(w,ne);else{w.state=b,w.outcome=R;for(var B=-1,V=w.queue.length;++B<V;)w.queue[B].callFulfilled(R)}return w},f.reject=function(w,R){w.state=p,w.outcome=R;for(var W=-1,ne=w.queue.length;++W<ne;)w.queue[W].callRejected(R);return w},M.resolve=function(w){return w instanceof this?w:f.resolve(new this(D),w)},M.reject=function(w){var R=new this(D);return f.reject(R,w)},M.all=function(w){var R=this;if("[object Array]"!==Object.prototype.toString.call(w))return this.reject(new TypeError("must be an array"));var W=w.length,ne=!1;if(!W)return this.resolve([]);for(var B=new Array(W),V=0,z=-1,te=new this(D);++z<W;)ee(w[z],z);return te;function ee(K,Ce){R.resolve(K).then(function($){B[Ce]=$,++V!==W||ne||(ne=!0,f.resolve(te,B))},function($){ne||(ne=!0,f.reject(te,$))})}},M.race=function(w){if("[object Array]"!==Object.prototype.toString.call(w))return this.reject(new TypeError("must be an array"));var W=w.length,ne=!1;if(!W)return this.resolve([]);for(var B=-1,V=new this(D);++B<W;)this.resolve(w[B]).then(function(te){ne||(ne=!0,f.resolve(V,te))},function(te){ne||(ne=!0,f.reject(V,te))});return V}},{immediate:36}],38:[function(N,Y,O){"use strict";var A={};(0,N("./lib/utils/common").assign)(A,N("./lib/deflate"),N("./lib/inflate"),N("./lib/zlib/constants")),Y.exports=A},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(N,Y,O){"use strict";var A=N("./zlib/deflate"),D=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/messages"),b=N("./zlib/zstream"),x=Object.prototype.toString,M=0,m=-1,d=0,_=8;function v(w){if(!(this instanceof v))return new v(w);this.options=D.assign({level:m,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},w||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var W=A.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(W!==M)throw new Error(p[W]);if(R.header&&A.deflateSetHeader(this.strm,R.header),R.dictionary){var ne;if(ne="string"==typeof R.dictionary?f.string2buf(R.dictionary):"[object ArrayBuffer]"===x.call(R.dictionary)?new Uint8Array(R.dictionary):R.dictionary,(W=A.deflateSetDictionary(this.strm,ne))!==M)throw new Error(p[W]);this._dict_set=!0}}function k(w,R){var W=new v(R);if(W.push(w,!0),W.err)throw W.msg||p[W.err];return W.result}v.prototype.push=function(w,R){var W,ne,B=this.strm,V=this.options.chunkSize;if(this.ended)return!1;ne=R===~~R?R:!0===R?4:0,B.input="string"==typeof w?f.string2buf(w):"[object ArrayBuffer]"===x.call(w)?new Uint8Array(w):w,B.next_in=0,B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new D.Buf8(V),B.next_out=0,B.avail_out=V),1!==(W=A.deflate(B,ne))&&W!==M)return this.onEnd(W),!(this.ended=!0);0!==B.avail_out&&(0!==B.avail_in||4!==ne&&2!==ne)||this.onData("string"===this.options.to?f.buf2binstring(D.shrinkBuf(B.output,B.next_out)):D.shrinkBuf(B.output,B.next_out))}while((0<B.avail_in||0===B.avail_out)&&1!==W);return 4===ne?(W=A.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===M):2!==ne||(this.onEnd(M),!(B.avail_out=0))},v.prototype.onData=function(w){this.chunks.push(w)},v.prototype.onEnd=function(w){w===M&&(this.result="string"===this.options.to?this.chunks.join(""):D.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},O.Deflate=v,O.deflate=k,O.deflateRaw=function(w,R){return(R=R||{}).raw=!0,k(w,R)},O.gzip=function(w,R){return(R=R||{}).gzip=!0,k(w,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(N,Y,O){"use strict";var A=N("./zlib/inflate"),D=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/constants"),b=N("./zlib/messages"),x=N("./zlib/zstream"),M=N("./zlib/gzheader"),m=Object.prototype.toString;function d(v){if(!(this instanceof d))return new d(v);this.options=D.assign({chunkSize:16384,windowBits:0,to:""},v||{});var k=this.options;k.raw&&0<=k.windowBits&&k.windowBits<16&&(k.windowBits=-k.windowBits,0===k.windowBits&&(k.windowBits=-15)),!(0<=k.windowBits&&k.windowBits<16)||v&&v.windowBits||(k.windowBits+=32),15<k.windowBits&&k.windowBits<48&&!(15&k.windowBits)&&(k.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var w=A.inflateInit2(this.strm,k.windowBits);if(w!==p.Z_OK)throw new Error(b[w]);this.header=new M,A.inflateGetHeader(this.strm,this.header)}function _(v,k){var w=new d(k);if(w.push(v,!0),w.err)throw w.msg||b[w.err];return w.result}d.prototype.push=function(v,k){var w,R,W,ne,B,V,z=this.strm,te=this.options.chunkSize,ee=this.options.dictionary,K=!1;if(this.ended)return!1;R=k===~~k?k:!0===k?p.Z_FINISH:p.Z_NO_FLUSH,z.input="string"==typeof v?f.binstring2buf(v):"[object ArrayBuffer]"===m.call(v)?new Uint8Array(v):v,z.next_in=0,z.avail_in=z.input.length;do{if(0===z.avail_out&&(z.output=new D.Buf8(te),z.next_out=0,z.avail_out=te),(w=A.inflate(z,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&ee&&(V="string"==typeof ee?f.string2buf(ee):"[object ArrayBuffer]"===m.call(ee)?new Uint8Array(ee):ee,w=A.inflateSetDictionary(this.strm,V)),w===p.Z_BUF_ERROR&&!0===K&&(w=p.Z_OK,K=!1),w!==p.Z_STREAM_END&&w!==p.Z_OK)return this.onEnd(w),!(this.ended=!0);z.next_out&&(0!==z.avail_out&&w!==p.Z_STREAM_END&&(0!==z.avail_in||R!==p.Z_FINISH&&R!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(W=f.utf8border(z.output,z.next_out),ne=z.next_out-W,B=f.buf2string(z.output,W),z.next_out=ne,z.avail_out=te-ne,ne&&D.arraySet(z.output,z.output,W,ne,0),this.onData(B)):this.onData(D.shrinkBuf(z.output,z.next_out)))),0===z.avail_in&&0===z.avail_out&&(K=!0)}while((0<z.avail_in||0===z.avail_out)&&w!==p.Z_STREAM_END);return w===p.Z_STREAM_END&&(R=p.Z_FINISH),R===p.Z_FINISH?(w=A.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===p.Z_OK):R!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!(z.avail_out=0))},d.prototype.onData=function(v){this.chunks.push(v)},d.prototype.onEnd=function(v){v===p.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):D.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},O.Inflate=d,O.inflate=_,O.inflateRaw=function(v,k){return(k=k||{}).raw=!0,_(v,k)},O.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(N,Y,O){"use strict";var A=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";O.assign=function(p){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var x=b.shift();if(x){if("object"!=typeof x)throw new TypeError(x+"must be non-object");for(var M in x)x.hasOwnProperty(M)&&(p[M]=x[M])}}return p},O.shrinkBuf=function(p,b){return p.length===b?p:p.subarray?p.subarray(0,b):(p.length=b,p)};var D={arraySet:function(p,b,x,M,m){if(b.subarray&&p.subarray)p.set(b.subarray(x,x+M),m);else for(var d=0;d<M;d++)p[m+d]=b[x+d]},flattenChunks:function(p){var b,x,M,m,d,_;for(b=M=0,x=p.length;b<x;b++)M+=p[b].length;for(_=new Uint8Array(M),b=m=0,x=p.length;b<x;b++)_.set(d=p[b],m),m+=d.length;return _}},f={arraySet:function(p,b,x,M,m){for(var d=0;d<M;d++)p[m+d]=b[x+d]},flattenChunks:function(p){return[].concat.apply([],p)}};O.setTyped=function(p){p?(O.Buf8=Uint8Array,O.Buf16=Uint16Array,O.Buf32=Int32Array,O.assign(O,D)):(O.Buf8=Array,O.Buf16=Array,O.Buf32=Array,O.assign(O,f))},O.setTyped(A)},{}],42:[function(N,Y,O){"use strict";var A=N("./common"),D=!0,f=!0;try{String.fromCharCode.apply(null,[0])}catch{D=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{f=!1}for(var p=new A.Buf8(256),b=0;b<256;b++)p[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function x(M,m){if(m<65537&&(M.subarray&&f||!M.subarray&&D))return String.fromCharCode.apply(null,A.shrinkBuf(M,m));for(var d="",_=0;_<m;_++)d+=String.fromCharCode(M[_]);return d}p[254]=p[254]=1,O.string2buf=function(M){var m,d,_,v,k,w=M.length,R=0;for(v=0;v<w;v++)55296==(64512&(d=M.charCodeAt(v)))&&v+1<w&&56320==(64512&(_=M.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),R+=d<128?1:d<2048?2:d<65536?3:4;for(m=new A.Buf8(R),v=k=0;k<R;v++)55296==(64512&(d=M.charCodeAt(v)))&&v+1<w&&56320==(64512&(_=M.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),d<128?m[k++]=d:(d<2048?m[k++]=192|d>>>6:(d<65536?m[k++]=224|d>>>12:(m[k++]=240|d>>>18,m[k++]=128|d>>>12&63),m[k++]=128|d>>>6&63),m[k++]=128|63&d);return m},O.buf2binstring=function(M){return x(M,M.length)},O.binstring2buf=function(M){for(var m=new A.Buf8(M.length),d=0,_=m.length;d<_;d++)m[d]=M.charCodeAt(d);return m},O.buf2string=function(M,m){var d,_,v,k,w=m||M.length,R=new Array(2*w);for(d=_=0;d<w;)if((v=M[d++])<128)R[_++]=v;else if(4<(k=p[v]))R[_++]=65533,d+=k-1;else{for(v&=2===k?31:3===k?15:7;1<k&&d<w;)v=v<<6|63&M[d++],k--;1<k?R[_++]=65533:v<65536?R[_++]=v:(R[_++]=55296|(v-=65536)>>10&1023,R[_++]=56320|1023&v)}return x(R,_)},O.utf8border=function(M,m){var d;for((m=m||M.length)>M.length&&(m=M.length),d=m-1;0<=d&&128==(192&M[d]);)d--;return d<0||0===d?m:d+p[M[d]]>m?d:m}},{"./common":41}],43:[function(N,Y,O){"use strict";Y.exports=function(A,D,f,p){for(var b=65535&A|0,x=A>>>16&65535|0,M=0;0!==f;){for(f-=M=2e3<f?2e3:f;x=x+(b=b+D[p++]|0)|0,--M;);b%=65521,x%=65521}return b|x<<16|0}},{}],44:[function(N,Y,O){"use strict";Y.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(N,Y,O){"use strict";var A=function(){for(var D,f=[],p=0;p<256;p++){D=p;for(var b=0;b<8;b++)D=1&D?3988292384^D>>>1:D>>>1;f[p]=D}return f}();Y.exports=function(D,f,p,b){var x=A,M=b+p;D^=-1;for(var m=b;m<M;m++)D=D>>>8^x[255&(D^f[m])];return-1^D}},{}],46:[function(N,Y,O){"use strict";var A,D=N("../utils/common"),f=N("./trees"),p=N("./adler32"),b=N("./crc32"),x=N("./messages"),M=0,m=4,d=0,_=-2,v=-1,k=4,w=2,R=8,W=9,ne=286,B=30,V=19,z=2*ne+1,te=15,ee=3,K=258,Ce=K+ee+1,$=42,ae=113,C=1,ge=2,ze=3,le=4;function Ae(y,_e){return y.msg=x[_e],_e}function ve(y){return(y<<1)-(4<y?9:0)}function xe(y){for(var _e=y.length;0<=--_e;)y[_e]=0}function fe(y){var _e=y.state,X=_e.pending;X>y.avail_out&&(X=y.avail_out),0!==X&&(D.arraySet(y.output,_e.pending_buf,_e.pending_out,X,y.next_out),y.next_out+=X,_e.pending_out+=X,y.total_out+=X,y.avail_out-=X,_e.pending-=X,0===_e.pending&&(_e.pending_out=0))}function me(y,_e){f._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,_e),y.block_start=y.strstart,fe(y.strm)}function Je(y,_e){y.pending_buf[y.pending++]=_e}function Ge(y,_e){y.pending_buf[y.pending++]=_e>>>8&255,y.pending_buf[y.pending++]=255&_e}function Ue(y,_e){var X,G,U=y.max_chain_length,se=y.strstart,we=y.prev_length,Te=y.nice_match,he=y.strstart>y.w_size-Ce?y.strstart-(y.w_size-Ce):0,Ne=y.window,Ze=y.w_mask,Pe=y.prev,ct=y.strstart+K,tn=Ne[se+we-1],Vt=Ne[se+we];y.prev_length>=y.good_match&&(U>>=2),Te>y.lookahead&&(Te=y.lookahead);do{if(Ne[(X=_e)+we]===Vt&&Ne[X+we-1]===tn&&Ne[X]===Ne[se]&&Ne[++X]===Ne[se+1]){se+=2,X++;do{}while(Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&Ne[++se]===Ne[++X]&&se<ct);if(G=K-(ct-se),se=ct-K,we<G){if(y.match_start=_e,Te<=(we=G))break;tn=Ne[se+we-1],Vt=Ne[se+we]}}}while((_e=Pe[_e&Ze])>he&&0!=--U);return we<=y.lookahead?we:y.lookahead}function qt(y){var _e,X,G,U,se,we,Te,he,Ne,Ze,Pe=y.w_size;do{if(U=y.window_size-y.lookahead-y.strstart,y.strstart>=Pe+(Pe-Ce)){for(D.arraySet(y.window,y.window,Pe,Pe,0),y.match_start-=Pe,y.strstart-=Pe,y.block_start-=Pe,_e=X=y.hash_size;G=y.head[--_e],y.head[_e]=Pe<=G?G-Pe:0,--X;);for(_e=X=Pe;G=y.prev[--_e],y.prev[_e]=Pe<=G?G-Pe:0,--X;);U+=Pe}if(0===y.strm.avail_in)break;if(Te=y.window,he=y.strstart+y.lookahead,Ze=void 0,(Ne=U)<(Ze=(we=y.strm).avail_in)&&(Ze=Ne),X=0===Ze?0:(we.avail_in-=Ze,D.arraySet(Te,we.input,we.next_in,Ze,he),1===we.state.wrap?we.adler=p(we.adler,Te,Ze,he):2===we.state.wrap&&(we.adler=b(we.adler,Te,Ze,he)),we.next_in+=Ze,we.total_in+=Ze,Ze),y.lookahead+=X,y.lookahead+y.insert>=ee)for(y.ins_h=y.window[se=y.strstart-y.insert],y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+ee-1])&y.hash_mask,y.prev[se&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=se,se++,y.insert--,!(y.lookahead+y.insert<ee)););}while(y.lookahead<Ce&&0!==y.strm.avail_in)}function Ve(y,_e){for(var X,G;;){if(y.lookahead<Ce){if(qt(y),y.lookahead<Ce&&_e===M)return C;if(0===y.lookahead)break}if(X=0,y.lookahead>=ee&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!==X&&y.strstart-X<=y.w_size-Ce&&(y.match_length=Ue(y,X)),y.match_length>=ee)if(G=f._tr_tally(y,y.strstart-y.match_start,y.match_length-ee),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=ee){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,0!=--y.match_length;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else G=f._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(G&&(me(y,!1),0===y.strm.avail_out))return C}return y.insert=y.strstart<ee-1?y.strstart:ee-1,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):y.last_lit&&(me(y,!1),0===y.strm.avail_out)?C:ge}function Ie(y,_e){for(var X,G,U;;){if(y.lookahead<Ce){if(qt(y),y.lookahead<Ce&&_e===M)return C;if(0===y.lookahead)break}if(X=0,y.lookahead>=ee&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=ee-1,0!==X&&y.prev_length<y.max_lazy_match&&y.strstart-X<=y.w_size-Ce&&(y.match_length=Ue(y,X),y.match_length<=5&&(1===y.strategy||y.match_length===ee&&4096<y.strstart-y.match_start)&&(y.match_length=ee-1)),y.prev_length>=ee&&y.match_length<=y.prev_length){for(U=y.strstart+y.lookahead-ee,G=f._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-ee),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=U&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,X=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!=--y.prev_length;);if(y.match_available=0,y.match_length=ee-1,y.strstart++,G&&(me(y,!1),0===y.strm.avail_out))return C}else if(y.match_available){if((G=f._tr_tally(y,0,y.window[y.strstart-1]))&&me(y,!1),y.strstart++,y.lookahead--,0===y.strm.avail_out)return C}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(G=f._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<ee-1?y.strstart:ee-1,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):y.last_lit&&(me(y,!1),0===y.strm.avail_out)?C:ge}function Fe(y,_e,X,G,U){this.good_length=y,this.max_lazy=_e,this.nice_length=X,this.max_chain=G,this.func=U}function pt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new D.Buf16(2*z),this.dyn_dtree=new D.Buf16(2*(2*B+1)),this.bl_tree=new D.Buf16(2*(2*V+1)),xe(this.dyn_ltree),xe(this.dyn_dtree),xe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new D.Buf16(te+1),this.heap=new D.Buf16(2*ne+1),xe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new D.Buf16(2*ne+1),xe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function nt(y){var _e;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=w,(_e=y.state).pending=0,_e.pending_out=0,_e.wrap<0&&(_e.wrap=-_e.wrap),_e.status=_e.wrap?$:ae,y.adler=2===_e.wrap?0:1,_e.last_flush=M,f._tr_init(_e),d):Ae(y,_)}function Kt(y){var X,_e=nt(y);return _e===d&&((X=y.state).window_size=2*X.w_size,xe(X.head),X.max_lazy_match=A[X.level].max_lazy,X.good_match=A[X.level].good_length,X.nice_match=A[X.level].nice_length,X.max_chain_length=A[X.level].max_chain,X.strstart=0,X.block_start=0,X.lookahead=0,X.insert=0,X.match_length=X.prev_length=ee-1,X.match_available=0,X.ins_h=0),_e}function Ct(y,_e,X,G,U,se){if(!y)return _;var we=1;if(_e===v&&(_e=6),G<0?(we=0,G=-G):15<G&&(we=2,G-=16),U<1||W<U||X!==R||G<8||15<G||_e<0||9<_e||se<0||k<se)return Ae(y,_);8===G&&(G=9);var Te=new pt;return(y.state=Te).strm=y,Te.wrap=we,Te.gzhead=null,Te.w_bits=G,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=U+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+ee-1)/ee),Te.window=new D.Buf8(2*Te.w_size),Te.head=new D.Buf16(Te.hash_size),Te.prev=new D.Buf16(Te.w_size),Te.lit_bufsize=1<<U+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new D.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=_e,Te.strategy=se,Te.method=X,Kt(y)}A=[new Fe(0,0,0,0,function(y,_e){var X=65535;for(X>y.pending_buf_size-5&&(X=y.pending_buf_size-5);;){if(y.lookahead<=1){if(qt(y),0===y.lookahead&&_e===M)return C;if(0===y.lookahead)break}y.strstart+=y.lookahead,y.lookahead=0;var G=y.block_start+X;if((0===y.strstart||y.strstart>=G)&&(y.lookahead=y.strstart-G,y.strstart=G,me(y,!1),0===y.strm.avail_out)||y.strstart-y.block_start>=y.w_size-Ce&&(me(y,!1),0===y.strm.avail_out))return C}return y.insert=0,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):(y.strstart>y.block_start&&me(y,!1),C)}),new Fe(4,4,8,4,Ve),new Fe(4,5,16,8,Ve),new Fe(4,6,32,32,Ve),new Fe(4,4,16,16,Ie),new Fe(8,16,32,32,Ie),new Fe(8,16,128,128,Ie),new Fe(8,32,128,256,Ie),new Fe(32,128,258,1024,Ie),new Fe(32,258,258,4096,Ie)],O.deflateInit=function(y,_e){return Ct(y,_e,R,15,8,0)},O.deflateInit2=Ct,O.deflateReset=Kt,O.deflateResetKeep=nt,O.deflateSetHeader=function(y,_e){return y&&y.state?2!==y.state.wrap?_:(y.state.gzhead=_e,d):_},O.deflate=function(y,_e){var X,G,U,se;if(!y||!y.state||5<_e||_e<0)return y?Ae(y,_):_;if(G=y.state,!y.output||!y.input&&0!==y.avail_in||666===G.status&&_e!==m)return Ae(y,0===y.avail_out?-5:_);if(G.strm=y,X=G.last_flush,G.last_flush=_e,G.status===$)if(2===G.wrap)y.adler=0,Je(G,31),Je(G,139),Je(G,8),G.gzhead?(Je(G,(G.gzhead.text?1:0)+(G.gzhead.hcrc?2:0)+(G.gzhead.extra?4:0)+(G.gzhead.name?8:0)+(G.gzhead.comment?16:0)),Je(G,255&G.gzhead.time),Je(G,G.gzhead.time>>8&255),Je(G,G.gzhead.time>>16&255),Je(G,G.gzhead.time>>24&255),Je(G,9===G.level?2:2<=G.strategy||G.level<2?4:0),Je(G,255&G.gzhead.os),G.gzhead.extra&&G.gzhead.extra.length&&(Je(G,255&G.gzhead.extra.length),Je(G,G.gzhead.extra.length>>8&255)),G.gzhead.hcrc&&(y.adler=b(y.adler,G.pending_buf,G.pending,0)),G.gzindex=0,G.status=69):(Je(G,0),Je(G,0),Je(G,0),Je(G,0),Je(G,0),Je(G,9===G.level?2:2<=G.strategy||G.level<2?4:0),Je(G,3),G.status=ae);else{var we=R+(G.w_bits-8<<4)<<8;we|=(2<=G.strategy||G.level<2?0:G.level<6?1:6===G.level?2:3)<<6,0!==G.strstart&&(we|=32),we+=31-we%31,G.status=ae,Ge(G,we),0!==G.strstart&&(Ge(G,y.adler>>>16),Ge(G,65535&y.adler)),y.adler=1}if(69===G.status)if(G.gzhead.extra){for(U=G.pending;G.gzindex<(65535&G.gzhead.extra.length)&&(G.pending!==G.pending_buf_size||(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),fe(y),U=G.pending,G.pending!==G.pending_buf_size));)Je(G,255&G.gzhead.extra[G.gzindex]),G.gzindex++;G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),G.gzindex===G.gzhead.extra.length&&(G.gzindex=0,G.status=73)}else G.status=73;if(73===G.status)if(G.gzhead.name){U=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),fe(y),U=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.name.length?255&G.gzhead.name.charCodeAt(G.gzindex++):0,Je(G,se)}while(0!==se);G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),0===se&&(G.gzindex=0,G.status=91)}else G.status=91;if(91===G.status)if(G.gzhead.comment){U=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),fe(y),U=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.comment.length?255&G.gzhead.comment.charCodeAt(G.gzindex++):0,Je(G,se)}while(0!==se);G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),0===se&&(G.status=103)}else G.status=103;if(103===G.status&&(G.gzhead.hcrc?(G.pending+2>G.pending_buf_size&&fe(y),G.pending+2<=G.pending_buf_size&&(Je(G,255&y.adler),Je(G,y.adler>>8&255),y.adler=0,G.status=ae)):G.status=ae),0!==G.pending){if(fe(y),0===y.avail_out)return G.last_flush=-1,d}else if(0===y.avail_in&&ve(_e)<=ve(X)&&_e!==m)return Ae(y,-5);if(666===G.status&&0!==y.avail_in)return Ae(y,-5);if(0!==y.avail_in||0!==G.lookahead||_e!==M&&666!==G.status){var Te=2===G.strategy?function(he,Ne){for(var Ze;;){if(0===he.lookahead&&(qt(he),0===he.lookahead)){if(Ne===M)return C;break}if(he.match_length=0,Ze=f._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,Ze&&(me(he,!1),0===he.strm.avail_out))return C}return he.insert=0,Ne===m?(me(he,!0),0===he.strm.avail_out?ze:le):he.last_lit&&(me(he,!1),0===he.strm.avail_out)?C:ge}(G,_e):3===G.strategy?function(he,Ne){for(var Ze,Pe,ct,tn,Vt=he.window;;){if(he.lookahead<=K){if(qt(he),he.lookahead<=K&&Ne===M)return C;if(0===he.lookahead)break}if(he.match_length=0,he.lookahead>=ee&&0<he.strstart&&(Pe=Vt[ct=he.strstart-1])===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]){tn=he.strstart+K;do{}while(Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&ct<tn);he.match_length=K-(tn-ct),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=ee?(Ze=f._tr_tally(he,1,he.match_length-ee),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):(Ze=f._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),Ze&&(me(he,!1),0===he.strm.avail_out))return C}return he.insert=0,Ne===m?(me(he,!0),0===he.strm.avail_out?ze:le):he.last_lit&&(me(he,!1),0===he.strm.avail_out)?C:ge}(G,_e):A[G.level].func(G,_e);if(Te!==ze&&Te!==le||(G.status=666),Te===C||Te===ze)return 0===y.avail_out&&(G.last_flush=-1),d;if(Te===ge&&(1===_e?f._tr_align(G):5!==_e&&(f._tr_stored_block(G,0,0,!1),3===_e&&(xe(G.head),0===G.lookahead&&(G.strstart=0,G.block_start=0,G.insert=0))),fe(y),0===y.avail_out))return G.last_flush=-1,d}return _e!==m?d:G.wrap<=0?1:(2===G.wrap?(Je(G,255&y.adler),Je(G,y.adler>>8&255),Je(G,y.adler>>16&255),Je(G,y.adler>>24&255),Je(G,255&y.total_in),Je(G,y.total_in>>8&255),Je(G,y.total_in>>16&255),Je(G,y.total_in>>24&255)):(Ge(G,y.adler>>>16),Ge(G,65535&y.adler)),fe(y),0<G.wrap&&(G.wrap=-G.wrap),0!==G.pending?d:1)},O.deflateEnd=function(y){var _e;return y&&y.state?(_e=y.state.status)!==$&&69!==_e&&73!==_e&&91!==_e&&103!==_e&&_e!==ae&&666!==_e?Ae(y,_):(y.state=null,_e===ae?Ae(y,-3):d):_},O.deflateSetDictionary=function(y,_e){var X,G,U,se,we,Te,he,Ne,Ze=_e.length;if(!y||!y.state||2===(se=(X=y.state).wrap)||1===se&&X.status!==$||X.lookahead)return _;for(1===se&&(y.adler=p(y.adler,_e,Ze,0)),X.wrap=0,Ze>=X.w_size&&(0===se&&(xe(X.head),X.strstart=0,X.block_start=0,X.insert=0),Ne=new D.Buf8(X.w_size),D.arraySet(Ne,_e,Ze-X.w_size,X.w_size,0),_e=Ne,Ze=X.w_size),we=y.avail_in,Te=y.next_in,he=y.input,y.avail_in=Ze,y.next_in=0,y.input=_e,qt(X);X.lookahead>=ee;){for(G=X.strstart,U=X.lookahead-(ee-1);X.ins_h=(X.ins_h<<X.hash_shift^X.window[G+ee-1])&X.hash_mask,X.prev[G&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=G,G++,--U;);X.strstart=G,X.lookahead=ee-1,qt(X)}return X.strstart+=X.lookahead,X.block_start=X.strstart,X.insert=X.lookahead,X.lookahead=0,X.match_length=X.prev_length=ee-1,X.match_available=0,y.next_in=Te,y.input=he,y.avail_in=we,X.wrap=se,d},O.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(N,Y,O){"use strict";Y.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(N,Y,O){"use strict";Y.exports=function(A,D){var f,p,b,x,M,m,d,_,v,k,w,R,W,ne,B,V,z,te,ee,K,Ce,$,ae,C,ge;C=A.input,b=(p=A.next_in)+(A.avail_in-5),ge=A.output,M=(x=A.next_out)-(D-A.avail_out),m=x+(A.avail_out-257),d=(f=A.state).dmax,_=f.wsize,v=f.whave,k=f.wnext,w=f.window,R=f.hold,W=f.bits,ne=f.lencode,B=f.distcode,V=(1<<f.lenbits)-1,z=(1<<f.distbits)-1;e:do{W<15&&(R+=C[p++]<<W,R+=C[p++]<<(W+=8),W+=8),te=ne[R&V];t:for(;;){if(R>>>=ee=te>>>24,W-=ee,0==(ee=te>>>16&255))ge[x++]=65535&te;else{if(!(16&ee)){if(!(64&ee)){te=ne[(65535&te)+(R&(1<<ee)-1)];continue t}if(32&ee){f.mode=12;break e}A.msg="invalid literal/length code",f.mode=30;break e}K=65535&te,(ee&=15)&&(W<ee&&(R+=C[p++]<<W,W+=8),K+=R&(1<<ee)-1,R>>>=ee,W-=ee),W<15&&(R+=C[p++]<<W,R+=C[p++]<<(W+=8),W+=8),te=B[R&z];n:for(;;){if(R>>>=ee=te>>>24,W-=ee,!(16&(ee=te>>>16&255))){if(!(64&ee)){te=B[(65535&te)+(R&(1<<ee)-1)];continue n}A.msg="invalid distance code",f.mode=30;break e}if(Ce=65535&te,W<(ee&=15)&&(R+=C[p++]<<W,(W+=8)<ee&&(R+=C[p++]<<W,W+=8)),d<(Ce+=R&(1<<ee)-1)){A.msg="invalid distance too far back",f.mode=30;break e}if(R>>>=ee,W-=ee,(ee=x-M)<Ce){if(v<(ee=Ce-ee)&&f.sane){A.msg="invalid distance too far back",f.mode=30;break e}if(ae=w,($=0)===k){if($+=_-ee,ee<K){for(K-=ee;ge[x++]=w[$++],--ee;);$=x-Ce,ae=ge}}else if(k<ee){if($+=_+k-ee,(ee-=k)<K){for(K-=ee;ge[x++]=w[$++],--ee;);if($=0,k<K){for(K-=ee=k;ge[x++]=w[$++],--ee;);$=x-Ce,ae=ge}}}else if($+=k-ee,ee<K){for(K-=ee;ge[x++]=w[$++],--ee;);$=x-Ce,ae=ge}for(;2<K;)ge[x++]=ae[$++],ge[x++]=ae[$++],ge[x++]=ae[$++],K-=3;K&&(ge[x++]=ae[$++],1<K&&(ge[x++]=ae[$++]))}else{for($=x-Ce;ge[x++]=ge[$++],ge[x++]=ge[$++],ge[x++]=ge[$++],2<(K-=3););K&&(ge[x++]=ge[$++],1<K&&(ge[x++]=ge[$++]))}break}}break}}while(p<b&&x<m);p-=K=W>>3,R&=(1<<(W-=K<<3))-1,A.next_in=p,A.next_out=x,A.avail_in=p<b?b-p+5:5-(p-b),A.avail_out=x<m?m-x+257:257-(x-m),f.hold=R,f.bits=W}},{}],49:[function(N,Y,O){"use strict";var A=N("../utils/common"),D=N("./adler32"),f=N("./crc32"),p=N("./inffast"),b=N("./inftrees"),x=1,M=2,m=0,d=-2,_=1,v=852,k=592;function w($){return($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new A.Buf16(320),this.work=new A.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function W($){var ae;return $&&$.state?($.total_in=$.total_out=(ae=$.state).total=0,$.msg="",ae.wrap&&($.adler=1&ae.wrap),ae.mode=_,ae.last=0,ae.havedict=0,ae.dmax=32768,ae.head=null,ae.hold=0,ae.bits=0,ae.lencode=ae.lendyn=new A.Buf32(v),ae.distcode=ae.distdyn=new A.Buf32(k),ae.sane=1,ae.back=-1,m):d}function ne($){var ae;return $&&$.state?((ae=$.state).wsize=0,ae.whave=0,ae.wnext=0,W($)):d}function B($,ae){var C,ge;return $&&$.state?(ge=$.state,ae<0?(C=0,ae=-ae):(C=1+(ae>>4),ae<48&&(ae&=15)),ae&&(ae<8||15<ae)?d:(null!==ge.window&&ge.wbits!==ae&&(ge.window=null),ge.wrap=C,ge.wbits=ae,ne($))):d}function V($,ae){var C,ge;return $?(ge=new R,($.state=ge).window=null,(C=B($,ae))!==m&&($.state=null),C):d}var z,te,ee=!0;function K($){if(ee){var ae;for(z=new A.Buf32(512),te=new A.Buf32(32),ae=0;ae<144;)$.lens[ae++]=8;for(;ae<256;)$.lens[ae++]=9;for(;ae<280;)$.lens[ae++]=7;for(;ae<288;)$.lens[ae++]=8;for(b(x,$.lens,0,288,z,0,$.work,{bits:9}),ae=0;ae<32;)$.lens[ae++]=5;b(M,$.lens,0,32,te,0,$.work,{bits:5}),ee=!1}$.lencode=z,$.lenbits=9,$.distcode=te,$.distbits=5}function Ce($,ae,C,ge){var ze,le=$.state;return null===le.window&&(le.wsize=1<<le.wbits,le.wnext=0,le.whave=0,le.window=new A.Buf8(le.wsize)),ge>=le.wsize?(A.arraySet(le.window,ae,C-le.wsize,le.wsize,0),le.wnext=0,le.whave=le.wsize):(ge<(ze=le.wsize-le.wnext)&&(ze=ge),A.arraySet(le.window,ae,C-ge,ze,le.wnext),(ge-=ze)?(A.arraySet(le.window,ae,C-ge,ge,0),le.wnext=ge,le.whave=le.wsize):(le.wnext+=ze,le.wnext===le.wsize&&(le.wnext=0),le.whave<le.wsize&&(le.whave+=ze))),0}O.inflateReset=ne,O.inflateReset2=B,O.inflateResetKeep=W,O.inflateInit=function($){return V($,15)},O.inflateInit2=V,O.inflate=function($,ae){var C,ge,ze,le,Ae,ve,xe,fe,me,Je,Ge,Ue,qt,Ve,Ie,Fe,pt,nt,Kt,Ct,y,_e,X,G,U=0,se=new A.Buf8(4),we=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&0!==$.avail_in)return d;12===(C=$.state).mode&&(C.mode=13),Ae=$.next_out,ze=$.output,le=$.next_in,ge=$.input,fe=C.hold,me=C.bits,Je=ve=$.avail_in,Ge=xe=$.avail_out,_e=m;e:for(;;)switch(C.mode){case _:if(0===C.wrap){C.mode=13;break}for(;me<16;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(2&C.wrap&&35615===fe){se[C.check=0]=255&fe,se[1]=fe>>>8&255,C.check=f(C.check,se,2,0),me=fe=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&fe)<<8)+(fe>>8))%31){$.msg="incorrect header check",C.mode=30;break}if(8!=(15&fe)){$.msg="unknown compression method",C.mode=30;break}if(me-=4,y=8+(15&(fe>>>=4)),0===C.wbits)C.wbits=y;else if(y>C.wbits){$.msg="invalid window size",C.mode=30;break}C.dmax=1<<y,$.adler=C.check=1,C.mode=512&fe?10:12,me=fe=0;break;case 2:for(;me<16;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(C.flags=fe,8!=(255&C.flags)){$.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){$.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=fe>>8&1),512&C.flags&&(se[0]=255&fe,se[1]=fe>>>8&255,C.check=f(C.check,se,2,0)),me=fe=0,C.mode=3;case 3:for(;me<32;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.head&&(C.head.time=fe),512&C.flags&&(se[0]=255&fe,se[1]=fe>>>8&255,se[2]=fe>>>16&255,se[3]=fe>>>24&255,C.check=f(C.check,se,4,0)),me=fe=0,C.mode=4;case 4:for(;me<16;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.head&&(C.head.xflags=255&fe,C.head.os=fe>>8),512&C.flags&&(se[0]=255&fe,se[1]=fe>>>8&255,C.check=f(C.check,se,2,0)),me=fe=0,C.mode=5;case 5:if(1024&C.flags){for(;me<16;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.length=fe,C.head&&(C.head.extra_len=fe),512&C.flags&&(se[0]=255&fe,se[1]=fe>>>8&255,C.check=f(C.check,se,2,0)),me=fe=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(ve<(Ue=C.length)&&(Ue=ve),Ue&&(C.head&&(y=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),A.arraySet(C.head.extra,ge,le,Ue,y)),512&C.flags&&(C.check=f(C.check,ge,Ue,le)),ve-=Ue,le+=Ue,C.length-=Ue),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(0===ve)break e;for(Ue=0;y=ge[le+Ue++],C.head&&y&&C.length<65536&&(C.head.name+=String.fromCharCode(y)),y&&Ue<ve;);if(512&C.flags&&(C.check=f(C.check,ge,Ue,le)),ve-=Ue,le+=Ue,y)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(0===ve)break e;for(Ue=0;y=ge[le+Ue++],C.head&&y&&C.length<65536&&(C.head.comment+=String.fromCharCode(y)),y&&Ue<ve;);if(512&C.flags&&(C.check=f(C.check,ge,Ue,le)),ve-=Ue,le+=Ue,y)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;me<16;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(fe!==(65535&C.check)){$.msg="header crc mismatch",C.mode=30;break}me=fe=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),$.adler=C.check=0,C.mode=12;break;case 10:for(;me<32;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}$.adler=C.check=w(fe),me=fe=0,C.mode=11;case 11:if(0===C.havedict)return $.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=fe,C.bits=me,2;$.adler=C.check=1,C.mode=12;case 12:if(5===ae||6===ae)break e;case 13:if(C.last){fe>>>=7&me,me-=7&me,C.mode=27;break}for(;me<3;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}switch(C.last=1&fe,me-=1,3&(fe>>>=1)){case 0:C.mode=14;break;case 1:if(K(C),C.mode=20,6!==ae)break;fe>>>=2,me-=2;break e;case 2:C.mode=17;break;case 3:$.msg="invalid block type",C.mode=30}fe>>>=2,me-=2;break;case 14:for(fe>>>=7&me,me-=7&me;me<32;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if((65535&fe)!=(fe>>>16^65535)){$.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&fe,me=fe=0,C.mode=15,6===ae)break e;case 15:C.mode=16;case 16:if(Ue=C.length){if(ve<Ue&&(Ue=ve),xe<Ue&&(Ue=xe),0===Ue)break e;A.arraySet(ze,ge,le,Ue,Ae),ve-=Ue,le+=Ue,xe-=Ue,Ae+=Ue,C.length-=Ue;break}C.mode=12;break;case 17:for(;me<14;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(C.nlen=257+(31&fe),me-=5,C.ndist=1+(31&(fe>>>=5)),me-=5,C.ncode=4+(15&(fe>>>=5)),fe>>>=4,me-=4,286<C.nlen||30<C.ndist){$.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;me<3;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.lens[we[C.have++]]=7&fe,fe>>>=3,me-=3}for(;C.have<19;)C.lens[we[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,_e=b(0,C.lens,0,19,C.lencode,0,C.work,X={bits:C.lenbits}),C.lenbits=X.bits,_e){$.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;Fe=(U=C.lencode[fe&(1<<C.lenbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(pt<16)fe>>>=Ie,me-=Ie,C.lens[C.have++]=pt;else{if(16===pt){for(G=Ie+2;me<G;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(fe>>>=Ie,me-=Ie,0===C.have){$.msg="invalid bit length repeat",C.mode=30;break}y=C.lens[C.have-1],Ue=3+(3&fe),fe>>>=2,me-=2}else if(17===pt){for(G=Ie+3;me<G;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}me-=Ie,y=0,Ue=3+(7&(fe>>>=Ie)),fe>>>=3,me-=3}else{for(G=Ie+7;me<G;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}me-=Ie,y=0,Ue=11+(127&(fe>>>=Ie)),fe>>>=7,me-=7}if(C.have+Ue>C.nlen+C.ndist){$.msg="invalid bit length repeat",C.mode=30;break}for(;Ue--;)C.lens[C.have++]=y}}if(30===C.mode)break;if(0===C.lens[256]){$.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,_e=b(x,C.lens,0,C.nlen,C.lencode,0,C.work,X={bits:C.lenbits}),C.lenbits=X.bits,_e){$.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,_e=b(M,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,X={bits:C.distbits}),C.distbits=X.bits,_e){$.msg="invalid distances set",C.mode=30;break}if(C.mode=20,6===ae)break e;case 20:C.mode=21;case 21:if(6<=ve&&258<=xe){$.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=fe,C.bits=me,p($,Ge),Ae=$.next_out,ze=$.output,xe=$.avail_out,le=$.next_in,ge=$.input,ve=$.avail_in,fe=C.hold,me=C.bits,12===C.mode&&(C.back=-1);break}for(C.back=0;Fe=(U=C.lencode[fe&(1<<C.lenbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(Fe&&!(240&Fe)){for(nt=Ie,Kt=Fe,Ct=pt;Fe=(U=C.lencode[Ct+((fe&(1<<nt+Kt)-1)>>nt)])>>>16&255,pt=65535&U,!(nt+(Ie=U>>>24)<=me);){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}fe>>>=nt,me-=nt,C.back+=nt}if(fe>>>=Ie,me-=Ie,C.back+=Ie,C.length=pt,0===Fe){C.mode=26;break}if(32&Fe){C.back=-1,C.mode=12;break}if(64&Fe){$.msg="invalid literal/length code",C.mode=30;break}C.extra=15&Fe,C.mode=22;case 22:if(C.extra){for(G=C.extra;me<G;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.length+=fe&(1<<C.extra)-1,fe>>>=C.extra,me-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;Fe=(U=C.distcode[fe&(1<<C.distbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(!(240&Fe)){for(nt=Ie,Kt=Fe,Ct=pt;Fe=(U=C.distcode[Ct+((fe&(1<<nt+Kt)-1)>>nt)])>>>16&255,pt=65535&U,!(nt+(Ie=U>>>24)<=me);){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}fe>>>=nt,me-=nt,C.back+=nt}if(fe>>>=Ie,me-=Ie,C.back+=Ie,64&Fe){$.msg="invalid distance code",C.mode=30;break}C.offset=pt,C.extra=15&Fe,C.mode=24;case 24:if(C.extra){for(G=C.extra;me<G;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}C.offset+=fe&(1<<C.extra)-1,fe>>>=C.extra,me-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){$.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(0===xe)break e;if(C.offset>(Ue=Ge-xe)){if((Ue=C.offset-Ue)>C.whave&&C.sane){$.msg="invalid distance too far back",C.mode=30;break}qt=Ue>C.wnext?C.wsize-(Ue-=C.wnext):C.wnext-Ue,Ue>C.length&&(Ue=C.length),Ve=C.window}else Ve=ze,qt=Ae-C.offset,Ue=C.length;for(xe<Ue&&(Ue=xe),xe-=Ue,C.length-=Ue;ze[Ae++]=Ve[qt++],--Ue;);0===C.length&&(C.mode=21);break;case 26:if(0===xe)break e;ze[Ae++]=C.length,xe--,C.mode=21;break;case 27:if(C.wrap){for(;me<32;){if(0===ve)break e;ve--,fe|=ge[le++]<<me,me+=8}if($.total_out+=Ge-=xe,C.total+=Ge,Ge&&($.adler=C.check=C.flags?f(C.check,ze,Ge,Ae-Ge):D(C.check,ze,Ge,Ae-Ge)),Ge=xe,(C.flags?fe:w(fe))!==C.check){$.msg="incorrect data check",C.mode=30;break}me=fe=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;me<32;){if(0===ve)break e;ve--,fe+=ge[le++]<<me,me+=8}if(fe!==(4294967295&C.total)){$.msg="incorrect length check",C.mode=30;break}me=fe=0}C.mode=29;case 29:_e=1;break e;case 30:_e=-3;break e;case 31:return-4;default:return d}return $.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=fe,C.bits=me,(C.wsize||Ge!==$.avail_out&&C.mode<30&&(C.mode<27||4!==ae))&&Ce($,$.output,$.next_out,Ge-$.avail_out)?(C.mode=31,-4):(Ge-=$.avail_out,$.total_in+=Je-=$.avail_in,$.total_out+=Ge,C.total+=Ge,C.wrap&&Ge&&($.adler=C.check=C.flags?f(C.check,ze,Ge,$.next_out-Ge):D(C.check,ze,Ge,$.next_out-Ge)),$.data_type=C.bits+(C.last?64:0)+(12===C.mode?128:0)+(20===C.mode||15===C.mode?256:0),(0==Je&&0===Ge||4===ae)&&_e===m&&(_e=-5),_e)},O.inflateEnd=function($){if(!$||!$.state)return d;var ae=$.state;return ae.window&&(ae.window=null),$.state=null,m},O.inflateGetHeader=function($,ae){var C;return $&&$.state&&2&(C=$.state).wrap?((C.head=ae).done=!1,m):d},O.inflateSetDictionary=function($,ae){var C,ge=ae.length;return $&&$.state?0!==(C=$.state).wrap&&11!==C.mode?d:11===C.mode&&D(1,ae,ge,0)!==C.check?-3:Ce($,ae,ge,ge)?(C.mode=31,-4):(C.havedict=1,m):d},O.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(N,Y,O){"use strict";var A=N("../utils/common"),D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Y.exports=function(x,M,m,d,_,v,k,w){var R,W,ne,B,V,z,te,ee,K,Ce=w.bits,$=0,ae=0,C=0,ge=0,ze=0,le=0,Ae=0,ve=0,xe=0,fe=0,me=null,Je=0,Ge=new A.Buf16(16),Ue=new A.Buf16(16),qt=null,Ve=0;for($=0;$<=15;$++)Ge[$]=0;for(ae=0;ae<d;ae++)Ge[M[m+ae]]++;for(ze=Ce,ge=15;1<=ge&&0===Ge[ge];ge--);if(ge<ze&&(ze=ge),0===ge)return _[v++]=20971520,_[v++]=20971520,w.bits=1,0;for(C=1;C<ge&&0===Ge[C];C++);for(ze<C&&(ze=C),$=ve=1;$<=15;$++)if(ve<<=1,(ve-=Ge[$])<0)return-1;if(0<ve&&(0===x||1!==ge))return-1;for(Ue[1]=0,$=1;$<15;$++)Ue[$+1]=Ue[$]+Ge[$];for(ae=0;ae<d;ae++)0!==M[m+ae]&&(k[Ue[M[m+ae]]++]=ae);if(z=0===x?(me=qt=k,19):1===x?(me=D,Je-=257,qt=f,Ve-=257,256):(me=p,qt=b,-1),$=C,V=v,Ae=ae=fe=0,ne=-1,B=(xe=1<<(le=ze))-1,1===x&&852<xe||2===x&&592<xe)return 1;for(;;){for(te=$-Ae,K=k[ae]<z?(ee=0,k[ae]):k[ae]>z?(ee=qt[Ve+k[ae]],me[Je+k[ae]]):(ee=96,0),R=1<<$-Ae,C=W=1<<le;_[V+(fe>>Ae)+(W-=R)]=te<<24|ee<<16|K|0,0!==W;);for(R=1<<$-1;fe&R;)R>>=1;if(0!==R?(fe&=R-1,fe+=R):fe=0,ae++,0==--Ge[$]){if($===ge)break;$=M[m+k[ae]]}if(ze<$&&(fe&B)!==ne){for(0===Ae&&(Ae=ze),V+=C,ve=1<<(le=$-Ae);le+Ae<ge&&!((ve-=Ge[le+Ae])<=0);)le++,ve<<=1;if(xe+=1<<le,1===x&&852<xe||2===x&&592<xe)return 1;_[ne=fe&B]=ze<<24|le<<16|V-v|0}}return 0!==fe&&(_[V+fe]=$-Ae<<24|64<<16|0),w.bits=ze,0}},{"../utils/common":41}],51:[function(N,Y,O){"use strict";Y.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(N,Y,O){"use strict";var A=N("../utils/common");function p(U){for(var se=U.length;0<=--se;)U[se]=0}var b=0,M=256,m=M+1+29,d=30,_=19,v=2*m+1,k=15,w=16,W=256,ne=16,B=17,V=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ce=new Array(2*(m+2));p(Ce);var $=new Array(2*d);p($);var ae=new Array(512);p(ae);var C=new Array(256);p(C);var ge=new Array(29);p(ge);var ze,le,Ae,ve=new Array(d);function xe(U,se,we,Te,he){this.static_tree=U,this.extra_bits=se,this.extra_base=we,this.elems=Te,this.max_length=he,this.has_stree=U&&U.length}function fe(U,se){this.dyn_tree=U,this.max_code=0,this.stat_desc=se}function me(U){return U<256?ae[U]:ae[256+(U>>>7)]}function Je(U,se){U.pending_buf[U.pending++]=255&se,U.pending_buf[U.pending++]=se>>>8&255}function Ge(U,se,we){U.bi_valid>w-we?(U.bi_buf|=se<<U.bi_valid&65535,Je(U,U.bi_buf),U.bi_buf=se>>w-U.bi_valid,U.bi_valid+=we-w):(U.bi_buf|=se<<U.bi_valid&65535,U.bi_valid+=we)}function Ue(U,se,we){Ge(U,we[2*se],we[2*se+1])}function qt(U,se){for(var we=0;we|=1&U,U>>>=1,we<<=1,0<--se;);return we>>>1}function Ve(U,se,we){var Te,he,Ne=new Array(k+1),Ze=0;for(Te=1;Te<=k;Te++)Ne[Te]=Ze=Ze+we[Te-1]<<1;for(he=0;he<=se;he++){var Pe=U[2*he+1];0!==Pe&&(U[2*he]=qt(Ne[Pe]++,Pe))}}function Ie(U){var se;for(se=0;se<m;se++)U.dyn_ltree[2*se]=0;for(se=0;se<d;se++)U.dyn_dtree[2*se]=0;for(se=0;se<_;se++)U.bl_tree[2*se]=0;U.dyn_ltree[2*W]=1,U.opt_len=U.static_len=0,U.last_lit=U.matches=0}function Fe(U){8<U.bi_valid?Je(U,U.bi_buf):0<U.bi_valid&&(U.pending_buf[U.pending++]=U.bi_buf),U.bi_buf=0,U.bi_valid=0}function pt(U,se,we,Te){var he=2*se,Ne=2*we;return U[he]<U[Ne]||U[he]===U[Ne]&&Te[se]<=Te[we]}function nt(U,se,we){for(var Te=U.heap[we],he=we<<1;he<=U.heap_len&&(he<U.heap_len&&pt(se,U.heap[he+1],U.heap[he],U.depth)&&he++,!pt(se,Te,U.heap[he],U.depth));)U.heap[we]=U.heap[he],we=he,he<<=1;U.heap[we]=Te}function Kt(U,se,we){var Te,he,Ne,Ze,Pe=0;if(0!==U.last_lit)for(;Te=U.pending_buf[U.d_buf+2*Pe]<<8|U.pending_buf[U.d_buf+2*Pe+1],he=U.pending_buf[U.l_buf+Pe],Pe++,0===Te?Ue(U,he,se):(Ue(U,(Ne=C[he])+M+1,se),0!==(Ze=z[Ne])&&Ge(U,he-=ge[Ne],Ze),Ue(U,Ne=me(--Te),we),0!==(Ze=te[Ne])&&Ge(U,Te-=ve[Ne],Ze)),Pe<U.last_lit;);Ue(U,W,se)}function Ct(U,se){var we,Te,he,Ne=se.dyn_tree,Ze=se.stat_desc.static_tree,Pe=se.stat_desc.has_stree,ct=se.stat_desc.elems,tn=-1;for(U.heap_len=0,U.heap_max=v,we=0;we<ct;we++)0!==Ne[2*we]?(U.heap[++U.heap_len]=tn=we,U.depth[we]=0):Ne[2*we+1]=0;for(;U.heap_len<2;)Ne[2*(he=U.heap[++U.heap_len]=tn<2?++tn:0)]=1,U.depth[he]=0,U.opt_len--,Pe&&(U.static_len-=Ze[2*he+1]);for(se.max_code=tn,we=U.heap_len>>1;1<=we;we--)nt(U,Ne,we);for(he=ct;we=U.heap[1],U.heap[1]=U.heap[U.heap_len--],nt(U,Ne,1),Te=U.heap[1],U.heap[--U.heap_max]=we,U.heap[--U.heap_max]=Te,Ne[2*he]=Ne[2*we]+Ne[2*Te],U.depth[he]=(U.depth[we]>=U.depth[Te]?U.depth[we]:U.depth[Te])+1,Ne[2*we+1]=Ne[2*Te+1]=he,U.heap[1]=he++,nt(U,Ne,1),2<=U.heap_len;);U.heap[--U.heap_max]=U.heap[1],function(Vt,Vi){var ks,er,xi,mn,Is,yo,tr=Vi.dyn_tree,Qa=Vi.max_code,md=Vi.stat_desc.static_tree,_d=Vi.stat_desc.has_stree,vd=Vi.stat_desc.extra_bits,Cc=Vi.stat_desc.extra_base,Jr=Vi.stat_desc.max_length,es=0;for(mn=0;mn<=k;mn++)Vt.bl_count[mn]=0;for(tr[2*Vt.heap[Vt.heap_max]+1]=0,ks=Vt.heap_max+1;ks<v;ks++)Jr<(mn=tr[2*tr[2*(er=Vt.heap[ks])+1]+1]+1)&&(mn=Jr,es++),tr[2*er+1]=mn,Qa<er||(Vt.bl_count[mn]++,Is=0,Cc<=er&&(Is=vd[er-Cc]),Vt.opt_len+=(yo=tr[2*er])*(mn+Is),_d&&(Vt.static_len+=yo*(md[2*er+1]+Is)));if(0!==es){do{for(mn=Jr-1;0===Vt.bl_count[mn];)mn--;Vt.bl_count[mn]--,Vt.bl_count[mn+1]+=2,Vt.bl_count[Jr]--,es-=2}while(0<es);for(mn=Jr;0!==mn;mn--)for(er=Vt.bl_count[mn];0!==er;)Qa<(xi=Vt.heap[--ks])||(tr[2*xi+1]!==mn&&(Vt.opt_len+=(mn-tr[2*xi+1])*tr[2*xi],tr[2*xi+1]=mn),er--)}}(U,se),Ve(Ne,tn,U.bl_count)}function y(U,se,we){var Te,he,Ne=-1,Ze=se[1],Pe=0,ct=7,tn=4;for(0===Ze&&(ct=138,tn=3),se[2*(we+1)+1]=65535,Te=0;Te<=we;Te++)he=Ze,Ze=se[2*(Te+1)+1],++Pe<ct&&he===Ze||(Pe<tn?U.bl_tree[2*he]+=Pe:0!==he?(he!==Ne&&U.bl_tree[2*he]++,U.bl_tree[2*ne]++):Pe<=10?U.bl_tree[2*B]++:U.bl_tree[2*V]++,Ne=he,tn=(Pe=0)===Ze?(ct=138,3):he===Ze?(ct=6,3):(ct=7,4))}function _e(U,se,we){var Te,he,Ne=-1,Ze=se[1],Pe=0,ct=7,tn=4;for(0===Ze&&(ct=138,tn=3),Te=0;Te<=we;Te++)if(he=Ze,Ze=se[2*(Te+1)+1],!(++Pe<ct&&he===Ze)){if(Pe<tn)for(;Ue(U,he,U.bl_tree),0!=--Pe;);else 0!==he?(he!==Ne&&(Ue(U,he,U.bl_tree),Pe--),Ue(U,ne,U.bl_tree),Ge(U,Pe-3,2)):Pe<=10?(Ue(U,B,U.bl_tree),Ge(U,Pe-3,3)):(Ue(U,V,U.bl_tree),Ge(U,Pe-11,7));Ne=he,tn=(Pe=0)===Ze?(ct=138,3):he===Ze?(ct=6,3):(ct=7,4)}}p(ve);var X=!1;function G(U,se,we,Te){var he,Ne,Ze;Ge(U,(b<<1)+(Te?1:0),3),Ne=se,Ze=we,Fe(he=U),Je(he,Ze),Je(he,~Ze),A.arraySet(he.pending_buf,he.window,Ne,Ze,he.pending),he.pending+=Ze}O._tr_init=function(U){X||(function(){var se,we,Te,he,Ne,Ze=new Array(k+1);for(he=Te=0;he<28;he++)for(ge[he]=Te,se=0;se<1<<z[he];se++)C[Te++]=he;for(C[Te-1]=he,he=Ne=0;he<16;he++)for(ve[he]=Ne,se=0;se<1<<te[he];se++)ae[Ne++]=he;for(Ne>>=7;he<d;he++)for(ve[he]=Ne<<7,se=0;se<1<<te[he]-7;se++)ae[256+Ne++]=he;for(we=0;we<=k;we++)Ze[we]=0;for(se=0;se<=143;)Ce[2*se+1]=8,se++,Ze[8]++;for(;se<=255;)Ce[2*se+1]=9,se++,Ze[9]++;for(;se<=279;)Ce[2*se+1]=7,se++,Ze[7]++;for(;se<=287;)Ce[2*se+1]=8,se++,Ze[8]++;for(Ve(Ce,m+1,Ze),se=0;se<d;se++)$[2*se+1]=5,$[2*se]=qt(se,5);ze=new xe(Ce,z,M+1,m,k),le=new xe($,te,0,d,k),Ae=new xe(new Array(0),ee,0,_,7)}(),X=!0),U.l_desc=new fe(U.dyn_ltree,ze),U.d_desc=new fe(U.dyn_dtree,le),U.bl_desc=new fe(U.bl_tree,Ae),U.bi_buf=0,U.bi_valid=0,Ie(U)},O._tr_stored_block=G,O._tr_flush_block=function(U,se,we,Te){var he,Ne,Ze=0;0<U.level?(2===U.strm.data_type&&(U.strm.data_type=function(Pe){var ct,tn=4093624447;for(ct=0;ct<=31;ct++,tn>>>=1)if(1&tn&&0!==Pe.dyn_ltree[2*ct])return 0;if(0!==Pe.dyn_ltree[18]||0!==Pe.dyn_ltree[20]||0!==Pe.dyn_ltree[26])return 1;for(ct=32;ct<M;ct++)if(0!==Pe.dyn_ltree[2*ct])return 1;return 0}(U)),Ct(U,U.l_desc),Ct(U,U.d_desc),Ze=function(Pe){var ct;for(y(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),y(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),Ct(Pe,Pe.bl_desc),ct=_-1;3<=ct&&0===Pe.bl_tree[2*K[ct]+1];ct--);return Pe.opt_len+=3*(ct+1)+5+5+4,ct}(U),(Ne=U.static_len+3+7>>>3)<=(he=U.opt_len+3+7>>>3)&&(he=Ne)):he=Ne=we+5,we+4<=he&&-1!==se?G(U,se,we,Te):4===U.strategy||Ne===he?(Ge(U,2+(Te?1:0),3),Kt(U,Ce,$)):(Ge(U,4+(Te?1:0),3),function(Pe,ct,tn,Vt){var Vi;for(Ge(Pe,ct-257,5),Ge(Pe,tn-1,5),Ge(Pe,Vt-4,4),Vi=0;Vi<Vt;Vi++)Ge(Pe,Pe.bl_tree[2*K[Vi]+1],3);_e(Pe,Pe.dyn_ltree,ct-1),_e(Pe,Pe.dyn_dtree,tn-1)}(U,U.l_desc.max_code+1,U.d_desc.max_code+1,Ze+1),Kt(U,U.dyn_ltree,U.dyn_dtree)),Ie(U),Te&&Fe(U)},O._tr_tally=function(U,se,we){return U.pending_buf[U.d_buf+2*U.last_lit]=se>>>8&255,U.pending_buf[U.d_buf+2*U.last_lit+1]=255&se,U.pending_buf[U.l_buf+U.last_lit]=255&we,U.last_lit++,0===se?U.dyn_ltree[2*we]++:(U.matches++,se--,U.dyn_ltree[2*(C[we]+M+1)]++,U.dyn_dtree[2*me(se)]++),U.last_lit===U.lit_bufsize-1},O._tr_align=function(U){var se;Ge(U,2,3),Ue(U,W,Ce),16===(se=U).bi_valid?(Je(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}},{"../utils/common":41}],53:[function(N,Y,O){"use strict";Y.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(N,Y,O){(function(A){!function(D,f){"use strict";if(!D.setImmediate){var p,b,x,M,m=1,d={},_=!1,v=D.document,k=Object.getPrototypeOf&&Object.getPrototypeOf(D);k=k&&k.setTimeout?k:D,p="[object process]"==={}.toString.call(D.process)?function(ne){process.nextTick(function(){R(ne)})}:function(){if(D.postMessage&&!D.importScripts){var ne=!0,B=D.onmessage;return D.onmessage=function(){ne=!1},D.postMessage("","*"),D.onmessage=B,ne}}()?(M="setImmediate$"+Math.random()+"$",D.addEventListener?D.addEventListener("message",W,!1):D.attachEvent("onmessage",W),function(ne){D.postMessage(M+ne,"*")}):D.MessageChannel?((x=new MessageChannel).port1.onmessage=function(ne){R(ne.data)},function(ne){x.port2.postMessage(ne)}):v&&"onreadystatechange"in v.createElement("script")?(b=v.documentElement,function(ne){var B=v.createElement("script");B.onreadystatechange=function(){R(ne),B.onreadystatechange=null,b.removeChild(B),B=null},b.appendChild(B)}):function(ne){setTimeout(R,0,ne)},k.setImmediate=function(ne){"function"!=typeof ne&&(ne=new Function(""+ne));for(var B=new Array(arguments.length-1),V=0;V<B.length;V++)B[V]=arguments[V+1];return d[m]={callback:ne,args:B},p(m),m++},k.clearImmediate=w}function w(ne){delete d[ne]}function R(ne){if(_)setTimeout(R,0,ne);else{var B=d[ne];if(B){_=!0;try{!function(V){var z=V.callback,te=V.args;switch(te.length){case 0:z();break;case 1:z(te[0]);break;case 2:z(te[0],te[1]);break;case 3:z(te[0],te[1],te[2]);break;default:z.apply(f,te)}}(B)}finally{w(ne),_=!1}}}}function W(ne){ne.source===D&&"string"==typeof ne.data&&0===ne.data.indexOf(M)&&R(+ne.data.slice(M.length))}}(typeof self>"u"?void 0===A?this:A:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},9263:(Ye,N,Y)=>{var O=Y(9209),A=Y(966);function D(f){this._init(f)}D.prototype={_init:function(f){f=f||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f=A.createBuffer(8,O.TABLE_LENGTH),p=0;p<O.TABLE_LENGTH;p++)f[p]=O.BASE62TABLE.charCodeAt(p);return f},_onData:function(f,p){var b=A.bufferToString_fast(f,p);this._onDataCallback?this._onDataCallback(b):this._result+=b},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var f=2,p=this._data,b=this._offset,x=O.BUFFER_MAX;if(this._dataLen-b<x&&(x=this._dataLen-b),f>x)return!1;var _,v,k,w,R,M=b-O.WINDOW_BUFFER_MAX,m=p.substring(M,b+x),d=b+f-3-M;do{if(2===f){if(v=p.charAt(b)+p.charAt(b+1),!~(k=m.indexOf(v))||k>d)break}else 3===f?v+=p.charAt(b+2):v=p.substr(b,f);if(!~(w=O.STRING_LASTINDEXOF_BUG?p.substring(M,b+f-1).lastIndexOf(v):m.lastIndexOf(v,d)))break;R=w,_=M+w;do{if(p.charCodeAt(b+f)!==p.charCodeAt(_+f))break}while(++f<x);if(k===w){f++;break}}while(++f<x);return 2!==f&&(this._index=O.WINDOW_BUFFER_MAX-R,this._length=f-1,!0)},compress:function(f){if(null==f||0===f.length)return"";var p,b=this._createTable(),x=A.createWindow(),M=A.createBuffer(8,O.COMPRESS_CHUNK_SIZE),m=0;this._result="",this._offset=x.length,this._data=x+f,this._dataLen=this._data.length,x=f=null;for(var v,k,w,R,W,d=-1,_=-1;this._offset<this._dataLen;)this._search()?(this._index<O.BUFFER_MAX?(k=this._index,w=0):w=(this._index-(k=this._index%O.BUFFER_MAX))/O.BUFFER_MAX,2===this._length?(M[m++]=b[w+O.COMPRESS_FIXED_START],M[m++]=b[k]):(M[m++]=b[w+O.COMPRESS_START],M[m++]=b[k],M[m++]=b[this._length]),this._offset+=this._length,~_&&(_=-1)):(v=this._data.charCodeAt(this._offset++))<O.LATIN_BUFFER_MAX?(v<O.UNICODE_CHAR_MAX?(k=v,w=0,d=O.LATIN_INDEX):d=(w=(v-(k=v%O.UNICODE_CHAR_MAX))/O.UNICODE_CHAR_MAX)+O.LATIN_INDEX,_===d?M[m++]=b[k]:(M[m++]=b[d-O.LATIN_INDEX_START],M[m++]=b[k],_=d)):(v<O.UNICODE_BUFFER_MAX?(k=v,w=0,d=O.UNICODE_INDEX):d=(w=(v-(k=v%O.UNICODE_BUFFER_MAX))/O.UNICODE_BUFFER_MAX)+O.UNICODE_INDEX,k<O.UNICODE_CHAR_MAX?(R=k,W=0):W=(k-(R=k%O.UNICODE_CHAR_MAX))/O.UNICODE_CHAR_MAX,_===d?(M[m++]=b[R],M[m++]=b[W]):(M[m++]=b[O.CHAR_START],M[m++]=b[d-O.TABLE_LENGTH],M[m++]=b[R],M[m++]=b[W],_=d)),m>=O.COMPRESS_CHUNK_MAX&&(this._onData(M,m),m=0);return m>0&&this._onData(M,m),this._onEnd(),p=this._result,this._result=null,null===p?"":p}},Ye.exports=D},9209:(Ye,N)=>{var Y=N.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",O=!1,A=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(O=!0)}catch{}if(Y)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(A=!0)}catch{}N.CAN_CHARCODE_APPLY=O,N.CAN_CHARCODE_APPLY_TYPED=A;var D=N.APPLY_BUFFER_SIZE=65533;N.APPLY_BUFFER_SIZE_OK=null;var f=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(f=!0),N.STRING_LASTINDEXOF_BUG=f;var p=N.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=N.TABLE_LENGTH=p.length,x=Math.max(b,62)-Math.min(b,62);N.BUFFER_MAX=b-1;var M=N.WINDOW_MAX=1024;N.WINDOW_BUFFER_MAX=304;var m=N.COMPRESS_CHUNK_SIZE=D;N.COMPRESS_CHUNK_MAX=m-b;var d=N.DECOMPRESS_CHUNK_SIZE=D;N.DECOMPRESS_CHUNK_MAX=d+2*M,N.LATIN_BUFFER_MAX=132;var v=N.UNICODE_CHAR_MAX=40;N.UNICODE_BUFFER_MAX=v*(v+1),N.LATIN_INDEX=b+1,N.LATIN_INDEX_START=x+20,N.UNICODE_INDEX=b+5,N.DECODE_MAX=b-x-19;var k=N.LATIN_DECODE_MAX=v+7,w=N.CHAR_START=k+1,R=N.COMPRESS_START=w+1,W=N.COMPRESS_FIXED_START=R+5;N.COMPRESS_INDEX=W+5},9727:(Ye,N,Y)=>{var O=Y(9209),A=Y(966);function D(f){this._init(f)}D.prototype={_init:function(f){f=f||{},this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f={},p=0;p<O.TABLE_LENGTH;p++)f[O.BASE62TABLE.charAt(p)]=p;return f},_onData:function(f){var p;if(this._onDataCallback){if(f)p=this._result,this._result=[];else{var b=O.DECOMPRESS_CHUNK_SIZE-O.WINDOW_MAX;p=this._result.slice(O.WINDOW_MAX,O.WINDOW_MAX+b),this._result=this._result.slice(0,O.WINDOW_MAX).concat(this._result.slice(O.WINDOW_MAX+b))}p.length>0&&this._onDataCallback(A.bufferToString_fast(p))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(f){if(null==f||0===f.length)return"";this._result=A.stringToArray(A.createWindow());for(var p,_,v,k,R,W,ne,B,V,z,b=this._createTable(),x=!1,M=null,m=f.length,d=0;d<m;d++)if(void 0!==(v=b[f.charAt(d)])){if(v<O.DECODE_MAX)R=x?b[f.charAt(++d)]*O.UNICODE_CHAR_MAX+v+O.UNICODE_BUFFER_MAX*M:M*O.UNICODE_CHAR_MAX+v,this._result[this._result.length]=R;else if(v<O.LATIN_DECODE_MAX)M=v-O.DECODE_MAX,x=!1;else if(v===O.CHAR_START)M=(k=b[f.charAt(++d)])-5,x=!0;else if(v<O.COMPRESS_INDEX){if(k=b[f.charAt(++d)],v<O.COMPRESS_FIXED_START?(W=(v-O.COMPRESS_START)*O.BUFFER_MAX+k,ne=b[f.charAt(++d)]):(W=(v-O.COMPRESS_FIXED_START)*O.BUFFER_MAX+k,ne=2),(B=this._result.slice(-W)).length>ne&&(B.length=ne),V=B.length,B.length>0)for(z=0;z<ne;)for(_=0;_<V&&(this._result[this._result.length]=B[_],!(++z>=ne));_++);M=null}this._result.length>=O.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(O.WINDOW_MAX),this._onData(!0),this._onEnd(),p=A.bufferToString_fast(this._result),this._result=null,p}},Ye.exports=D},8497:(Ye,N,Y)=>{var O=Y(9263),A=Y(9727);Y(1014),N.n=function(D,f){return new O(f).compress(D)},N.L=function(D,f){return new A(f).decompress(D)}},966:(Ye,N,Y)=>{var O=Y(9209),A=String.fromCharCode;N.createBuffer=function(b,x){if(!O.HAS_TYPED)return new Array(x);switch(b){case 8:return new Uint8Array(x);case 16:return new Uint16Array(x)}};var D=N.truncateBuffer=function(b,x){return b.length===x?b:b.subarray?b.subarray(0,x):(b.length=x,b)};N.bufferToString_fast=function(b,x){if(null==x?x=b.length:b=D(b,x),O.CAN_CHARCODE_APPLY&&O.CAN_CHARCODE_APPLY_TYPED){var M=b.length;if(M<O.APPLY_BUFFER_SIZE&&O.APPLY_BUFFER_SIZE_OK)return A.apply(null,b);if(null===O.APPLY_BUFFER_SIZE_OK)try{var m=A.apply(null,b);return M>O.APPLY_BUFFER_SIZE&&(O.APPLY_BUFFER_SIZE_OK=!0),m}catch{O.APPLY_BUFFER_SIZE_OK=!1}}return f(b)};var f=N.bufferToString_chunked=function(b){for(var d,x="",M=b.length,m=0;m<M;){if(d=b.subarray?b.subarray(m,m+O.APPLY_BUFFER_SIZE):b.slice(m,m+O.APPLY_BUFFER_SIZE),m+=O.APPLY_BUFFER_SIZE,!O.APPLY_BUFFER_SIZE_OK){if(null===O.APPLY_BUFFER_SIZE_OK)try{x+=A.apply(null,d),d.length>O.APPLY_BUFFER_SIZE&&(O.APPLY_BUFFER_SIZE_OK=!0);continue}catch{O.APPLY_BUFFER_SIZE_OK=!1}return p(b)}x+=A.apply(null,d)}return x},p=N.bufferToString_slow=function(b){for(var x="",M=b.length,m=0;m<M;m++)x+=A(b[m]);return x};N.stringToArray=function(b){for(var x=[],M=b&&b.length,m=0;m<M;m++)x[m]=b.charCodeAt(m);return x},N.createWindow=function(){for(var b=O.WINDOW_MAX>>7,x="        ";!(b&O.WINDOW_MAX);)x+=x,b<<=1;return x}},2391:(Ye,N,Y)=>{N.encode=Y(8048).encode,N.decode=Y(9175).decode,Y(7704),Y(8131),Y(1490),Y(9234)},2295:function(Ye){function N(Y){return Y&&Y.isBuffer&&Y}Ye.exports=N(typeof Buffer<"u"&&Buffer)||N(this.Buffer)||N(typeof window<"u"&&window.Buffer)||this.Buffer},7625:(Ye,N)=>{N.copy=function D(f,p,b,x){var M;b||(b=0),!x&&0!==x&&(x=this.length),p||(p=0);var m=x-b;if(f===this&&b<p&&p<x)for(M=m-1;M>=0;M--)f[M+p]=this[M+b];else for(M=0;M<m;M++)f[M+p]=this[M+b];return m},N.toString=function A(f,p,b){var x=this,M=0|p;b||(b=x.length);for(var m="",d=0;M<b;)(d=x[M++])<128?m+=String.fromCharCode(d):(192==(224&d)?d=(31&d)<<6|63&x[M++]:224==(240&d)?d=(15&d)<<12|(63&x[M++])<<6|63&x[M++]:240==(248&d)&&(d=(7&d)<<18|(63&x[M++])<<12|(63&x[M++])<<6|63&x[M++]),d>=65536?(d-=65536,m+=String.fromCharCode(55296+(d>>>10),56320+(1023&d))):m+=String.fromCharCode(d));return m},N.write=function O(f,p){for(var b=this,x=p||(p|=0),M=f.length,m=0,d=0;d<M;)(m=f.charCodeAt(d++))<128?b[x++]=m:m<2048?(b[x++]=192|m>>>6,b[x++]=128|63&m):m<55296||m>57343?(b[x++]=224|m>>>12,b[x++]=128|m>>>6&63,b[x++]=128|63&m):(m=65536+(m-55296<<10|f.charCodeAt(d++)-56320),b[x++]=240|m>>>18,b[x++]=128|m>>>12&63,b[x++]=128|m>>>6&63,b[x++]=128|63&m);return x-p}},1864:(Ye,N,Y)=>{var O=Y(6093),A=Ye.exports=D(0);function D(p){return new Array(p)}A.alloc=D,A.concat=O.concat,A.from=function f(p){if(!O.isBuffer(p)&&O.isView(p))p=O.Uint8Array.from(p);else if(O.isArrayBuffer(p))p=new Uint8Array(p);else{if("string"==typeof p)return O.from.call(A,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(p)}},1884:(Ye,N,Y)=>{var O=Y(6093),A=O.global,D=Ye.exports=O.hasBuffer?f(0):[];function f(b){return new A(b)}D.alloc=O.hasBuffer&&A.alloc||f,D.concat=O.concat,D.from=function p(b){if(!O.isBuffer(b)&&O.isView(b))b=O.Uint8Array.from(b);else if(O.isArrayBuffer(b))b=new Uint8Array(b);else{if("string"==typeof b)return O.from.call(D,b);if("number"==typeof b)throw new TypeError('"value" argument must not be a number')}return A.from&&1!==A.from.length?A.from(b):new A(b)}},5364:(Ye,N,Y)=>{var O=Y(7625);N.copy=b,N.slice=x,N.toString=function M(d,_,v){return(!f&&A.isBuffer(this)?this.toString:O.toString).apply(this,arguments)},N.write=function m(d){return function _(){return(this[d]||O[d]).apply(this,arguments)}}("write");var A=Y(6093),D=A.global,f=A.hasBuffer&&"TYPED_ARRAY_SUPPORT"in D,p=f&&!D.TYPED_ARRAY_SUPPORT;function b(d,_,v,k){var w=A.isBuffer(this),R=A.isBuffer(d);if(w&&R)return this.copy(d,_,v,k);if(p||w||R||!A.isView(this)||!A.isView(d))return O.copy.call(this,d,_,v,k);var W=v||null!=k?x.call(this,v,k):this;return d.set(W,_),W.length}function x(d,_){var v=this.slice||!p&&this.subarray;if(v)return v.call(this,d,_);var k=A.alloc.call(this,_-d);return b.call(this,k,0,d,_),k}},5321:(Ye,N,Y)=>{var O=Y(6093),A=Ye.exports=O.hasArrayBuffer?D(0):[];function D(p){return new Uint8Array(p)}A.alloc=D,A.concat=O.concat,A.from=function f(p){if(O.isView(p)){var b=p.byteOffset,x=p.byteLength;(p=p.buffer).byteLength!==x&&(p.slice?p=p.slice(b,b+x):(p=new Uint8Array(p)).byteLength!==x&&(p=Array.prototype.slice.call(p,b,b+x)))}else{if("string"==typeof p)return O.from.call(A,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(p)}},6093:(Ye,N,Y)=>{var O=N.global=Y(2295),A=N.hasBuffer=O&&!!O.isBuffer,D=N.hasArrayBuffer=typeof ArrayBuffer<"u",f=N.isArray=Y(6425);N.isArrayBuffer=D?function R(z){return z instanceof ArrayBuffer||w(z)}:B;var p=N.isBuffer=A?O.isBuffer:B,b=N.isView=D?ArrayBuffer.isView||V("ArrayBuffer","buffer"):B;N.alloc=v,N.concat=function k(z,te){te||(te=0,Array.prototype.forEach.call(z,function $(C){te+=C.length}));var K=v.call(this!==N&&this||z[0],te),Ce=0;return Array.prototype.forEach.call(z,function ae(C){Ce+=d.copy.call(C,K,Ce)}),K},N.from=function _(z){return"string"==typeof z?W.call(this,z):ne(this).from(z)};var x=N.Array=Y(1864),M=N.Buffer=Y(1884),m=N.Uint8Array=Y(5321),d=N.prototype=Y(5364);function v(z){return ne(this).alloc(z)}var w=V("ArrayBuffer");function W(z){var te=3*z.length,ee=v.call(this,te),K=d.write.call(ee,z);return te!==K&&(ee=d.slice.call(ee,0,K)),ee}function ne(z){return p(z)?M:b(z)?m:f(z)?x:A?M:D?m:x}function B(){return!1}function V(z,te){return z="[object "+z+"]",function(ee){return null!=ee&&{}.toString.call(te?ee[te]:ee)===z}}},5166:(Ye,N,Y)=>{var O=Y(6425);N.createCodec=M,N.install=function f(m){for(var d in m)D.prototype[d]=p(D.prototype[d],m[d])},N.filter=function x(m){return O(m)?function b(m){return m=m.slice(),function(_){return m.reduce(d,_)};function d(_,v){return v(_)}}(m):m};var A=Y(6093);function D(m){if(!(this instanceof D))return new D(m);this.options=m,this.init()}function p(m,d){return m&&d?function _(){return m.apply(this,arguments),d.apply(this,arguments)}:m||d}function M(m){return new D(m)}D.prototype.init=function(){var m=this.options;return m&&m.uint8array&&(this.bufferish=A.Uint8Array),this},N.preset=M({preset:!0})},9234:(Ye,N,Y)=>{Y(8334),Y(2732),Y(5166)},5333:(Ye,N,Y)=>{N.T=D;var O=Y(8334).preset;function D(f){if(!(this instanceof D))return new D(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}Y(6473).k.mixin(D.prototype),D.prototype.codec=O,D.prototype.fetch=function(){return this.codec.decode(this)}},9175:(Ye,N,Y)=>{N.decode=function A(D,f){var p=new O(f);return p.write(D),p.read()};var O=Y(5333).T},8131:(Ye,N,Y)=>{var A=Y(6654),D=Y(5333).T;function f(p){if(!(this instanceof f))return new f(p);D.call(this,p)}f.prototype=new D,A.mixin(f.prototype),f.prototype.decode=function(p){arguments.length&&this.write(p),this.flush()},f.prototype.push=function(p){this.emit("data",p)},f.prototype.end=function(p){this.decode(p),this.emit("end")}},8400:(Ye,N,Y)=>{N.F=D;var O=Y(2732).preset;function D(f){if(!(this instanceof D))return new D(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}Y(6473).I.mixin(D.prototype),D.prototype.codec=O,D.prototype.write=function(f){this.codec.encode(this,f)}},8048:(Ye,N,Y)=>{N.encode=function A(D,f){var p=new O(f);return p.write(D),p.read()};var O=Y(8400).F},7704:(Ye,N,Y)=>{var A=Y(6654),D=Y(8400).F;function f(p){if(!(this instanceof f))return new f(p);D.call(this,p)}f.prototype=new D,A.mixin(f.prototype),f.prototype.encode=function(p){this.write(p),this.emit("data",this.read())},f.prototype.end=function(p){arguments.length&&this.encode(p),this.flush(),this.emit("end")}},7846:(Ye,N,Y)=>{N.S=function A(D,f){if(!(this instanceof A))return new A(D,f);this.buffer=O.from(D),this.type=f};var O=Y(6093)},4106:(Ye,N,Y)=>{N.setExtPackers=function b(_){_.addExtPacker(14,Error,[d,x]),_.addExtPacker(1,EvalError,[d,x]),_.addExtPacker(2,RangeError,[d,x]),_.addExtPacker(3,ReferenceError,[d,x]),_.addExtPacker(4,SyntaxError,[d,x]),_.addExtPacker(5,TypeError,[d,x]),_.addExtPacker(6,URIError,[d,x]),_.addExtPacker(10,RegExp,[m,x]),_.addExtPacker(11,Boolean,[M,x]),_.addExtPacker(12,String,[M,x]),_.addExtPacker(13,Date,[Number,x]),_.addExtPacker(15,Number,[M,x]),typeof Uint8Array<"u"&&(_.addExtPacker(17,Int8Array,D),_.addExtPacker(18,Uint8Array,D),_.addExtPacker(19,Int16Array,D),_.addExtPacker(20,Uint16Array,D),_.addExtPacker(21,Int32Array,D),_.addExtPacker(22,Uint32Array,D),_.addExtPacker(23,Float32Array,D),typeof Float64Array<"u"&&_.addExtPacker(24,Float64Array,D),typeof Uint8ClampedArray<"u"&&_.addExtPacker(25,Uint8ClampedArray,D),_.addExtPacker(26,ArrayBuffer,D),_.addExtPacker(29,DataView,D)),O.hasBuffer&&_.addExtPacker(27,A,O.from)};var f,O=Y(6093),A=O.global,D=O.Uint8Array.from,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function x(_){return f||(f=Y(8048).encode),f(_)}function M(_){return _.valueOf()}function m(_){(_=RegExp.prototype.toString.call(_).split("/")).shift();var v=[_.pop()];return v.unshift(_.join("/")),v}function d(_){var v={};for(var k in p)v[k]=_[k];return v}},9146:(Ye,N,Y)=>{N.setExtUnpackers=function p(_){_.addExtUnpacker(14,[b,M(Error)]),_.addExtUnpacker(1,[b,M(EvalError)]),_.addExtUnpacker(2,[b,M(RangeError)]),_.addExtUnpacker(3,[b,M(ReferenceError)]),_.addExtUnpacker(4,[b,M(SyntaxError)]),_.addExtUnpacker(5,[b,M(TypeError)]),_.addExtUnpacker(6,[b,M(URIError)]),_.addExtUnpacker(10,[b,x]),_.addExtUnpacker(11,[b,m(Boolean)]),_.addExtUnpacker(12,[b,m(String)]),_.addExtUnpacker(13,[b,m(Date)]),_.addExtUnpacker(15,[b,m(Number)]),typeof Uint8Array<"u"&&(_.addExtUnpacker(17,m(Int8Array)),_.addExtUnpacker(18,m(Uint8Array)),_.addExtUnpacker(19,[d,m(Int16Array)]),_.addExtUnpacker(20,[d,m(Uint16Array)]),_.addExtUnpacker(21,[d,m(Int32Array)]),_.addExtUnpacker(22,[d,m(Uint32Array)]),_.addExtUnpacker(23,[d,m(Float32Array)]),typeof Float64Array<"u"&&_.addExtUnpacker(24,[d,m(Float64Array)]),typeof Uint8ClampedArray<"u"&&_.addExtUnpacker(25,m(Uint8ClampedArray)),_.addExtUnpacker(26,d),_.addExtUnpacker(29,[d,m(DataView)])),O.hasBuffer&&_.addExtUnpacker(27,m(A))};var D,O=Y(6093),A=O.global,f={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function b(_){return D||(D=Y(9175).decode),D(_)}function x(_){return RegExp.apply(null,_)}function M(_){return function(v){var k=new _;for(var w in f)k[w]=v[w];return k}}function m(_){return function(v){return new _(v)}}function d(_){return new Uint8Array(_).buffer}},1490:(Ye,N,Y)=>{Y(8334),Y(2732),Y(5166)},6473:(Ye,N,Y)=>{N.k=p,N.I=b;var O=Y(6093),f="BUFFER_SHORTAGE";function p(){if(!(this instanceof p))return new p}function b(){if(!(this instanceof b))return new b}function m(){throw new Error("method not implemented: write()")}function d(){throw new Error("method not implemented: fetch()")}function _(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function v(R){(this.buffers||(this.buffers=[])).push(R)}function k(){return(this.buffers||(this.buffers=[])).shift()}function w(R){return function W(ne){for(var B in R)ne[B]=R[B];return ne}}p.mixin=w(function x(){return{bufferish:O,write:function R(B){var V=this.offset?O.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=V?B?this.bufferish.concat([V,B]):V:B,this.offset=0},fetch:d,flush:function W(){for(;this.offset<this.buffer.length;){var V,B=this.offset;try{V=this.fetch()}catch(z){if(z&&z.message!=f)throw z;this.offset=B;break}this.push(V)}},push:v,pull:k,read:_,reserve:function ne(B){var V=this.offset,z=V+B;if(z>this.buffer.length)throw new Error(f);return this.offset=z,V},offset:0}}()),p.mixin(p.prototype),b.mixin=w(function M(){return{bufferish:O,write:m,fetch:function R(){var z=this.start;if(z<this.offset){var te=this.start=this.offset;return O.prototype.slice.call(this.buffer,z,te)}},flush:function W(){for(;this.start<this.offset;){var z=this.fetch();z&&this.push(z)}},push:v,pull:function ne(){var z=this.buffers||(this.buffers=[]),te=z.length>1?this.bufferish.concat(z):z[0];return z.length=0,te},read:_,reserve:function B(z){var te=0|z;if(this.buffer){var ee=this.buffer.length,K=0|this.offset,Ce=K+te;if(Ce<ee)return this.offset=Ce,K;this.flush(),z=Math.max(z,Math.min(2*ee,this.maxBufferSize))}return z=Math.max(z,this.minBufferSize),this.buffer=this.bufferish.alloc(z),this.start=0,this.offset=te,0},send:function V(z){var te=z.length;if(te>this.minBufferSize)this.flush(),this.push(z);else{var ee=this.reserve(te);O.prototype.copy.call(z,this.buffer,ee)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),b.mixin(b.prototype)},8334:(Ye,N,Y)=>{var O=Y(7846).S,A=Y(9146),D=Y(4613).readUint8,f=Y(1788),p=Y(5166);function x(){var d=this.options;return this.decode=function b(d){var _=f.getReadToken(d);return function v(k){var w=D(k),R=_[w];if(!R)throw new Error("Invalid type: "+(w&&"0x"+w.toString(16)));return R(k)}}(d),d&&d.preset&&A.setExtUnpackers(this),this}p.install({addExtUnpacker:function M(d,_){(this.extUnpackers||(this.extUnpackers=[]))[d]=p.filter(_)},getExtUnpacker:function m(d){return(this.extUnpackers||(this.extUnpackers=[]))[d]||function v(k){return new O(k,d)}},init:x}),N.preset=x.call(p.preset)},4613:(Ye,N,Y)=>{var O=Y(8461),A=Y(6256),D=A.Uint64BE,f=A.Int64BE;N.getReadFormat=function m(le){var ve=le&&le.int64;return{map:x&&le&&le.usemap?_:d,array:v,str:k,bin:p.hasArrayBuffer&&le&&le.binarraybuffer?R:w,ext:W,uint8:ne,uint16:V,uint32:te,uint64:K(8,ve?ae:Ce),int8:B,int16:z,int32:ee,int64:K(8,ve?C:$),float32:K(4,ge),float64:K(8,ze)}},N.readUint8=ne;var p=Y(6093),b=Y(5364),x=typeof Map<"u",M=!0;function d(le,Ae){var xe,ve={},fe=new Array(Ae),me=new Array(Ae),Je=le.codec.decode;for(xe=0;xe<Ae;xe++)fe[xe]=Je(le),me[xe]=Je(le);for(xe=0;xe<Ae;xe++)ve[fe[xe]]=me[xe];return ve}function _(le,Ae){var xe,ve=new Map,fe=new Array(Ae),me=new Array(Ae),Je=le.codec.decode;for(xe=0;xe<Ae;xe++)fe[xe]=Je(le),me[xe]=Je(le);for(xe=0;xe<Ae;xe++)ve.set(fe[xe],me[xe]);return ve}function v(le,Ae){for(var ve=new Array(Ae),xe=le.codec.decode,fe=0;fe<Ae;fe++)ve[fe]=xe(le);return ve}function k(le,Ae){var ve=le.reserve(Ae);return b.toString.call(le.buffer,"utf-8",ve,ve+Ae)}function w(le,Ae){var ve=le.reserve(Ae),fe=b.slice.call(le.buffer,ve,ve+Ae);return p.from(fe)}function R(le,Ae){var ve=le.reserve(Ae),fe=b.slice.call(le.buffer,ve,ve+Ae);return p.Uint8Array.from(fe).buffer}function W(le,Ae){var ve=le.reserve(Ae+1),xe=le.buffer[ve++],fe=ve+Ae,me=le.codec.getExtUnpacker(xe);if(!me)throw new Error("Invalid ext type: "+(xe&&"0x"+xe.toString(16)));return me(b.slice.call(le.buffer,ve,fe))}function ne(le){var Ae=le.reserve(1);return le.buffer[Ae]}function B(le){var Ae=le.reserve(1),ve=le.buffer[Ae];return 128&ve?ve-256:ve}function V(le){var Ae=le.reserve(2),ve=le.buffer;return ve[Ae++]<<8|ve[Ae]}function z(le){var Ae=le.reserve(2),ve=le.buffer,xe=ve[Ae++]<<8|ve[Ae];return 32768&xe?xe-65536:xe}function te(le){var Ae=le.reserve(4),ve=le.buffer;return 16777216*ve[Ae++]+(ve[Ae++]<<16)+(ve[Ae++]<<8)+ve[Ae]}function ee(le){var Ae=le.reserve(4),ve=le.buffer;return ve[Ae++]<<24|ve[Ae++]<<16|ve[Ae++]<<8|ve[Ae]}function K(le,Ae){return function(ve){var xe=ve.reserve(le);return Ae.call(ve.buffer,xe,M)}}function Ce(le){return new D(this,le).toNumber()}function $(le){return new f(this,le).toNumber()}function ae(le){return new D(this,le)}function C(le){return new f(this,le)}function ge(le){return O.read(this,le,!1,23,4)}function ze(le){return O.read(this,le,!1,52,8)}},1788:(Ye,N,Y)=>{var O=Y(4613);function D(M){var m,d=new Array(256);for(m=0;m<=127;m++)d[m]=p(m);for(m=128;m<=143;m++)d[m]=x(m-128,M.map);for(m=144;m<=159;m++)d[m]=x(m-144,M.array);for(m=160;m<=191;m++)d[m]=x(m-160,M.str);for(d[192]=p(null),d[193]=null,d[194]=p(!1),d[195]=p(!0),d[196]=b(M.uint8,M.bin),d[197]=b(M.uint16,M.bin),d[198]=b(M.uint32,M.bin),d[199]=b(M.uint8,M.ext),d[200]=b(M.uint16,M.ext),d[201]=b(M.uint32,M.ext),d[202]=M.float32,d[203]=M.float64,d[204]=M.uint8,d[205]=M.uint16,d[206]=M.uint32,d[207]=M.uint64,d[208]=M.int8,d[209]=M.int16,d[210]=M.int32,d[211]=M.int64,d[212]=x(1,M.ext),d[213]=x(2,M.ext),d[214]=x(4,M.ext),d[215]=x(8,M.ext),d[216]=x(16,M.ext),d[217]=b(M.uint8,M.str),d[218]=b(M.uint16,M.str),d[219]=b(M.uint32,M.str),d[220]=b(M.uint16,M.array),d[221]=b(M.uint32,M.array),d[222]=b(M.uint16,M.map),d[223]=b(M.uint32,M.map),m=224;m<=255;m++)d[m]=p(m-256);return d}function p(M){return function(){return M}}function b(M,m){return function(d){var _=M(d);return m(d,_)}}function x(M,m){return function(d){return m(d,M)}}N.getReadToken=function A(M){var m=O.getReadFormat(M);return M&&M.useraw?function f(M){var m,d=D(M).slice();for(d[217]=d[196],d[218]=d[197],d[219]=d[198],m=160;m<=191;m++)d[m]=x(m-160,M.bin);return d}(m):D(m)}},2732:(Ye,N,Y)=>{var O=Y(7846).S,A=Y(4106),D=Y(9118),f=Y(5166);function b(){var m=this.options;return this.encode=function p(m){var d=D.getWriteType(m);return function _(v,k){var w=d[typeof k];if(!w)throw new Error('Unsupported type "'+typeof k+'": '+k);w(v,k)}}(m),m&&m.preset&&A.setExtPackers(this),this}f.install({addExtPacker:function x(m,d,_){_=f.filter(_);var v=d.name;function R(W){return _&&(W=_(W)),new O(W,m)}v&&"Object"!==v?(this.extPackers||(this.extPackers={}))[v]=R:(this.extEncoderList||(this.extEncoderList=[])).unshift([d,R])},getExtPacker:function M(m){var d=this.extPackers||(this.extPackers={}),_=m.constructor,v=_&&_.name&&d[_.name];if(v)return v;for(var k=this.extEncoderList||(this.extEncoderList=[]),w=k.length,R=0;R<w;R++){var W=k[R];if(_===W[0])return W[1]}},init:b}),N.preset=b.call(f.preset)},3041:(Ye,N,Y)=>{var O=Y(8461),A=Y(6256),D=A.Uint64BE,f=A.Int64BE,p=Y(8323).w,b=Y(6093),x=b.global,m=b.hasBuffer&&"TYPED_ARRAY_SUPPORT"in x&&!x.TYPED_ARRAY_SUPPORT,d=b.hasBuffer&&x.prototype||{};function k(){var K=p.slice();return K[196]=R(196),K[197]=W(197),K[198]=ne(198),K[199]=R(199),K[200]=W(200),K[201]=ne(201),K[202]=B(202,4,d.writeFloatBE||te,!0),K[203]=B(203,8,d.writeDoubleBE||ee,!0),K[204]=R(204),K[205]=W(205),K[206]=ne(206),K[207]=B(207,8,V),K[208]=R(208),K[209]=W(209),K[210]=ne(210),K[211]=B(211,8,z),K[217]=R(217),K[218]=W(218),K[219]=ne(219),K[220]=W(220),K[221]=ne(221),K[222]=W(222),K[223]=ne(223),K}function R(K){return function(Ce,$){var ae=Ce.reserve(2),C=Ce.buffer;C[ae++]=K,C[ae]=$}}function W(K){return function(Ce,$){var ae=Ce.reserve(3),C=Ce.buffer;C[ae++]=K,C[ae++]=$>>>8,C[ae]=$}}function ne(K){return function(Ce,$){var ae=Ce.reserve(5),C=Ce.buffer;C[ae++]=K,C[ae++]=$>>>24,C[ae++]=$>>>16,C[ae++]=$>>>8,C[ae]=$}}function B(K,Ce,$,ae){return function(C,ge){var ze=C.reserve(Ce+1);C.buffer[ze++]=K,$.call(C.buffer,ge,ze,ae)}}function V(K,Ce){new D(this,Ce,K)}function z(K,Ce){new f(this,Ce,K)}function te(K,Ce){O.write(this,K,Ce,!1,23,4)}function ee(K,Ce){O.write(this,K,Ce,!1,52,8)}N.getWriteToken=function _(K){return K&&K.uint8array?function v(){var K=k();return K[202]=B(202,4,te),K[203]=B(203,8,ee),K}():m||b.hasBuffer&&K&&K.safe?function w(){var K=p.slice();return K[196]=B(196,1,x.prototype.writeUInt8),K[197]=B(197,2,x.prototype.writeUInt16BE),K[198]=B(198,4,x.prototype.writeUInt32BE),K[199]=B(199,1,x.prototype.writeUInt8),K[200]=B(200,2,x.prototype.writeUInt16BE),K[201]=B(201,4,x.prototype.writeUInt32BE),K[202]=B(202,4,x.prototype.writeFloatBE),K[203]=B(203,8,x.prototype.writeDoubleBE),K[204]=B(204,1,x.prototype.writeUInt8),K[205]=B(205,2,x.prototype.writeUInt16BE),K[206]=B(206,4,x.prototype.writeUInt32BE),K[207]=B(207,8,V),K[208]=B(208,1,x.prototype.writeInt8),K[209]=B(209,2,x.prototype.writeInt16BE),K[210]=B(210,4,x.prototype.writeInt32BE),K[211]=B(211,8,z),K[217]=B(217,1,x.prototype.writeUInt8),K[218]=B(218,2,x.prototype.writeUInt16BE),K[219]=B(219,4,x.prototype.writeUInt32BE),K[220]=B(220,2,x.prototype.writeUInt16BE),K[221]=B(221,4,x.prototype.writeUInt32BE),K[222]=B(222,2,x.prototype.writeUInt16BE),K[223]=B(223,4,x.prototype.writeUInt32BE),K}():k()}},9118:(Ye,N,Y)=>{var O=Y(6425),A=Y(6256),D=A.Uint64BE,f=A.Int64BE,p=Y(6093),b=Y(5364),x=Y(3041),M=Y(8323).w,m=Y(7846).S,d=typeof Uint8Array<"u",_=typeof Map<"u",v=[];v[1]=212,v[2]=213,v[4]=214,v[8]=215,v[16]=216,N.getWriteType=function k(w){var R=x.getWriteToken(w),W=w&&w.useraw,ne=d&&w&&w.binarraybuffer,B=ne?p.isArrayBuffer:p.isBuffer,V=ne?function me(Ve,Ie){fe(Ve,new Uint8Array(Ie))}:fe,te=_&&w&&w.usemap?function Ue(Ve,Ie){if(!(Ie instanceof Map))return Ge(Ve,Ie);var Fe=Ie.size;R[Fe<16?128+Fe:Fe<=65535?222:223](Ve,Fe);var nt=Ve.codec.encode;Ie.forEach(function(Kt,Ct,y){nt(Ve,Ct),nt(Ve,Kt)})}:Ge;return{boolean:function K(Ve,Ie){R[Ie?195:194](Ve,Ie)},function:ve,number:function Ce(Ve,Ie){var Fe=0|Ie;Ie===Fe?R[-32<=Fe&&Fe<=127?255&Fe:0<=Fe?Fe<=255?204:Fe<=65535?205:206:-128<=Fe?208:-32768<=Fe?209:210](Ve,Fe):R[203](Ve,Ie)},object:W?function Ae(Ve,Ie){if(B(Ie))return function qt(Ve,Ie){var Fe=Ie.length;R[Fe<32?160+Fe:Fe<=65535?218:219](Ve,Fe),Ve.send(Ie)}(Ve,Ie);le(Ve,Ie)}:le,string:function ze(Ve){return function Ie(Fe,pt){var nt=pt.length;Fe.offset=Fe.reserve(5+3*nt);var Ct=Fe.buffer,y=Ve(nt),_e=Fe.offset+y;nt=b.write.call(Ct,pt,_e);var X=Ve(nt);y!==X&&b.copy.call(Ct,Ct,_e+X-y,_e,_e+nt),R[1===X?160+nt:X<=3?215+X:219](Fe,nt),Fe.offset+=nt}}(W?function ge(Ve){return Ve<32?1:Ve<=65535?3:5}:function C(Ve){return Ve<32?1:Ve<=255?2:Ve<=65535?3:5}),symbol:ve,undefined:ve};function le(Ve,Ie){if(null===Ie)return ve(Ve,Ie);if(B(Ie))return V(Ve,Ie);if(O(Ie))return function xe(Ve,Ie){var Fe=Ie.length;R[Fe<16?144+Fe:Fe<=65535?220:221](Ve,Fe);for(var nt=Ve.codec.encode,Kt=0;Kt<Fe;Kt++)nt(Ve,Ie[Kt])}(Ve,Ie);if(D.isUint64BE(Ie))return function $(Ve,Ie){R[207](Ve,Ie.toArray())}(Ve,Ie);if(f.isInt64BE(Ie))return function ae(Ve,Ie){R[211](Ve,Ie.toArray())}(Ve,Ie);var Fe=Ve.codec.getExtPacker(Ie);if(Fe&&(Ie=Fe(Ie)),Ie instanceof m)return function Je(Ve,Ie){var Fe=Ie.buffer,pt=Fe.length;R[v[pt]||(pt<255?199:pt<=65535?200:201)](Ve,pt),M[Ie.type](Ve),Ve.send(Fe)}(Ve,Ie);te(Ve,Ie)}function ve(Ve,Ie){R[192](Ve,Ie)}function fe(Ve,Ie){var Fe=Ie.length;R[Fe<255?196:Fe<=65535?197:198](Ve,Fe),Ve.send(Ie)}function Ge(Ve,Ie){var Fe=Object.keys(Ie),pt=Fe.length;R[pt<16?128+pt:pt<=65535?222:223](Ve,pt);var Kt=Ve.codec.encode;Fe.forEach(function(Ct){Kt(Ve,Ct),Kt(Ve,Ie[Ct])})}}},8323:(Ye,N)=>{for(var Y=N.w=new Array(256),O=0;O<=255;O++)Y[O]=A(O);function A(D){return function(f){var p=f.reserve(1);f.buffer[p]=D}}},1203:Ye=>{function N(D){var f="    ";if(isNaN(parseInt(D)))f=D;else switch(D){case 1:f=" ";break;case 2:f="  ";break;case 3:f="   ";break;case 4:f="    ";break;case 5:f="     ";break;case 6:f="      ";break;case 7:f="       ";break;case 8:f="        ";break;case 9:f="         ";break;case 10:f="          ";break;case 11:f="           ";break;case 12:f="            "}for(var p=["\n"],b=0;b<100;b++)p.push(p[b]+f);return p}function Y(){this.step="    ",this.shift=N(this.step)}function O(D,f){return f-(D.replace(/\(/g,"").length-D.replace(/\)/g,"").length)}function A(D,f){return D.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+f+f+"AND ").replace(/ BETWEEN /gi,"~::~"+f+"BETWEEN ").replace(/ CASE /gi,"~::~"+f+"CASE ").replace(/ ELSE /gi,"~::~"+f+"ELSE ").replace(/ END /gi,"~::~"+f+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+f+"ON ").replace(/ OR /gi,"~::~"+f+f+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+f+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+f).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+f+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}Y.prototype.xml=function(D,f){var p=D.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),b=p.length,x=!1,M=0,m="",d=0,_=f?N(f):this.shift;for(d=0;d<b;d++)p[d].search(/<!/)>-1?(m+=_[M]+p[d],x=!0,(p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1||p[d].search(/!DOCTYPE/)>-1)&&(x=!1)):p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1?(m+=p[d],x=!1):/^<\w/.exec(p[d-1])&&/^<\/\w/.exec(p[d])&&/^<[\w:\-\.\,]+/.exec(p[d-1])==/^<\/[\w:\-\.\,]+/.exec(p[d])[0].replace("/","")?(m+=p[d],x||M--):p[d].search(/<\w/)>-1&&-1==p[d].search(/<\//)&&-1==p[d].search(/\/>/)?m=m+=x?p[d]:_[M++]+p[d]:p[d].search(/<\w/)>-1&&p[d].search(/<\//)>-1?m=m+=x?p[d]:_[M]+p[d]:p[d].search(/<\//)>-1?m=m+=x?p[d]:_[--M]+p[d]:p[d].search(/\/>/)>-1?m=m+=x?p[d]:_[M]+p[d]:p[d].search(/<\?/)>-1||p[d].search(/xmlns\:/)>-1||p[d].search(/xmlns\=/)>-1?m+=_[M]+p[d]:m+=p[d];return"\n"==m[0]?m.slice(1):m},Y.prototype.json=function(D,p){return p=p||this.step,typeof JSON>"u"?D:"string"==typeof D?JSON.stringify(JSON.parse(D),null,p):"object"==typeof D?JSON.stringify(D,null,p):D},Y.prototype.css=function(D,f){var p=D.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),b=p.length,x=0,M="",m=0,d=f?N(f):this.shift;for(m=0;m<b;m++)/\{/.exec(p[m])?M+=d[x++]+p[m]:/\}/.exec(p[m])?M+=d[--x]+p[m]:(/\*\\/.exec(p[m]),M+=d[x]+p[m]);return M.replace(/^\n{1,}/,"")},Y.prototype.sql=function(D,f){var p=D.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),b=p.length,x=[],M=0,m=this.step,v=0,k="",w=0,R=f?N(f):this.shift;for(w=0;w<b;w++)x=x.concat(w%2?p[w]:A(p[w],m));for(b=x.length,w=0;w<b;w++)v=O(x[w],v),/\s{0,}\s{0,}SELECT\s{0,}/.exec(x[w])&&(x[w]=x[w].replace(/\,/g,",\n"+m+m)),/\s{0,}\s{0,}SET\s{0,}/.exec(x[w])&&(x[w]=x[w].replace(/\,/g,",\n"+m+m)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(x[w])?k+=R[++M]+x[w]:/\'/.exec(x[w])?(v<1&&M&&M--,k+=x[w]):(k+=R[M]+x[w],v<1&&M&&M--);return k.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},Y.prototype.xmlmin=function(D,f){return(f?D:D.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},Y.prototype.jsonmin=function(D){return typeof JSON>"u"?D:JSON.stringify(JSON.parse(D),null,0)},Y.prototype.cssmin=function(D,f){return(f?D:D.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},Y.prototype.sqlmin=function(D){return D.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},Ye.exports=new Y},2480:()=>{},5861:(Ye,N,Y)=>{"use strict";function O(D,f,p,b,x,M,m){try{var d=D[M](m),_=d.value}catch(v){return void p(v)}d.done?f(_):Promise.resolve(_).then(b,x)}function A(D){return function(){var f=this,p=arguments;return new Promise(function(b,x){var M=D.apply(f,p);function m(_){O(M,b,x,m,d,"next",_)}function d(_){O(M,b,x,m,d,"throw",_)}m(void 0)})}}Y.d(N,{Z:()=>A})},1014:Ye=>{"use strict";Ye.exports={}}},Ye=>{Ye(Ye.s=8408)}]);